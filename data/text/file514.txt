
	
	
		
I. IntroductionNASA is conducting a far-term concept exploration for an on-demand, user-preferred, and high-density air transport system to meet the potential demands from Unmanned Aircraft Systems (UASs) and future operations of electric Vertical Take-Off and Landing (eVTOL) aircraft in urban areas.The future urban transport system demands integrated air and ground traffic networks that enable large numbers of small UASs and eVTOL aircraft to operate safely and energy-efficiently in urban airspace that extends upward to approximately 5,000 feet Above Ground Level (AGL).This system needs to be adaptive to the operational changes brought by new entrants and is designed for minimum disruption of existing airspace operations and urban residents through optimized urban airspace designs, precise and accurate strategic trajectory planning, and proactive self-monitoring of system states in the presence of various sources of uncertainty. 1 The concept of operations for NASA's UAS Traffic Management (UTM) focuses on enabling safe operations of small UASs, typically 55 lbs and below, in low-altitude airspace. 2Past studies [3][4][5] explore the concepts of On-Demand aviation for high-speed Mobility (ODM) of passenger transport utilizing eVTOL aircraft.Extending the scope of the UTM concept, the requirements and a framework for integrating and deploying ODM operations were proposed. 6ASA has recently provided high-level descriptions of near-term and mid-term operational concepts for UAM vehicles. 1Future UAM traffic networks are designed for manned and unmanned UAM operations for a great variety of flying vehicles with different vehicle performance and mission profiles.Although near-term operations may be restricted to Visual Meteorological Conditions (VMC), for these operations to become a viable mode of transportation for the general public, they will need to be scalable across disruptive conditions.UAM operations are required to be resilient to a wide range of disruptions such as unexpected changes in weather conditions and localized sub-system failures (e.g., single vehicle or software tool) to widespread disruptions (e.g.GPS outage or multi-system cascading failures) and cause minimal noise annoyance to urban communities.This study proposes a strategic trajectory planning framework capable of supporting the development of UAM traffic networks and the optimization of UAM aircraft trajectories for increasing robustness of UAM operations in the presence of various sources of uncertainty.The framework includes the development of door-to-door routing options involving multi-modal transports to alleviate potential congestion on the ground and the en-route trajectory optimization of UAM aircraft in uncertain weather conditions.The development of UAM routing options considers the static aviation and dynamic weather constraints in urban airspace and the connections to ground transportation networks for preliminary selections of feasible time-optimal door-to-door routes.The trajectory optimization of UAM aircraft utilizes an unscented optimal control approach to calculate pre-computed, open-loop aircraft guidance constrained on the probability distribution of uncertain wind fields.The unscented optimal guidance commands produce cost-optimal trajectories that meet the trajectory constraints with guaranteed margin for the modeled uncertainties and reduce wind-induced trajectory uncertainty in order to minimize frequency of tactical re-planning in actual operations and increase air traffic system predictability.Section II introduces the data inputs and the analytical approaches to the strategic planning framework for designing wind-optimal, obstacle-avoidance routings, and unscented guidance for UAM aircraft.Section III presents an illustration of the application of deterministic wind-optimal, obstacle-avoidance routings and their predicted potential travel time savings of simulated future UAM traffic in the Dallas/Fort Worth, Texas metropolitan area.Section IV presents the initial development efforts of UAM aircraft trajectories based on unscented optimal control approach and validates the unscented optimal solutions for optimality by checking the necessary conditions of Pontryagin's Minimum Principle.Section V evaluates the unscented guidance using Monte Carlo simulations.Section VI provides the concluding remarks.
II. Strategic Planning ProcessThe strategic planning framework aims to automatically create strategic flight plans with pre-computed aircraft guidance that can reduce trajectory uncertainty given uncertain wind fields with guaranteed upper bounds on potential trajectory perturbations without real-time updates.Figure 1 illustrates this framework that includes the process of selecting origin and destination vertiports, a standard optimal control approach and unscented guidance optimization with feedback from Monte Carlo simulations analysis.The strategic planning process utilizes real-time ground traffic and environmental information to enhance overall operational efficiency of UAM and ground transportation networks, and pre-computes unscented UAM aircraft guidance to help ensure that trajectory constraints are satisfied in the presences of uncertainties.The first step of strategic planning integrates aircraft trajectory optimization in the presence of deterministic wind fields and path constraints with the consideration of ground infrastructure (e.g., aviation obstacles and road networks) to create a preliminary module capable of calculating door-to-door routes that involve ground and UAM transportation networks.The implementation utilizes Apple's Mapkit 7 application framework for the integration of ground traffic networks and potential UAM routes to compute multi-modal transport routings with estimated travel times.Given the selected routings, the second step of this strategic planning process models uncertain wind disturbances and/or vehicle aerodynamic parameters through unscented transformation.Then, an unscented optimal guidance approach is adopted to develop optimal guidance that minimizes a cost function while producing UAM aircraft trajectories that meet the end-point and path constraints with guaranteed safety margins at any reference location along the flight plan in the presence of modeled uncertainties.The algorithm development and implementations are built upon past research results and the latest development in unscented optimal control.A previous study 8 developed a trajectory optimization algorithm to generate windoptimal trajectories that minimize a climate cost objective function while avoiding pre-determined airspace regions prone to persistent contrails formation for transpolar flights in deterministic wind fields.The wind-optimal guidance for aircraft heading is a solution of the non-linear optimal control problem formulated with soft path constraints that satisfy the necessary conditions based on Pontryagin's Minimum Principle 9 .In the absence of path constraints, the dynamical equation governing optimal aircraft heading is the solution of the Zermolo 10 problem derived on a spherical Earth surface.To cope with uncertain disturbances to en-route aircraft brought by convective weather, a stochastic dynamic programming approach 11 is developed for routing aircraft in the presence of winds and en-route convective weather.The search space and decision horizons are discretized to incorporate route deviation probabilities by adding random disturbance that are state and control-inputs dependent in the discrete aircraft dynamical equations.In this study, the first step of the strategic planning applies the dynamical equation governing optimal aircraft heading in the absence of path constraints to generate wind-optimal extremals at each of the discretized decision horizons sequentially.This is based on the concept of dynamic programming to search for a strategic route that connects all the extremals between the origin and destination while satisfying all the path constraints.Note that this step of the problem formulation incorporates deterministic weather and static airspace constraints for generation of potential UAM aircraft wind-optimal and obstacle-avoidance routes between vertiports.The second step of the strategic planning adopts an unscented optimal control approach to solve for unscented guidance commands subject to the constraint of a set of sigma points, which represent probability distribution of the modeled uncertainties, to manage uncertain disturbances to UAM aircraft for enhancing the predictability of the trajectory to the greatest extent possible.A recent paper 12 proposes unscented optimal control to design safe guidance commands that can produce orbits with guaranteed safety margins in the presence of an uncertain gravity field.Unscented optimal control is based on combining the concept of the unscented transform with standard optimal control to produce a new approach for enabling open-loop management of navigational, gravitational and other uncertainties.This step of the strategic planning explores the unscented optimal control concept for designing safe guidance for UAM aircraft operations in the presence of an uncertain wind field.
Figure 1. Strategic planning with unscented optimal guidance formulationThe input to the strategic planning process leverages the National Oceanic and Atmospheric Administration's (NOAA) High Resolution Rapid Refresh atmospheric model 13 (HRRR), and the United States Geological Survey's (USGS) elevation models 14 and ground structures and traffic data for preliminary modeling of potential static and dynamic constraints to UAM aircraft and alternative urban transportation mode on the ground.The top left section of Fig. 1 shows the wind forecasts near land surface from HRRR for the contiguous United States, the terrain elevations in San Francisco Bay Area, as wells as air and ground traffic patterns.Among several sources of time-varying urban data, the initial UAM routing network development will integrate an atmospheric model providing high-resolution null-cast and forecasted atmospheric conditions at altitudes below approximately 5,000 feet for modeling and predicting winds and potential disruptions of urban air transport due to weather.The current strategic trajectory planning algorithms assume that UAM aircraft trajectories are similar to fixedwing aircraft during cruise.Defining f as longitude, q as latitude, h as altitude, V as true airspeed,  as aircraft heading, g as flight path angle, µ as bank angle, and let M equal aircraft mass, T equal thrust, D equal drag, L equal lift, with  ! as the easterly wind component,  " as the northerly wind component, and  # as the vertical wind component, the general formulation of the problem includes the aircraft dynamical equations Eqs.(1-6) in spherical coordinates in the presence of horizontal and vertical winds.𝜙 ̇= 𝑉𝑐𝑜𝑠𝛾𝑐𝑜𝑠𝜓 + 𝑤 ! 𝑅𝑐𝑜𝑠𝜃 (1) 𝜃 ̇= 𝑉𝑐𝑜𝑠𝛾𝑠𝑖𝑛𝜓 + 𝑤 " 𝑅 (2) ℎ ̇= 𝑉𝑠𝑖𝑛𝛾 + 𝑤 # (3) 𝑉 ̇= 7 𝑇(𝑀, ℎ) -𝐷(𝑀, ℎ, 𝑛) 𝑀𝑔 -𝑠𝑖𝑛𝛾> 𝑔 (4) 𝜓 ̇= 𝐿𝑠𝑖𝑛𝜇 𝑀𝑉𝑐𝑜𝑠𝛾 (5) 𝛾̇= 𝐿𝑐𝑜𝑠𝜇 -𝑀𝑔𝑐𝑜𝑠𝛾 𝑀𝑉(6)The end-point and path cost functionals are defined as:𝐽E𝑥(•), 𝑢(•), 𝑡 $ J = 𝐸E𝑥L𝑡 $ M, 𝑡 $ J + N 𝐹(𝑥(𝑡), 𝑢(𝑡), 𝑡) 𝑑𝑡 (7) % ! % "The strategic routings and unscented guidance are generated by minimizing the chosen objective cost function, e.
III. Deterministic Wind-optimal UAM RoutesThis section presents the algorithm development of the first step of strategic planning.Strategic planning of UAM aircraft operation can benefit from development of optimal routings given a common set of constraints including both static and dynamic information.The initial routings consider static constraints including USGS's terrain elevation models and static aviation obstacles, 15 and the dynamic effects and impacts of weather.For flights during cruise, the flight path angle and rate changes are assumed to be zero, i.e.rate  = 0, ̇= 0. Since cruise speed varies with aircraft type and depends on the actual operation, a constant aircraft cruise speed is assumed  ̇= 0. The aircraft dynamical equations used for developing UAM routes that avoid the chosen aviation obstacles in the presence of winds are  ̇=,-./012 # 3-./4and  ̇= ,/'(012 $
3. The wind-optimal and obstacle-avoidance route is developed based on integration of wind-optimal headings  ̇= 56 %&'( (0,9,4,2 # ,2 $ ,,)3-./4, where𝐹 2'(; (𝜓, 𝜙, 𝜃, 𝑤 ! , 𝑤 " , 𝑉) = [-𝑠𝑖𝑛𝜓𝑐𝑜𝑠𝜓 𝜕𝑤 ! 𝜕𝜙 + 𝑐𝑜𝑠 < 𝜓𝑠𝑖𝑛𝜃𝑤 ! + 𝑐𝑜𝑠 < 𝜓𝑐𝑜𝑠𝜃 𝜕𝑤 ! 𝜕𝜃 - 𝜕𝑤 " 𝜕𝜙 +𝑠𝑖𝑛𝜓𝑐𝑜𝑠𝜓𝑠𝑖𝑛𝜃𝑤 " + 𝑐𝑜𝑠𝜓𝑠𝑖𝑛𝜓𝑐𝑜𝑠𝜃 𝜕𝑤 " 𝜕𝜃 + 𝑉𝑐𝑜𝑠𝜓𝑠𝑖𝑛𝜃 + 𝑐𝑜𝑠 < 𝜓 𝜕𝑤 " and the concept of dynamic programming that minimizes the cost functionals as shown in (7) where the running cost, F, along the path penalizes obstacle interceptions.𝐽E𝑥(•), 𝑢(•), 𝑡 $ J = 𝑡 $ + N 𝐹(𝑥(𝑡), 𝑢(𝑡), 𝑡) 𝑑𝑡 (8) % ! % "Figure 2 presents a potential optimal route for UAM aircraft cruise at 100 knots airspeed at 2,000 ft MSL from Dallas/Fort Worth International Airport (DFW) to McKinney Aero Country heliport in the presence of winds and aviation obstacles given the elevation data in the region.The green arrows represent the direction and magnitude of the winds.The center of each aviation obstacle is depicted with a magenta dot, and the potential buffer zone boundary is outlined by a magenta contour.The blue contours in the background and the color bars show the terrain elevations in the region.The great-circle route is plotted with a black-dotted line in comparison with the wind-optimal route, depicted in blue that avoids en-route aviation obstacles.The great-circle route is generated based on great-circle aircraft headings with perturbation adjustments using wind vectors along the route.A set of backward wind extremums that are plotted with the Red-Green-Blue lines, are generated by backward integration of wind-optimal heading equation from the heliport of McKinney Aero Country to produce minimum time-to-go from any point to the destination.Similarly, multiple sets of forward wind extremums that are plotted with the fan-shaped lines, are generated by forward integration of the wind-optimal heading equation from the origin heliport at DFW to produce minimum time-to-go from the origin to any points in the region.The generation of forward wind extremums are done sequentially to allow perturbation of wind-optimal headings for obstacle avoidance every minute in this particular example.Note that the generation of the wind-optimal, obstacle-avoidance route depends on the frequency and the allowable magnitude of the heading changes that can be further optimized through an iterative process.The size of each buffer zone can be designed using the local wind forecast and the vehicle performance data such as cruise speeds to ensure en-route UAM aircraft have sufficient time in response to strong winds.Dynamic airspace constraints such as hazardous weather regions can also be included in the strategic trajectory generation process.Note that all of the path constraints are considered deterministic in this step of problem formulation.
Figure 2. Wind-optimal route avoiding aviation obstacles between two heliportsThe proposed framework enables selection of a set of potential take-off and landing locations for UAM aircraft based on origin and destination of the trip, available route connections on ground and the associated estimated travel times.The preliminary development uses Swift 2 on Xcode 7 and utilizes Apple's Mapkit API for the integration of potential UAM routing networks, static aviation obstacles, and current ground transportation networks for the Dallas/Fort Worth area.Airspace constraints such as traditional air traffic patterns and the helicopter route networks are not considered in this example.For illustration, the potential UAM routings from DFW to all other vertiports in the area are calculated for UAM aircraft and compare the travel time for each route with that provided via ground transportation using Apple's mapping service acquired through MapKit API for time-saving estimation.The "Vertiport Set One" contains the ten routes that have the greatest savings in terms of travel time.These routes are plotted in white lines on left side of Figure 3.The estimated savings range between 55 minutes and 75 minutes as shown on the right top bar graph in Figure 3.The total time savings are proportional to the distance between the vertiport pairs.The "Vertiport Set Two" includes the ten routes that have the greatest percentage travel time savings.The routes are plotted in black lines on the left side of Figure 3, and the associated time savings are shown on the right bottom bar graph.The percent time savings are about 80% and depend on traffic conditions on the ground.These results represent initial estimates only; they will vary with UAM aircraft speed and actual operational environment.This step of the strategic trajectory planning enables generation of a time-varying UAM trajectory option set and provides benefits assessments for preliminary determination of the origin and destination vertiport locations, the corresponding UAM routings, and their connections to a mutli-modal transportation network.Utilizing the USGS terrain data and MapKit API that provides geocoding look-up and location and types of ground buildings and infrastructures, contingency routings and landing zones can be developed during the UAM network design process.
IV. Unscented Optimal GuidanceThis section presents the formulation process of unscented optimal guidance.In general, the aforementioned strategic planning step uses weather nowcasts or forecasts, traffic conditions, and transportation schedules to plan for a feasible route option set door-to-door involving several modes of transport.It utilizes a given set of possible UAM aircraft take-off and landing locations for trade-off between time savings and travel costs.It attempts to hedge against the risk of delay in the presence of various sources of uncertainty.Given the deterministic wind-optimal route and UAM aircraft model, the development of unscented optimal guidance for UAM aircraft helps ensure that the actual flown trajectory satisfies the end-point and path constraints in uncertain operating conditions with a guaranteed margin in temporal and spatial dimensions.Along each planned route, the estimated arrival time at each key waypoint along the planned trajectory is required to compute aggregated UAM aircraft counts at the departure and arrival vertiports and in the en-route airspace for congestion forecasts.In the presence of uncertain wind disturbances, an unscented optimal control solution can reduce wind-induced trajectory uncertainty.The associated spatial and temporal trajectory perturbations can be further assessed using Monte Carlo simulations.The unscented optimal trajectory with guaranteed perturbation margin provides precise information leading to self-trajectory conformance monitoring and more accurate congestion forecasts that reduce re-planning frequency.Section IV.A. formulates the unscented optimal control problem for the development of UAM aircraft trajectories in uncertain wind fields.Section IV.B. models the probability distribution of wind fields and its unscented transformation.Section IV.C. validates unscented optimal control solutions based on the necessary conditions of Pontryagin's Minimum Principle.
Unscented Wind-optimal TrajectoryThis section presents the formulation of a unscented optimal control problem for the development of 4-d UAM aircraft trajectories in the presence of uncertain wind fields.The unscented wind-optimal control problem is formulated as: The objective cost function is equivalent to that of a time-minimum problem since the path constraints are solved in the first step of the strategic planning process.The unscented guidance using , V is optimized subject to n dynamical systems.Each models a specific representation of the probability distribution of modeled uncertain wind field and the same endpoint constraints.In this study, n represents to the number of sigma points computed for the statistical properties of a horizontal wind field in the spatial and temporal domains defined in proximity of the route.In general, n is not unique, but it is minimized to reduce the computational complexity of the optimization process.The aforementioned formulation assumes common initial constraints for the n dynamical systems.The resultant n trajectories using the common unscented guidance evolve over time depending on the associated sigma values of the wind vectors.The deviation of each of n unscented trajectories at the endpoint increases with the trip length.This study further divides the problem into m stages to reduce the trajectory deviation at the endpoint.There are j unscented optimal control problems formulated at each of the m stages.Each problem is formulated using a different initial constraint that the set of j initial conditions ensembles the distribution of trajectories at the endpoint of the previous stage.Note that a single unscented optimal control problem can be formulated with a total of n times j number of constrained dynamical systems for each stage.This study seeks j unscented optimal control solutions to reduce the computational complexity of the formulated problem, and make the selection based on the results obtained using Monte Carlo simulations.Figure 4 illustrates the process for the multiple-stages unscented guidance with m stages n=3, and j=2.In this study, each of the 1 +  •  optimal control problems is solved using DIDO©, a MATLAB® toolbox for solving optimal control problems.DIDO implements a guess-free, 16 fast spectral algorithm based on pseudospectral optimal control theory. 17Section IV.B introduces unscented transformation for determination of the set of sigma points representing modeled probability distribution of wind fields.
Figure 4. Multiple-stage unscented guidance incorporating uncertain initial position constraints Unscented Transformation for Wind UncertaintiesThis section models the probability distribution of wind fields and introduces its unscented transformation for the selection of a set of minimum number of sigma points.NASA is currently collaborating with Center for Atmospheric Research (NCAR) to identify the weather information, existing aviation weather products, and necessary novel approaches required to mitigate various impacts of uncertain atmospheric conditions to support safe and efficient UAM operations.The analysis considers vertical lift vehicle operations below 5,000 feet AGL in multiple major metropolitan areas in the contiguous U.S. over a substantial period of time to incorporate different demographic characteristics and seasonal variations of atmospheric conditions.Historical weather nowcast/forecast data are collected to support weather-related UAM research.Potential UAM-like operations are evaluated in Dallas/Fort Worth, TX.The initial focus will be on predictions of atmospheric conditions including winds, visibility, cloud top, turbulence, and thunderstorm for the development of UAM aircraft trajectories from takeoff to landing.For example, it is expected that wind information should be provided to pilots for planning takeoff and landing, and ATC should be advised of the intended method of departure for the near-term UAM-like operations as they are required for current helicopter operations.In addition, the wind information with sufficiently high spatial and temporal resolutions is needed for strategic and tactical route planning and for the assessment of the impact of wind on UAM operations along the selected routes.Figure 5 shows the magnitude distributions of near-surface wind components at Dallas-Fort Worth, TX based on HRRR forecasts.The mean and variance for the wind component towards the East is -0.82 and 1.16, respectively, and for the wind component towards the North is 3.64 and 1.7, respectively.Note that the distributions need not be Gaussian, and they could be statistically correlated.Based on these predicted statistical properties of the wind distributions, sigma points are selected for formulating the unscented optimal control problem.This study applied an optimized sigma point selection strategy 18 to model the distribution of the wind field using a well-behaved set of sigma points.Similar to an Unscented Kalman Filter that estimates system states using a set of weighted sigma points to simulate the distribution of a random variable, the performance and computational cost of unscented optimal guidance depend on the selection of sigma points and the number of sigma points used.The process for sigma points determination used in this study is introduced in this section.Let y be a n-dimensional random variable with mean, m and covariance matrx P, and have n+1 sigma points  ' .Let M be a matrix with n+1 columns of the mean vector m.The first iteration step for defining the sigma points is choosing  = [
V. Monte Carlo Simulations of Unscented Optimal GuidanceThis section assesses the performance of the 4-d trajectories produced by Monte Carlo simulations of unscented optimal guidance in the presence of various realizations of wind fields.Figure 6 depicts one thousand aircraft trajectories that are generated by Monte Carlo simulations of the unscented optimal guidance solved for the problem formulation with six stages (m=6) and one initial condition (j=1).The blue dots in Figure 7 represent the lateral perturbations of the trajectories at the destination.In comparison to the performance of unscented guidance, four optimal control problems are solved using DIDO©; each assumes a deterministic wind vector chosen arbitrarily.A thousand wind-optimal trajectories are generated in the Monte Carlo simulations for each of the four time-optimal solutions as the guidance for aircraft speed and heading.The lateral perturbations of the four sets of trajectories at the destination are plotted in cyan, yellow, black, and magenta dots in Figure 7. unscented optimal guidance produces the smallest endpoint errors.These results warrant further exploration of the open-loop control concept for designing safe guidance for UAM aircraft without making any assumptions about aircraft navigation performance or in GPS-denied environments in the presence of uncertain wind fields.Figure 8(a) and 8(b) depict two sets of aircraft trajectories.Each set contains a Monte Carlo simulation of one thousand trajectories using one of the two unscented guidance commands computed for the formulation that has six stages (m=6) and two initial conditions (j=2) used for modeling of uncertain initial conditions at each stage.The blue and magenta dots in Figure 8(c) illustrate possible aircraft positions at the end of each stage i.e. waypoint, respectively.Note that the two sets of unscented trajectories are the same for the first stage given known deterministic origin, and differ at each subsequent stage with respect to the two possible unscented guidance trajectories.In general, these sets of the trajectories can be fused to estimate an upper bound on the required airspace volume for UAM operations without an update on aircraft position along the route for multiple aircraft, each adopting its own control solution.The The box plots in Figure 9(a) compare the spatial perturbation at the end of each stage (i.e.waypoint) for the two unscented commands.The track distance from the origin to the first waypoint is while the mean aircraft distance deviated away from this waypoint is 323ft for the wind-optimal trajectory set following each unscented guidance.Note that the unscented guidance used from the origin to the first waypoint is the same, because the position of the origin is deterministic.The deviation of the simulated aircraft trajectories is caused by the discrepancies of wind vectors used to solve the control guidance and those used in the Monte-Carlo simulations.The deviation grows with distance away from the origin without the updates of aircraft position and the recomputed control commands.This scenario represents the application of pre-computed open-loop control solutions to estimate required horizontal spacing for aircraft operations without knowing the navigation system's performance.In this scenario, a UAM corridor with a width of 1,418 feet, which equals two times the mean (i.e.323ft) with two standard deviation (i.e.193ft) will ensure aircraft operations lie within the corridor or volume with 95% probability without the need for navigation or control updates from the origin to the first waypoint.The width of corridors between the subsequent waypoints can be estimated similarly for each of the adopted unscented guidance.Note that these trajectories are simulated from the origin to the destination (i.e. the sixth waypoint) without re-computation of controls using any intermittent position update.The width of each corridor segment increases with the distance of waypoints from the origin when including all the outliers, but the deviation of majority 95% of aircraft trajectories varies for each segment since the unscented controls are optimized with constraints using the sigma values of modeled wind distribution for each stage.In addition, the trajectory perturbations also depend on the selected unscented guidance each optimized with a different set of initial aircraft position predicted at each intermediate waypoint, starting from the second waypoint.The second unscented guidance among the two yields the least amount of trajectory deviation that leads to a corridor with smaller width.These data can be checked with pre-determined constraints and included in the feedback loop in the proposed framework to further enhance solutions (i.e.reduce corridor width) and inform requirements of separation with Communications, Navigation and Surveillance Systems (CNS) capabilities.The box plots in Figure 9(b) compare the temporal variation at the end of each waypoint for the two sets of trajectories.The mean travel time from the origin to the first waypoint is 294sec with standard deviation of 2sec for each wind-optimal trajectory set.Note that travel time is minimized for each stage but still varies with actual wind fields used in the Monte Carlo simulation.The mean and standard deviation for the second waypoint is (348sec, 2sec) and (350sec, 1sec), respectively, for the two trajectory sets.The standard deviation of the arrival times at the subsequent waypoints does not increase in ascending order, and remains similar for the two unscented optimal guidance.In this example, the mean and standard deviation from the starting point to the last waypoint is (697sec, 2sec) and (696sec, 3sec) for these two sets of unscented trajectories.The spatial and temporal variations of the trajectories can be combined to define a 4-d trajectory envelope such that the aircraft operations are guaranteed to stay within even without real-time position update and in the presence of modeled wind uncertainties while overall aircraft travel time is minimized.For example, a rectangular airspace volume with 11.1mi in length and 1,418ft in width span between ti and (ti+ 298) in time can be reserved ahead of time to ensure the actual UAM aircraft fly inside the bounded envelope between the starting position and the first waypoint with guarantee for the predicted range of wind variations.Figure 10 illustrates the concept of a UAM corridor and the 4-d trajectory volume with the design parameters.Note that the simulation results will vary with actual UAM vehicle aerodynamic and performance parameters, operation requirements, and wind variations.The current results are within the range of lateral separation minima, which is 4,000ft 19,20 between corridors for larger UAS (55-1320lb) and 1mi 1 for UAM vehicles.This study developed a methodology that incorporates uncertain wind conditions and static obstacle avoidance to define airspace corridors and 4d trajectory-based operation volumes for UAM aircraft.Airspace constraints such as traffic patterns in the area along with aircraft performance parameters can be readily incorporated into the framework.Future research will incorporate high-fidelity vehicle models and simulations, validate results with actual vehicle data, and utilize the proposed framework to develop a prior and reusable UAM guidance database to support NASA's UAM research portfolio.
VI. Concluding RemarksThis study proposes a strategic trajectory planning framework capable of supporting the development of UAM traffic networks and the optimization of UAM aircraft trajectories for increasing robustness of UAM operations in the presence of various sources of uncertainty.The framework represents a trajectory planning framework based on an unscented optimal guidance approach to support the concept development of UAM traffic network and optimization of UAM aircraft trajectories that are robust to uncertain wind fields.The preliminary framework development is done using Swift 2 on Xcode 7 and utilizes Apple's Mapkit API for the integration of potential UAM routing networks, aviation constraints, deterministic weather conditions, and connections to ground transportation networks to create a set of feasible time-optimal routes door to door.An unscented transformation is implemented for the selection of a set of minimum number of sigma points that model probability distribution of an uncertain wind field.A set of multistage unscented optimal control problems formulated with uncertain initial aircraft positions at subsequent stages is solved using DIDO©, and the optimal solution is validated for optimality by checking the necessary conditions of Pontryagin's Minimum Principle.Initial assessment based on trajectory perturbations of UAM aircraft in various wind fields produced by Monte Carlo simulations shows that the unscented guidance commands produced the smallest endpoint errors when compared to those of deterministic optimal control solutions.An example of wind-optimal UAM corridor and the associated trajectory-based operation volume is created utilizing the 4-d trajectories produced by Monte Carlo simulations of unscented optimal guidance in the presence of various realizations of wind fields for preliminary assessment of required aircraft separation minima without knowledge of aircraft navigation performance.g. a minimum-time problem is equivalent to Minimize  { E(•), (•),  $ J} = Minimize  Z $ [ using assumed controls, u, subject to the aircraft dynamical equations (1-6) and constrained on aircraft state, x and the controls along path  &'( ≤ () ≤  &)* ,  &'( ≤ () ≤  &)* and the end-point conditions (( + ),  + ) = ( + ,  + ), and LL $ M,  $ M = ( $ ,  $ ).
Figure 3 .3Figure 3. Potential time savings compared to ground transportation between Dallas/Fort Worth and two sets of vertiports, ranked by minutes or percent Figure 3 depicts a set of vertiports in white circles and the aviation obstacles in red dots for Dallas/Fort Worth, TX based on a database provided by FAA's aeronautical information services.For illustration, the potential UAM routings from DFW to all other vertiports in the area are calculated for UAM aircraft and compare the travel time for each route with that provided via ground transportation using Apple's mapping service acquired through MapKit API for time-saving estimation.The "Vertiport Set One" contains the ten routes that have the greatest savings in terms of
Minimize  { E(•), (•),  $ J} = Minimize  Z $ [ Subject to  ̇= =  +  !=  = ,  ̇= =  +  "=  , ( = ,  + ) = ( + ,  + ), ( = ,  + ) = ( + ,  + ),  = L $ M =  $ ,  = L $ M =  $ (( ,  + ) = ( + ,  + ), ( ( ,  + ) = ( + ,  + ),  ( L $ M =  $ ,  ( L $ M =  $ (10)
= - 1 ,Figure 6 .16remaining i = 2 to n-1 iterations, let  ' be a row vector with  columns of ,  = - ,  '1= = {  ' 0  '  |.Then, information for verification.The control Hamiltonian and Hamiltonian value condition are that are verified as shown in Figure 6(c).(a) Trajectory states x and y, (b) co-states    ,     = , , , and (c) the Hamiltonian
Figure 6 .6Figure 6.Unscented Wind-optimal Trajectories Figure 7. End-point Errors
Figure 8 .Figure 9 .89potential unscented commands can provide control insights for determining the operational ranges of aircraft speed, heading, and their rates of change for each airspace region given the probability of wind uncertainties.Unscented Wind-optimal Trajectory Sets and Aircraft Positions at each Waypoints Distribution of aircraft spatial perturbations (a) and temporal variations (b) at each Waypoints
Figure 10 .10Figure 10.Wind-optimal UAM corridor and the 4-d trajectory volume with the design parameters
			Research Aerospace Engineer, NASA Ames Research Center, MS
			210-8, Member AIAA.
		
		
			
. Each sigma point will be used to model  !' and  "' as shown in Eqs.(9-10)., and the aircraft velocity is simplified and governed by  ̇= .The states are , , ,  and the available controls are  and .The dynamical equations for the states are further scaled to enhance performance of the optimal control solver DIDO © .Then, the optimal control problems are solved with terminal constraints specified in the Cartesian coordinates obtained from transformation of the geodetic systems.Note that the unscented guidance for aircraft speed and heading is obtained through the optimized controls of aircraft acceleration and banking angle.In this example, the maximum aircraft acceleration is set to one gravitational acceleration and the bank angle ranges between -30 degree to 30 degree.The cruise speed is allowed to vary between 80 knots to 120 knots and with 360 degree heading changes.Figure 6a plots the x and y states for the entire trip using the unscented guidance and the sigma values.Basic validation is conducted for optimality of the unscented optimal solution by checking the necessary conditions of Pontryagin's Minimum Principle.Let the Hamiltonian (, , , ) =  B (, , ), where  is the convectors, X define the state space, i.e. , , , and ; and the selected controls U are  and  for this problem, that implies			
			

				


	
		Initial Urban Air Mobility Airspace Integration Concepts
		
			DThipphavong
		
		
			RApaza
		
		
			BBarmore
		
		
			VBattiste
		
		
			CBelcastro
		
		
			BBurian
		
		
			QDao
		
		
			MFeary
		
		
			SGo
		
		
			KGoodrich
		
		
			JHomola
		
		
			HIdris
		
		
			JKibler
		
		
			PKopardekar
		
		
			JLachter
		
		
			HNg
		
		
			ROseguera-Lohr
		
		
			MPatterson
		
		
			SVerma
		
	
	
		18th AIAA Aviation Technology, Integration, and Operations Conference
		Atlanta, Georgia
		
			June 2018
			
		
	
	Thipphavong, D., Apaza,R., Barmore, B., Battiste, V., Belcastro, C., Burian, B., Dao, Q., Feary, M., Go, S., Goodrich, K., Homola, J., Idris, H., Kibler, J., Kopardekar, P., Lachter, J., Ng, H., Oseguera-Lohr, R., Patterson, M., Verma, S., "Initial Urban Air Mobility Airspace Integration Concepts," 18th AIAA Aviation Technology, Integration, and Operations Conference. 25 -29 June 2018, Atlanta, Georgia.



	
		Unmanned Aircraft System Traffic Management (UTM) Concept of Operations
		
			PKopardekar
		
		
			JRios
		
		
			TPrevot
		
		
			MJohnson
		
		
			JJung
		
		
			JERobinson
		
		AIAA-2016-3292
	
	
		AIAA Aviation and Aeronautics Forum and Exposition
		Washington D.C.
		
			June 2016
			
		
	
	Kopardekar, P., Rios, J., Prevot, T., Johnson, M., Jung, J., and Robinson, J.E., "Unmanned Aircraft System Traffic Management (UTM) Concept of Operations," AIAA Aviation and Aeronautics Forum and Exposition, Washington D.C., 13-17 June 2016, AIAA-2016-3292.



	
		High Speed Mobility through On-Demand Aviation
		
			MDMoore
		
		
			KGoodrich
		
		
			JViken
		
		
			JSmith
		
		
			BFredericks
		
		
			TTrani
		
		
			JBarraclough
		
		
			BGerman
		
		
			MPatterson
		
		10.2514/6.2013-4373
	
	
		AIAA Aviation Technology, Integration, and Operations Conference
		Washington D.C.
		
			2013
		
	
	Moore, M. D., Goodrich, K., Viken, J., Smith, J., Fredericks, B., Trani, T., Barraclough, J., German, B., and Patterson, M., "High Speed Mobility through On-Demand Aviation," AIAA Aviation Technology, Integration, and Operations Conference, Washington D.C., 2013. doi: 10.2514/6.2013-4373.



	
		Combined Electric Aircraft and Airspace Management Design for Metro-Regional Public Transportation
		
			JMelton
		
		
			KDean
		
		
			SGrabbe
		
		
			JSinsay
		
		
			JAlonso
		
		
			BTracey
		
		NASA/TM-2014-216626
		
	
	Melton, J., Dean, K., Grabbe, S., Sinsay, J., Alonso, J., Tracey, B., "Combined Electric Aircraft and Airspace Management Design for Metro-Regional Public Transportation," NASA/TM-2014-216626.



	
		System-of-System Considerations in the Notional Development of a Metropolitan Aerial Transportation System
		
			JAlonso
		
		
			HArneson
		
		
			JMelton
		
		
			MVegh
		
		
			CWalker
		
		
			LYoung
		
		NASA/TM-2017-218356
		
	
	Alonso, J., Arneson, H., Melton, J., Vegh, M., Walker, C., Young, L., "System-of-System Considerations in the Notional Development of a Metropolitan Aerial Transportation System," NASA/TM-2017-218356.



	
		Enabling Airspace Integration for High-Density On-Demand Mobility Operations
		
			EMueller
		
		
			PKopardekar
		
		
			KGoodrich
		
		AIAA-2017-3086
		
	
	
		AIAA Aviation Forum, 17th AIAA Aviation Technnology, Integration, and Operations Conference
		Denver, CO
		
			2017. June 2017
			
		
	
	Mueller, E., Kopardekar, P., and Goodrich, K., "Enabling Airspace Integration for High-Density On-Demand Mobility Operations," AIAA-2017-3086, 2017 AIAA Aviation Forum, 17th AIAA Aviation Technnology, Integration, and Operations Conference, Denver, CO, 5-9 June 2017. 7 https://developer.apple.com/documentation/mapkit



	
		Cross-Polar Aircraft Trajectory Optimization and the Potential Climate Impact
		
			HNg
		
		
			BSridhar
		
		
			SGrabbe
		
		
			NChen
		
	
	
		30 th Digital Avionics Syatems Conference (DASC)
		Seattle, WA
		
			20 Oct. 2011
			16
		
	
	Ng, H., and Sridhar, B., Grabbe, S., Chen, N., "Cross-Polar Aircraft Trajectory Optimization and the Potential Climate Impact," 30 th Digital Avionics Syatems Conference (DASC), Seattle, WA, 16-20 Oct. 2011.



	
		Applied Optimal Control, Taylor and Francis
		
			AEBryson
		
		
			YCHo
		
		
			1975
			
			Levittown, PA
		
	
	Bryson, A. E., and Y. C. Ho, 1975, Applied Optimal Control, Taylor and Francis, Levittown, PA, Ch. 2, pp. 42-89.



	
		Über das Navigationsproblem bei ruhender oder veränderlicher Windverteilung
		
			ErnstZermelo
		
	
	
		Zeitschrift für Angewandte Mathematik und Mechanik
		
			1931
		
	
	Zermelo, Ernst (1931). "Über das Navigationsproblem bei ruhender oder veränderlicher Windverteilung". Zeitschrift für Angewandte Mathematik und Mechanik..



	
		Automated Flight Routing Using Stochastic Dynamic Programming
		
			HKNg
		
		
			AMorando
		
		
			SGrabbe
		
	
	
		10 th AIAA Aviation Technology, Integration, and Operations (ATIO) Conference
		Fort Worth, TX
		
			September 2010
			
		
	
	Ng, H.K., Morando, A., and Grabbe, S., "Automated Flight Routing Using Stochastic Dynamic Programming," 10 th AIAA Aviation Technology, Integration, and Operations (ATIO) Conference, Fort Worth, TX, 13-15 September 2010.



	
		Unscented Optimal Control for Orbital and Proximity Operations in an Uncertain Environment: A New Zermelo Problem
		
			MRoss
		
		
			RJProulx
		
		
			MKarpenko
		
		
	
	
		AIAA Space and Astronautics Forum and Exposition: AIAA/AAS Astrodynamics Specialist Conference
		San Diego, CA
		
			August 2014
		
	
	Ross, M., Proulx, R.J., and Karpenko M., "Unscented Optimal Control for Orbital and Proximity Operations in an Uncertain Environment: A New Zermelo Problem," AIAA Space and Astronautics Forum and Exposition: AIAA/AAS Astrodynamics Specialist Conference, San Diego, CA 4-7 August 2014. 13 https://rapidrefresh.noaa.gov 14 https://earthexplorer.usgs.gov 15 https://www.faa.gov/air_traffic/flight_info/aeronav/obst_data/



	
		Guess-Free Trajectory Optimization
		
			IMRoss
		
		
			QGong
		
		AIAA 2008-6273
	
	
		AIAA/AAS Astrodynamics Specialist Conference and Exhibit
		Honolulu, HI
		
			August 18-21, 2008
		
	
	Ross, I. M. and Gong, Q., "Guess-Free Trajectory Optimization," AIAA/AAS Astrodynamics Specialist Conference and Exhibit, Honolulu, HI, August 18-21, 2008. AIAA 2008-6273.



	
		A Review of Pseudospectral Optimal Control: From Theory to Flight
		
			IMRoss
		
		
			MKarpenko
		
	
	
		Annual Reviews in Control
		
			36
			
			2012
		
	
	Ross, I. M. and Karpenko, M., "A Review of Pseudospectral Optimal Control: From Theory to Flight," Annual Reviews in Control, Vol.36, 2012, pp.182-197.



	
		Optimized Selection of Sigma Points in the Unscented Kalman Filter
		
			YCheng
		
		
			ZLiu
		
		10.1109/ICECENG.2011.6057978
	
	
		2011 International Conference on Electrical and Control Engineering
		Yichang, China
		
			Sept. 2011
			
		
	
	Cheng, Y., Liu, Z., "Optimized Selection of Sigma Points in the Unscented Kalman Filter," 2011 International Conference on Electrical and Control Engineering, Yichang, China, 16-18 Sept. 2011, DOI: 10.1109/ICECENG.2011.6057978.



	
		Detect and Avoid Alerting Performance with Limited Surveillance Volume for Non-Cooperative Aircraft
		
			MGWu
		
		
			SLee
		
		
			ACCone
		
	
	
		AIAA Scitech 2019 Forum
		
			2019
			2073
		
	
	Wu, M.G., Lee, S. and Cone, A.C., 2019. Detect and Avoid Alerting Performance with Limited Surveillance Volume for Non-Cooperative Aircraft. In AIAA Scitech 2019 Forum (p. 2073).



	
		NASA
		
			JShively
		
		
	
	
		UAS Integration in the NAS: Detect and Avoid
		
			2018
		
	
	Shively, J., NASA, 2018. UAS Integration in the NAS: Detect and Avoid. At: https://ntrs.nasa.gov/search.jsp?R=20180002420


				
			
		
	
