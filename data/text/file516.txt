
	
	
		
I. Introductionhe majority of delays in the U.S. air traffic management systems are weather related.Convective weather reduces airspace capacity because flights must avoid severe weather.The reduction of airspace capacity causes traffic congestion when demand exceeds capacity.The level of capacity reduction depends the hazardous weather severity and the pilot's decision to fly around weather.Weather, pilot's decisions, and airspace demand are stochastic in nature.Innovative modeling methods are needed to ensure that air traffic flows smoothly and efficiently under these uncertainties.One approach is to calculate optimal routes between origin and destination, while meeting the airspace capacity constraint.An air traffic flow management system can then use the optimal routes to reroute flights around convective weather and congested airspace.Several rerouting algorithms [1][2][3][4][5][6] that utilize weather forecast have been developed in recent years.The studies in Refs.1-2 reduce the optimal routing problem to a shortest path search.They calculate optimal routes that avoid hazardous weather with a severity level suggested by the Federal Aviation Administration (FAA) Aeronautical Information manual.The study in Ref. 3 develops an algorithm that reroutes aircraft locally around regions of the airspace whose capacities are exceeded.The algorithm is designed to minimize the number of piece-wise linear route segments needed to circumvent these areas.To better estimate weather impact on airspace capacity, a recent study 7 developed a quantitative model predicting when a pilot would deviate around convective weather in en route airspace.By applying the quantitative convective weather avoidance model, the studies in Refs.4-5 develop an automated system for rerouting aircraft around hazardous weather during the en-route segment of air traffic.The flight routing algorithm in Ref. 6 is based on dynamic programming and utilizes the predicted probability that an aircraft will deviate around convective weather.The algorithms [4][5][6] solve for the optimal reroutes by avoiding convective weather systems exceeding a pre-specified deviation probability, i.e. capacity of weather-impacted airspace is considered deterministic.The work in Ref. 8 models the weather process as a stationary Markov process without considering uncertainty in pilot decisions and solves the routing problem using stochastic dynamic programming.Although the weather forecasts are used in these studies [1][2][3][4][5][6]8 , none incorporate in the algorithm the airspace demand prediction and stochastic nature of flight deviation.This study develops an algorithm that reroutes flights in the presence of winds, en route convective weather, and congested airspace.It is based on stochastic dynamic programming and utilizes the convective weather avoidance model and the airspace demand prediction model.Both uncertain weather forecasts and pilots' probabilistic decisions when encountering convective weather contribute to the stochastic nature of airspace capacity prediction.A model that captures the stochastic disturbance to aircraft motion is developed to better incorporate uncertainty in the airspace capacity prediction.This study employs a trajectory-based airspace demand model for tracking current and predicting future airspace demand.The rerouting algorithm generates flight paths that minimize the total expected traveling time, weather incursion, and induced congestion costs.Section II presents the formulations of the stochastic dynamic programming algorithm.Section III models convective weather as stochastic disturbances to aircraft motion.Section IV calculates cost of time for aircraft that travel in winds.Section V discusses cost for aircraft crossing a congested sector.Section VI explains setup for the experiments, and the results are discussed in Section VII. Conclusions and future works are summarized in Section VIII.
II. Stochastic Dynamic Programming FormulationThis study uses the Stochastic Dynamic Programming (SDP) method to search for the optimal flight path between two locations.The dynamic equation for an aircraft between the initial position with time !x 0 (t 0 ) and the final position with time! x f (t f ) is specified by the following equation, ! x " i , j +1 (t " i , j +1 ) = x i, j (t i, j ) + u i, j (t i, j ) + # i, j (u),(1)where !i, j, and " i are integer grid indices; !i denotes an arbitrary state;! j denotes an arbitrary stage;! " i denotes an arbitrary state at the next stage; !t i, j represents the estimated arrival time at grid !i, j ; !x i, j (t i, j ) is the aircraft position; !u i, j (t i, j ) is the decision variable defined in a set of admissible controls !U i, j ; and !" i, j (u) is the stochastic disturbance.In the finite stage SDP formulation, the minimum cost-to-go function !J (x i, j (t i, j )) at any state is calculated recursively by the following equation,! J (x i, j (t i, j )) = min u i, j (t i, j ) E " i, j (u) {# j [ g(u i, j (t i, j ) + " i, j (u)) + J (x $ i , j +1 (t $ i , j +1 ))]},(2)where !" is the discount factor with !0 < " # 1, and !g(•) is the transition cost from the current state to the next state.The scalar !" discounts future costs less than the same costs incurred at the present time.The transition cost in this study is defined as, !g(u i, j (ti, j ) + " i, j (u)) = T i, j,t i, j # i , j +1,t # i , j +1 + C i, j,t i, j # i , j +1,t # i , j +1 " i, j (u) $ %u i, j (t i, j ), W i, j,t i, j # i , j +1,t # i , j +1 otherwise, & ' ( ) ((3)where! T i, j,t i, j " i , j +1,t " i , j +1 is the time cost of transitioning from ! x i, j (t i, j ) to ! x " i , j +1 (t " i , j +1 ). The component ! C i, j,t i, j " i , j +1,t "i , j +1 is the cost of crossing a congested region and is equal to the constant! K Congestion . The component ! W i, j,t i, j " i , j +1,t "i , j +1 is cost of the reroute due to the convective weather.It is equal to a user-specified constant cost !K Weather .After finding the minimum cost-to-go function !J (x i, j (t i, j )) at all states, the optimal flight path, which is the sequence of optimal controls !u i, j (t i, j ), can be determined by minimizing the total cost from the origin to the destination.The computation time of the dynamic programming method is very high because the optimal solution at each grid point has to be computed to provide a globally optimal solution.Previous work 6 that constructs the grids and groups them into stages shows that the optimal path is obtained in linear time.This study adapts the same procedure and also obtains the optimal path in linear time.The grids for the search space and the procedures for finding the optimal flight path via stochastic dynamic programming algorithm are described in the Appendix.The procedures are an extension of those originally proposed in Ref. 6.
III. Disturbance ModelThis section presents the model development for the stochastic disturbance !" i, j (u) in the aircraft equation of motion.This disturbance is zero in the deterministic rerouting algorithms.Aircraft motion is often subjected to unknown disturbance inputs that originate from various sources.This study considers convective weather as the only source of stochastic disturbances.There are two types of uncertainty present in the disturbance due to convective weather.The first type is weather forecast uncertainty.Convective weather may or may not occupy a region of airspace in the future.The forecasts confidence levels may quantify this uncertainty.The second type is due to probabilistic nature of pilots' decisions when they encounter convective weather.Pilots may or may not choose to deviate around enroute convective weather.Convective Weather Avoidance Model (CWAM) quantifies this uncertainty based on historical observations.In this study, the stochastic disturbance !" i, j (u) statistics are calculated using CWAM data only.The development of the disturbance model remains the same when another type of disturbance uncertainty is considered.Section III.A provides an introduction to CWAM.Section III.B presents the formula for calculating probability of deviation from the tentative flight path due to convective weather.Section III.C models the stochastic disturbance.
A. Convective Weather Avoidance ModelCWAM is a quantitative model that integrates historical pilot decisions with Corridor Integrated Weather System (CIWS) weather forecasts to predict when a pilot will deviate around convective weather systems.MIT Lincoln Laboratory develops CIWS and CWAM.CIWS integrates data from national weather radars with thunderstorm forecasting technology and provides convective weather forecasts up to two hours in advance.CIWS weather depiction is composed of precipitation [Vertically Integrated Liquid (VIL)] and storm echo tops.CWAM calculates the fields identifying airspace regions pilots are likely to avoid due to convective weather.It uses CIWS VIL and echo top fields to predict aircraft deviations and penetrations.Each CWAM field has a probability of pilot deviation associated with it.Figure 1 shows CWAM weather data.The CWAM fields are outlined in different colors, which correspond to different deviation probabilities as labeled on the color bar.A pilot may encounter multiple severe weather systems (multiple CWAM weather fields) in the en-route airspace.It is necessary to consider the overall possibility of deviation from the given flight plan due to multiple severe weather systems along the planned flight trajectory.
B. Flight Deviation Probability for Independent DeviationsA previous study 6 develops the formula that uses all CWAM fields along the flight trajectory to calculate the probability of deviation from the given flight path.Assuming deviation events occur only when weather forecasts are updated and the events are independent, the formula is as follows:! P(D [t 0 ,t f ] ) = 1" # t k (1" P(D t k )),(4)where !t 0 , t f are the starting time and stopping time associated with the beginning and ending of a path;! , each CWAM field incursion is considered an independent event.The deviation probabilityD [! P(D t k ) = P(D [t k ,t k+1 ]) is calculated by Eq. ( 4) using a smaller time increment between !t k and t k +1 .
C. Flight Deviation Probability for Correlated DeviationsThis study extends the flight deviation probability formulation by relaxing the assumption that the deviation events are independent.In general, the deviation probability along a flight path, when the deviation events are correlated in time, is formulated as follows:! P(D [t 0 ,t f ] ) = P(U t k D t k ) = 1 " P(I t k D t k ), where ! D t k is the complement of ! D t k .Applying Bayes' rule to obtain the following equation:! P(D [t 0 ,t f ] ) = 1" P(D t f | I t k <t f D t k ) # P( I t k <t f D t k ).(5)Note that the last term in this equation is the probability of deviation at one time step before !t f .The probability of deviation at each step can be computed recursively using the deviation probability in the previous step if the conditional probability! P(D t f | I t k <t f D t k ) is known.The interpretation of the conditional probability is the pilot's decision on no deviation subject to past decisions.The true correlation for pilots' decisions over time may never be known.A hypothetical assumption is made here to provide a reasonable explanation for pilots' behavior.Assumption 1.A Pilot does not deviate from the current CWAM weather field if in the past the pilot did not deviate from the weather fields with equal or larger deviation probability.Under the above assumption, the formula for the conditional probability is! P(D t f | I t k <t f D t k ) = 1 " P(D t f | I t k <t f D t k ), P(D t f | I t k <t f D t k ) = 0 if P(D t f ) # max t k <t f [P(D t k )], P(D t f ) otherwise. $ % & ' &(
D. Model DevelopmentIn this study, the disturbance due to the convective weather is modeled as a random variable that takes on one of the four values given the control command! u i, j (t i, j ) = x " i , j +1 (t " i , j +1 ) # x i, j (t i, j ) : ! " i, j (t i, j ) = x # i , j +1 (t # i , j +1 ) $ x i, j (t i, j ) $ u i, j (t i, j ) x # i +1, j +1 (t # i +1, j +1 ) $ x i, j (t i, j ) $ u i, j (t i, j ) x # i $1, j +1 (t # i $1, j +1 ) $ x i, j (t i, j ) $ u i, j (t i, j ) $u i, j (t i, j ) = 0, x # i +1, j +1 (t # i +1, j +1 ) $ x # i , j +1 (t # i , j +1 ), x # i $1, j +1 (t # i $1, j +1 ) $ x # i , j +1 (t # i , j +1 ), x i, j (t i, j ) $ x # i , j +1 (t # i , j +1 ). % & ' ' ( ' ' % & ' ' ( ' '(7)The physical implication is that aircraft can travel from the current state to the target state
!x " i , j +1 when the disturbance is zero or in the absence of convective weather.In the presence of convective weather, a pilot can choose to deviate to the nearest two states! x " i +1, j +1 , x " i #1, j +1, or to reroute depending on the severity and location of convective weathers.Figure 2 shows four possible outcomes when aircraft encounter convective weather.The probability for each case is calculated as shown below:! P(ND) " P # i, j (u) = 0 u i, j (t i, j ) [ ] = 1 $ P(D [t i, j ,t % i , j +1 ] ) ,(8)where !ND is the event that the aircraft travels to the target state without deviation, and !D [t i, j ,t " i , j +1 ] denotes the event that flight path deviation occurs between !x i, j (t i, j ) and
!x " i , j (t " i , j +1 ).A pilot could choose to turn left, turn right or reroute when flight deviates from the anticipated path due to the presence of convective weather, i.e.& P(D $ A) + P(D $ B) + P(D $ RR) = P(D [t i, j ,t # i , j +1 ]).The aircraft reroutes only when both links to the two nearest states are completely blocked by the convective weather, i.e., !P(D [t i, j ,t " i +1, j +1 ] ) = 1 and P(D [t i, j ,t " i #1, j +1 ] ) = 1 . The reroute probability is ! P(RR) " P # i, j (t i, j ) = x i, j (t i, j ) $ x % i , j +1 (t % i , j +1 ) u i, j (t i, j ) [ ] , P(RR) = P(D & RR) = P(D [t i, j ,t % i , j +1 ] ) if P(D [t i, j ,t % i +1, j +1 ] ) = 1 and P(D [t i, j ,t % i $1, j +1 ] ) = 1, 0 otherwise. ' ( )(9)If the pilot has no preference between turning right or turning left, and the decision depends on the severity of convective weathers on both sides of the original path; the probability of turning right is! P(A) " P # i, j (u) = x $ i %1, j +1 (t $ i %1, j +1 ) % x $ i , j +1 (t $ i , j +1 ) u i, j (t i, j ) [ ] , P(A) = P(A & D) = P(A | D) ' P(D) Bayes' rule, P(A | D) = (1 % P(D [t i, j ,t $ i +1, j +1 ] )) (1 % P(D [t i, j ,t $ i +1, j +1 ] )) + (1 % P(D [t i, j ,t $ i %1, j +1 ] ))No preference for left or right,( P(A) = P(D [t i, j ,t $ i , j +1 ] ) ' (1 % P(D [t i, j ,t $ i %1, j +1 ] )) (1 % P(D [t i, j ,t $ i +1, j +1 ] )) + (1 % P(D [t i, j ,t $ i %1, j +1 ] )) ,(10)and the probability of turning left is! P(B) " P # i, j (u) = x $ i +1, j +1 (t $ i +1, j +1 ) % x $ i , j +1 (t $ i , j +1 ) u i, j (t i, j ) [ ] = P(D [t i, j ,t $ i , j +1 ] ) & (1 % P(D [t i, j ,t $ i +1, j +1 ] )) (1 % P(D [t i, j ,t $ i +1, j +1 ] )) + (1 % P(D [t i, j ,t $ i %1, j +1 ] )) . (11)The expectation is taken with respect to the disturbance when computing expected cost-to-go in Eq. ( 2).Combine Eq. ( 2), Eq.(3) and Eqs.(8-11) to rewrite the equation for optimal expected cost-to-go as! J (x i, j (t i, j )) = min u i, j (t i, j ) " j P(ND) # T i, j,t i, j $ i , j +1,t $ i , j +1 + C i, j,t i, j $ i , j +1,t $ i , j +1 + J (x $ i , j +1 (t $ i , j +1 )) [ ] +P(A) # T i, j,t i, j $ i %1, j +1,t $ i %1, j +1 + C i, j,t i, j $ i %1, j +1,t $ i %1, j +1 + J (x $ i %1, j +1 (t $ i %1, j +1 )) [ ] +P(B) # T i, j,t i, j $ i +1, j +1,t $ i +1, j +1 + C i, j,t i, j $ i +1, j +1,t $ i +1, j +1 + J (x $ i +1, j +1 (t $ i +1, j +1 )) [ ] +P(RR) # W i, j,t i, j $ i , j +1,t $ i , j +1 [ ] & ' (( ( ( ( ( ( ( ) * ++ + + + + + + . (12)The last term represents the cost of reroute due to convective weathers.Next section provides the calculation of aircraft travel time in winds.Section V computes the congestion cost for aircraft crossing congested regions.
IV. Aircraft Travel Time in WindThis study calculates travel time for aircraft in winds based on the works in Refs.9-10.Section IV.A introduces the weather prediction system that provides current and predicted wind measurements.Section IV.B outlines the calculation for aircraft travel time.
A. Rapid Update CycleThe Rapid Update Cycle (RUC) provides wind measurements to calculate aircraft travel time in wind.RUC is an operation weather prediction system developed by the National Oceanic & Atmosphere Administration (NOAA) for users needing frequently updated short-range weather forecasts (e.g.US aviation community).Figure 3 shows wind measurements from RUC on June 19, 2007.The arrows and colors indicate wind directions and magnitudes respectively.
B. Aircraft Transition CostThe value of time !T i, j,t i, j " i , j +1,t " i , j +1 associated with transitioning between two successive states !x i, j (t i, j ) and! x " i , j +1 (t " i , j +1) is proportional to the travel time between these two states.The value of time !T i, j,t i, j " i , j +1,t " i , j +1 is given by T i, j,t i, j " i , j +1,t " i , j +1 = K T # t , where !K T is the cost coefficient for travel time.Let the latitude and longitude of !x i, j and !x " i , j +1 be !(" i ,# i ) and !(" f ,# f ) , respectively.The travel time !t is given by:! t = d V g (13)and! d = R earth " cos #1 sin $ i "sin $ f + cos(% f # % i ) " cos $ i " cos $ f [ ] ,(14)where! d is great circle distance, !V g is ground speed, and !R earth is the radius of the Earth.The ground speed is calculated using the following equation,! V g = V " cos sin #1 ( V w V ) "sin($ w # $ gc ) % & ' ( ) * + , - . / 0 + V w " cos($ w # $ gc ) ,(15)where !V is the magnitude of the horizontal components of the aircraft velocity (i.e.airspeed), and !V w is the magnitude of the horizontal components of the wind velocity (i.e.wind speed).The wind heading angle !" w defines the direction of the horizontal component of the wind velocity.The great circle heading angle !" gc , which is required for flying the great circle route in the absence of winds, is computed by the following equation! " gc = tan #1 sin($ f # $ i ) % cos & f sin & f % cos & i # sin & i % cos & f % cos($ f # $ i ) ' ( ) ) * + , , .(16)The travel time !t between any two states is computed by using Eqs.(13-16).A weather-avoidance route in the presence of winds from MEM to EWR on June 19, 2007 is illustrated in Fig. 3 as an example.
V. Crossing a Congested SectorThe SDP routing algorithm predicts the enroute sector demand and compares it to sector capacity (i.e. the number of aircraft permitted in a region of the airspace) to calculate the congestion cost for each link.Sector capacity is the maximum number of aircraft that can be safely handled by a human controller.The traditional approach for predicting sector demand consists of propagating the current location of the aircraft forward in time using an aircraft performance model, flight-plan information, and Traffic Flow Management (TFM) restrictions.The predicted locations are then used to determine the number of aircraft in sectors at future times.Thus the traffic demand is based on the known TFM plans at the beginning of the prediction interval.This trajectory-based approach is used in the FAA Enhanced Traffic Management System (ETMS), 11 the Center TRACON Automation System (CTAS), 12 and the Future ATM Concepts Evaluation Tool (FACET). 13his study uses FACET to compute current and predicted sector demand.Knowledge of estimated sector demand allows the selection of alternate routes that both avoid weather and keep individual sector demands below Monitor Alert Parameter (MAP) values.The congestion cost at each grid !C i, j,t i, j " i , j +1,t " i , j +1 is determined by comparing current and predicted aircraft count in the enroute sectors to the MAP of each corresponding sector.Given the flight altitude, each grid is mapped to its corresponding sector.Because the arrival time at each grid is already estimated, the congestion cost is obtained by checking the current aircraft count inside the sector or predicted demand of the sector at the estimated arrival time interval.The congestion cost is equal to a constant !K congestion if the current or predicted sector demand exceeds the sector capacity, zero otherwise.
VI. Experimental SetupThis section presents setup of the experiments evaluating the SDP routing algorithm performance.Section VI.A discusses the generation of the optimal weather-avoidance routes applying the SDP algorithm and compares the SDP routes to those generated using a deterministic DP algorithm (DDP).Section VI.B discusses an experiment to reroute weather-impacted flights in the NAS around convective weather using SDP.This study uses NASA's Future ATM Concepts Evaluation Tool (FACET) to generate results.
A. Stochastic DP Vs. Deterministic DPThis part of the study compares weather-avoidance routes generated from the SDP algorithm to those calculated using DDP algorithm. 6The weather-avoidance routes are generated using actual and forecasted weather data from CWAM.The DDP algorithm, which is similar to many other weather avoidance algorithms, determines the routes that avoid only convective weather systems (e.g.CWAM) exceeding a predefined deviation probability, whereas SDP calculates the optimal routes that account for all the CWAM weather cells.In general, it is not clear which severity level of convective weather one should select for avoidance when designing reroutes using deterministic rerouting algorithm with CWAM.One set of SDP routes and five sets of DDP routes are generated.The sets of DDP routes avoid all CWAM weather cells with deviation probability exceeding 20%, 40%, 60%, 80%, and 100% deviation probability.The flight distance and deviation probability for each route are measured and compared.Figure 4 summarizes the experimental setup.The wind magnitude is assumed to be zero when calculating SDP routes because the DDP algorithm 6 neglects the effect of winds.This part of study also assumes no airspace congestion.The first test scenario includes the set of flights flying between the top 18 airports in the Central and Eastern region of the United States as listed in Table 1.Only flights that depart and land between 8:00 AM to 12:00 PM EDT on June 19, 2007 are considered.A major portion of the flights has traveling distance shorter than 900 nautical miles (nmi) or approximately 2 hours travel time that is within the range of CWAM forecasts.This mitigates the effect of weather forecast uncertainty.On this day, the convective weather system consists of a squall line that by early morning extends from the U.S.-Canadian border into Memphis Center.The line of storms moves throughout the day in an easterly direction and impacts the eastern shoreline by mid-afternoon. Figure 1 shows the weather fields from CWAM.A 6-hour fast time simulations is conducted to calculate the flight distance, predicted, and observed deviation probability for each flight using SDP.Five 6-hours fast time simulations are preformed using DDP.The predicted deviation probability is computed by Eq. ( 4) using CWAM forecasts.The observed deviation probability is calculated using the CWAM weather fields that aircraft actually encounter in the simulation.The SDP and DDP routes are calculated after the departure time.The size of the search grid is equal to 30 km.Grid arrival uncertainty !" as defined in the Appendix is 1.2.There are 5 different DDP routes for each flight.The fuel conversion constant !d fuel defined in Ref. 6 is 7 dollars/km.The weather cost !K Weather is $40,000 if any link intercepts CWAM weather fields that exceed the specified probability of deviation (i.e., 20%, 40%, … , 100%).There is one SDP route for each flight.The cost coefficient for travel time is converted from a fuel conversion constant using airspeed and is
Table 1. Top 18 airports in the! K T = d fuel " V .The weather cost !K Weather is set to be $40,000 if the neighboring links are completely blocked.The flight altitude is assumed to be constant at 35,000 feet.The choices for the weather and congestion costs are not unique and treated as design parameters.Note that the weather cost and congestion cost are at least one order magnitude larger than the fuel cost because in general, the first priority of optimal routing is to avoid the convective weather without traveling through any congested sector.
B. SDP RoutingThis part of the study compares the original flight routes to those generated from the SDP algorithm.SDP routing algorithm calculates flight path for pre-departure aircraft that fly between the top 25 airports in the United States.These airports include Denver International Airport (DEN), Las Vegas-McCarran International Airport (LAS), Los Angeles International Airport (LAX), Phoenix Sky Harbor Airport (PHX), Seattle-Tacoma International Airport (SEA), San Francisco International Airport (SFO), Salt Lake City International Airport (SLC), and the airports listed in Table 1.ETMS provides original flight plan, initial aircraft position and departure time for each flight.The input to the simulations is derived from the ETMS, CWAM and RUC data set for June 19.2007.Only flights that depart and land between 8:00 AM to 12:00 PM EDT are considered.Figure 5 summarizes the experimental setup.These flights are rerouted around convective weather in the presence of winds and sector congestion.The SDP algorithm calculates flight paths with sector demand predictions from FACET.FACET predicts aircraft count for all the 'High Altitude' sectors in 15 minutes intervals up to 2 hours ahead.FACET computes sector demand without aircraft that fly between the top 25 airport pairs because the SDP algorithm reroutes these flights.The SDP algorithm uses sector demand data to compute reroutes for congestion avoidance; it updates en-route sector demand using predicted aircraft positions along the new reroutes.Sector demand data are maintained throughout the entire analysis; it is updated and retrieved sequentially for every reroute by the SDP algorithm.FACET re-computes sector demand every two hours.The performance of the SDP algorithm is evaluated for each flight by computing the travel time, total time flying inside congested sectors, and the probability of deviation.A 6-hour fast time simulation is conducted to calculate the total travel time, total minutes in congested sectors, deviation probability, and most severe CWAM fields encountered for each flight.The observed deviation probability is computed by Eqs.(5-6).The design parameters are the same as those defined in Section VI.A.Each flight is assumed to be flying at the commended cruising altitude.
VII. Results
A. Stochastic DP Vs. Deterministic DPThis section presents flight distance and deviation probability for the SDP routes and the DDP routes.There are a total of 774 scheduled flights that depart and land between 8:00 AM to 12:00 PM EDT on June 16, 2007 between the 18 selected airport pairs.Figure 6 shows three bar charts that record the flight distance, the predicted deviation probability, and the observed deviation probability for the SDP routes.The first chart is the distribution of flight distance measured in nautical miles among 15 bins with centers specified on the horizontal axis.The second and third charts show the distribution for the predicted and observed deviation probability, respectively.Most (87%) of the flights have traveling distance shorter than 900 nmi or approximately 2 hours travel time that is within the range of CWAM forecasts.These flights are selected to mitigate the effect of uncertainty in the weather forecasts.Over 85% of SDP routes have 0% predicted deviation probability, but only about 60% of flights have 0% observed deviation probability due to the uncertainty in weather forecasts.Note that the SDP algorithm calculates reroutes that minimize expected deviation cost instead of avoiding all severe weather systems.A portion of SDP routes have nonzero predicted probability of deviation.The SDP route is compared to the DDP routes for each individual flight.Table 2 summarizes the distributions for the difference in the flight distance, predicted, and observed deviation probability between the SDP routes and the DDP routes.The flight distance between SDP and DDP 40%+ routes has smallest mean absolute difference.They have similar total flight distance from the entire system point of view.The large standard deviation indicates that each individual SDP route and its DDP counterparts are very different in design.Both the predicted and observed deviation probability between SDP and DDP 20%+ routes have smallest mean absolute difference.SDP routes have overall shorter flight distances than DDP 20%+ while achieving a similar level of deviation probability.
B. SDP RoutingThis section presents results for SDP routes compared to original flight paths.There are a total of 1255 scheduled flights that depart and land between 8:00 AM      The first chart of Fig. 11 presents the observed deviation probability for the original routes and SDP routes, and the second chart shows the most severe CWAM fields that the flights encounter enroute in the simulation.SDP routes and the original routes have similar distributions.In general, the SDP routes have smaller calculated deviation probability than the original flights.A smaller percent of SDP routes encounter CWAM fields that are larger than 50% deviation probability.Note that more than 10% of original routes encounter CWAM fields that have 90% probability of deviation.In this experiment, the SDP algorithm generates reroutes that intercept less severe weather than the original routes.
VIII. ConclusionThis study develops a routing algorithm that reroutes flights based on stochastic dynamic programming in response to winds, hazardous weather, and congested airspace.A stochastic disturbance model is developed to better incorporate into the reroute design process the uncertainty of airspace capacity due to the probabilistic nature of pilot decisions or uncertain weather forecast.The optimal routes minimize the total expected traveling time, weather incursion, and induced congestion costs.They are compared to weather-avoidance routes calculated using deterministic dynamic programming.The stochastic reroutes and the deterministic reroutes avoiding convective weather fields exceeding 40% deviation probability have similar total flight distance, and the stochastic reroutes have smaller deviation probability than the deterministic counterpart.The stochastic rerouting algorithm takes into account all convective weather fields with all severity levels whereas the deterministic algorithm only accounts for convective weather systems exceeding a specified level of severity.The stochastic reroutes and the original flight routes have similar total flight time, and both have about 1% of travel time crossing congested en-route sectors on average.The original flight routes induce slightly less traffic congestion than the stochastic reroutes but intercept more severe convective weather.
AppendixThe following outlines procedures for finding the optimal flight path via the stochastic dynamic programming algorithm.The procedures are similar to and modified from those in Ref. 6.The procedures are summarized as the following:for each origin (or starting) and destination pair,
! P(RR).• The estimated cost of travelling time! T i, j,t i, j " i , j +1,t " i , j +1 for aircraft in winds, • The congestion cost ! C i, j,t i, j " i , j +1,t " i , j +1 ,• The rerouting cost !W i, j,t i, j " i , j +1,t " i , j +1 due to convective weather. 5. Calculate the optimal expected cost-to-go !J (x i, j (t i, j )) .end for end for 6.Find the optimal path by minimizing the total cost over all stages.end for end for 1.The first step in searching for the optimal route is to apply a discretization scheme to the airspace (which occupies a region involving the starting position !x 0 (t 0 ) and the destination position !x f (t f ) to obtain the discrete search space.In this study, the search space is defined by Cartesian grids.The latitude and longitude of the origin and destination points are transformed into the Cartesian coordinates.When the size of the search space and the dimension of the grids are specified, the total number of admissible states and stages can be determined.The admissible states are evenly distributed on a rectangular plane formed by the startto-end vector, which points from the starting point to the destination point, and the vector perpendicular to it.The number of states is set to be equal on both sides of the start-to-end vector.The Cartesian coordinates of the states are calculated using the two directional vectors.In general, the position !x i, j can be located by going along the normalized start-to-end vector for !j steps and going along the normalized perpendicular vector for !i steps.2. Once the grid has been created, the times of arrival !t i, j at each state !x i, j are estimated given the aircraft speeds and the initial time !t 0 .Please note that the initial time can be the tentative departure time of an aircraft or the time that an aircraft is subject to tactical reroute.Each arrival time is assumed to be within a time interval defined by " is assumed to be constant in this study.Although it can be time-varying and route-specified.Note that only the estimated arrival times vary, while the set of the admissible positions remains unchanged, when the initial time is changed.3. Having calculated the coordinates of the states and the corresponding estimated arrival times, the next step is to define the set of admissible controls !U i, j .Here, a simple rule is adopted by assuming that an aircraft can travel from the starting point to any state defined in the first stage.Similarly, it can go directly from any state in the last stage to the destination.When an aircraft reaches the boundary of the search space, it is only allowed to travel along the boundary ( ! x i min , j to x i min , j +1 or x i max , j to x i max , j +1 ) or fly towards the inside of the search space
!x i min , j to x i min +1, j +1 or x i max , j to x i max "1, j +1 .When an aircraft is at any intermediate state, it can travel to the nearest three states at the next stage !x i, j to x i, j +1 or x i, j to x i"1, j +1 or x i, j to x i+1, j +1 .The computation time to solve a DP problem is very high because the cost-to-go function at all reachable states, which is determined by the number of possible links between each state, must be computed to provide a globally optimal solution.Therefore, allowing fewer links between each state and constructing a heuristic search space that defines stages to guide the searching process toward the destination can reduce the computation time.4. The probability of the four possible events is computed using Eqs.(8-11) with CWAM data.The fuel cost or cost of time is proportional to the total travel time for aircraft in winds and can be estimated using a user specified constant !K T .The congestion cost is equal to a constant !K congestion if the current or predicted sector demand exceeds the maximum threshold.The rerouting cost due to severe weather is also equal to a constant !K Weather . 5. The optimal expected cost-to-go function at each admissible state is calculated backward by using Eq. ( 12). 6.The optimal flight path, which is the sequence of optimal controls !u i, j (t i, j ), is determined by minimizing the total cost from the origin to the destination.Then, the flight plan is specified by a sequence of latitude and longitude translated from the optimal controls.Figure 1 .1Figure 1.CWAM output for 8:00 AM EDT on June 19, 2007.
t k ) for !t 0 " t k " t f can be obtained from the output of CWAM.The probability !P(D t k ) is zero if the aircraft does not incur any CWAM weather field between !t k and t k +1 .If the aircraft incurs a CWAM weather field between !t k and t k +1 , the probability !P(D t k ) is the pilot deviation probability associated with the CWAM field.If the aircraft incurs multiple CWAM weather fields between !t k and t k +1 , the deviation probability !P(D t k ) = P(D [t k ,t k+1 ] ) is calculated by Eq. (5) using a smaller time increment between !t k and t k +1 .
Figure 2 .2Figure 2. The four possible outcomes when aircraft encounter convective weathers.
!P(D [t i, j ,t " i , j +1 ] ) # 0 .Denoting !D as the event of deviation, !A as the event of deviation to the right, !B as the event of deviation to the left and !RR as the event of reroute, it can be shown that !P(D) = 1" P(ND) = P(D [t i, j ,t # i , j +1 ] ) D, ND are mutually exclusive, P(D) = P(D $ (A % B % RR)) By definition, & P(D $ (A % B % RR)) = P(D $ A) + P(D $ B) + P(D $ RR) A, B and RR are mutually exclusive,
Figure 3 .3Figure 3.A weather-avoidance route in winds from MEM to EWR calculated by SDP algorithm at 10:05 AM EDT on June 19, 2007.
Figure 4 .4Figure 4. Experimental setup for evaluating SDP and DDP rerouting algorithm.
Central and Eastern region of the United States.Hartsfield-Jackson Atlanta International Airport (ATL) John F Kennedy International Airport (JFK) Boston Logan International Airport (BOS) LaGuardia Airport (LGA) Charlotte/Douglas International Airport (CLT) Orlando International Airport (MCO) Cincinnati/Northern Kentucky International Airport (CVG) Chicago Midway Airport (MDW) Dallas/Fort Worth International Airport (DFW) Memphis International Airport (MEM) Detroit Metropolitan Wayne County Airport (DTW) Miami International Airport (MIA) Newark Liberty International Airport (EWR) Minneapolis-St Paul International Airport (MSP) Washington Dulles International Airport (IAD) Chicago O'Hare International Airport (ORD) George Bush Intercontinental Airport (IAH) Philadelphia International Airport (PHL)
Figure 5 .5Figure 5. Experimental setup for comparing the SDP reroutes to the actual flight routes.
Figure 6 .6Figure 6.Flight distance, predicted and observed deviation probability for the SDP routes.
Figure 7 .7Figure 7. Flight distance for the SDP and DDP routes.
Figure 77Figure7shows the distribution of flight distance for the SDP routes and the DDP routes that avoid CWAM weather fields exceeding 20%, 40%, 60%, 80% and 100% deviation probability.The distribution for the SDP routes are most similar to that of DDP routes avoiding CWAM fields with 40%+ deviation probability.
Figure 8 .8Figure 8. Observed probability of deviation for the SDP and DDP routes.
Figure 88Figure 8 presents the distribution of the observed deviation probability for the SDP routes and the DDP routes.DDP routes avoiding only CWAM fields with higher deviation probability are more likely to deviate.The 20%+ DDP routes have the smallest observed probability of deviation whereas 100% DDP routes have the highest deviation probability in the group.The distribution of SDP routes is closest to that of 20%+ DDP routes but SDP routes have shorter traveling distance on average.The deviation probability for a SDP route is not equal to the probability of rerouting.Aircraft flying SDP routes are subjected to reroute only if the neighboring paths (links) are completely blocked by convective weather that have 100% deviation probability.In general, SDP routes are better prepared for possible flight deviations because the neighboring paths are considered during the design process.
to 12:00 PM EDT on June 19, 2007 between the top 25 airports.A 6-hour fast time simulation is conducted to calculate the travel time, total time inside congested enroute high altitude sectors, and deviation probability for each flight flying SDP routes.Another 6-hour fast time simulation is preformed using original flight plans.
Figure 9 .9Figure 9. Traveling time for the original and SDP routes.
Figure 99Figure9shows the traveling time for the original and SDP routes.The travel time includes wind effect.SDP routes have total travel time of 2110 hours that is slightly shorter (0.9%) than the 2130 hours for original routes.Ninety-five percent of SDP routes have less than 15 minutes additional travel time when compared to the original route.A total of 45.9 hours additional travel time is recorded when neglecting the flights that SDP routes have shorter travel times.
Figure 10 .10Figure 10.The time for aircraft inside congested sectors.
Figure 1010Figure10shows the time that aircraft fly inside congested sectors.Original routes have 1362 congestion minutes in total while SDP routes have 1544 congestion minutes.In general, original routes incur less congestion than the SDP routes.However, the congestion minutes are only 1% of the total traveling time.Both the original routes and the SDP routes caused little congestion.SDP routes cannot avoid congested sectors completely because aircraft position prediction loses accuracy over time due to the approximations made in the computations.
Figure 11 .11Figure 11.The deviation probability and most severe weather encounter for the original and SDP routes.
Table 2 . Differences in the traveling distance, predicted, and observed deviation probability between SDP routes and DDP routes.2SDP -SDP -SDP -SDP -SDP -DDP 20%+DDP 40%+DDP 60%+DDP 80%+DDP 100%(Mean Absolute Difference, Standard Deviation)Flight Distance Pred. Deviation Obs. Deviation(28, 74) (0.04, 0.12) (0.10, 0.19)(22, 90.6) (0.10, 0.17) (0.13, 0.21)(25, 85) (0.16, 0.24) (0.15, 0.24)(33, 88) (0.25, 0.34) (0.17, 0.26)(40, 89) (0.31, 0.40) (0.19, 0.27)
		
		
			

				


	
		Sequential Traffic Flow Optimization with Tactical Flight Control Heuristics
		
			SGrabbe
		
		
			BSridhar
		
		
			AMukherjee
		
	
	
		Journal of Guidance, Control, and Dynamics
		
			32
			3
			
			May-June 2009
		
	
	Grabbe, S., Sridhar, B., and Mukherjee, A., "Sequential Traffic Flow Optimization with Tactical Flight Control Heuristics," Journal of Guidance, Control, and Dynamics, Vol. 32, No. 3, May-June 2009, pp. 810-820.



	
		Automated Route Generation for Avoiding Deterministic Weather in Transition Airspace
		
			JimmyKrozel
		
		
			StevePenny
		
		
			JoesphPrete
		
		
			JoesephMitchell
		
	
	
		Journal of Guidance, Control, and Dynamics
		
			30
			1
			
			2007
		
	
	Krozel, Jimmy, Steve Penny, Joesph Prete, and Joeseph Mitchell, 2007, "Automated Route Generation for Avoiding Deterministic Weather in Transition Airspace," Journal of Guidance, Control, and Dynamics, Vol. 30, No. 1, pp. 144-153.



	
		Integration of Traffic Flow Management Decisions
		
			BSridhar
		
		
			GBChatterji
		
		
			SGrabbe
		
		
			KSheth
		
	
	
		AIAA Guidance, Navigation and Control Conference and Exhibit
		Monterey, California, AIAA
		
			August 2002
		
	
	Paper 2002-5014
	Sridhar, B., Chatterji, G. B., Grabbe, S., and Sheth, K., "Integration of Traffic Flow Management Decisions," AIAA Guidance, Navigation and Control Conference and Exhibit, Monterey, California, AIAA Paper 2002-5014, August 2002.



	
		Convective Weather Avoidance with Uncertain Weather Forecasts
		
			RDWindhorst
		
		
			MRefai
		
		
			SKarahan
		
	
	
		Digital Avionics Systems Conference
		Orlando, FL
		
			October 2009
		
	
	Windhorst, R. D., Refai, M., and Karahan, S., "Convective Weather Avoidance with Uncertain Weather Forecasts," Digital Avionics Systems Conference, Orlando, FL., October 2009.



	
		Analysis of Automated Aircraft Conflict Resolution and Weather Avoidance
		
			JFLove
		
		
			WNChan
		
		
			CHLee
		
	
	
		AIAA Aviation Technology, Integration, and Operations Conference
		Hilton Head, South Carolina
		
			September 2009
		
	
	Love, J. F., Chan, W. N., and Lee, C. H., "Analysis of Automated Aircraft Conflict Resolution and Weather Avoidance," AIAA Aviation Technology, Integration, and Operations Conference, Hilton Head, South Carolina, September 2009.



	
		Design and Evaluation of a Dynamic Programming Flight Routing Algorithm Using Convective Weather Avoidance Model
		
			HokKNg
		
		
			ShonGrabbe
		
		
			AvijitMukherjee
		
		AIAA-2009-5862
	
	
		AIAA Guidance, Navigation, and Control Conference
		Chicago, Illinois
		
			August 2009
		
	
	Ng, Hok K., Shon Grabbe, and Avijit Mukherjee, August 2009, "Design and Evaluation of a Dynamic Programming Flight Routing Algorithm Using Convective Weather Avoidance Model," AIAA-2009-5862, Chicago, Illinois, AIAA Guidance, Navigation, and Control Conference.



	
		An Exploratory Study of Modeling Enroute Pilot Convective Storm Flight Deviation Behavior
		
			RDelaura
		
		
			JEvans
		
	
	
		12th Conference on Aviation Range and Aerospace Meteorology
		Atlanta, GA
		
			American Meteorological Society
			January 2006
			
		
	
	DeLaura, R. and Evans, J., "An Exploratory Study of Modeling Enroute Pilot Convective Storm Flight Deviation Behavior," 12th Conference on Aviation Range and Aerospace Meteorology, American Meteorological Society, Atlanta, GA, January 2006, p. 12.6.



	
		Trajectory-Based Air Traffic Management (tb-atm) Under Weather Uncertainty
		
			ANilim
		
		
			LElGhaoui
		
		
			VDuong
		
		
			MHansen
		
	
	
		Proc. of the Fourth International Air Traffic Management R&D Seminar ATM
		of the Fourth International Air Traffic Management R&D Seminar ATMSanta Fe, New Mexico
		
			2001
		
	
	A. Nilim, L. El Ghaoui, V. Duong, and M. Hansen. "Trajectory-Based Air Traffic Management (tb-atm) Under Weather Uncertainty," In Proc. of the Fourth International Air Traffic Management R&D Seminar ATM, Santa Fe, New Mexico, 2001.



	
		En-route Trajectory Prediction for Conflict Avoidance and Traffic Management
		
			GBChatterji
		
		
			BSridhar
		
		
			KDBilimoria
		
	
	
		AIAA Guidance Navigation and Control Conference
		San Diego, CA
		
			July 29-31, 1996
		
	
	Chatterji, G. B., Sridhar, B., and Bilimoria, K. D., "En-route Trajectory Prediction for Conflict Avoidance and Traffic Management," AIAA Guidance Navigation and Control Conference, San Diego, CA, July 29-31, 1996.



	
		AIAA Guidance, Navigation, and Control Conference. 11 "Enhanced Traffic Management System (ETMS) Functional Description
		
			SGrabbe
		
		
			BSridhar
		
		
			NCheng
		
		VNTSC-DTS56-TMS-002
	
	
		Volpe National Transportation System Center
		
			August 2006. January 2000
			Keystone, Colorado; Cambridge, MA
		
	
	Central East Pacific Flight Routing
	Grabbe, S., Sridhar, B., Cheng, N., August 2006, "Central East Pacific Flight Routing," AIAA-2006-6773, Keystone, Colorado, AIAA Guidance, Navigation, and Control Conference. 11 "Enhanced Traffic Management System (ETMS) Functional Description," Volpe National Transportation System Center, VNTSC-DTS56-TMS-002, Cambridge, MA, January 2000.



	
		Design of Center-TRACON Automation System
		
			HErzberger
		
		
			TJDavis
		
		
			SGreen
		
	
	
		Proceedings of the AGARD Guidance and Control Panel 56 th Symposium on Machine Intelligence in Air Traffic Management
		the AGARD Guidance and Control Panel 56 th Symposium on Machine Intelligence in Air Traffic ManagementBerlin, Germany
		
			1993
			
		
	
	Erzberger, H., Davis, T. J., and Green, S., "Design of Center-TRACON Automation System," Proceedings of the AGARD Guidance and Control Panel 56 th Symposium on Machine Intelligence in Air Traffic Management, Berlin, Germany, 1993, pp. 52-1 -14.



	
		FACET: Future ATM Concepts Evaluation Tool
		
			KBilimoria
		
		
			BSridhar
		
		
			GBChatterji
		
		
			KSheth
		
		
			SGrabbe
		
	
	
		Air Traffic Control Quarterly
		
			9
			1
			
			2001
		
	
	Bilimoria, K., Sridhar, B., Chatterji, G. B., Sheth, K., and Grabbe, S., "FACET: Future ATM Concepts Evaluation Tool," Air Traffic Control Quarterly, Vol. 9, No. 1, 2001, pp. 1-20.


				
			
		
	
