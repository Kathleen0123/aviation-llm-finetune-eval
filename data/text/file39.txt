
	
	
		
TABLE OF CONTENTSLIST
A PATH-STRETCH ALGORITHM FOR CONFLICT RESOLUTIONRalph Bach,1 Yung-Cheng Chu, 1 and Heinz Erzberger2Ames Research Center
I. INTRODUCTIONConsider two aircraft that are first predicted to be in conflict at some instant between 2 and 20 minutes after the current time.(A conflict occurs when horizontal separation is less than 5 nmi when vertical separation is less than 1000 ft.)An effective resolution of the conflict can be for one aircraft to implement a "path stretch," a maneuver that involves a turn from its present course with a turn back to a downstream waypoint, while achieving a specified delay.Delay is defined as the difference in the estimated times to the return waypoint along the resolution path and the original path.The maneuver may be started while the aircraft is in climb, cruise, or descent, and should be independent of the vertical profile defined by its flight plan.A path-stretch maneuver is particularly useful when two aircraft are "in trail" when the leading aircraft is slower, or when descending arrivals on converging routes are predicted to be in conflict near the arrival fix.While this maneuver can provide a specified delay if flown properly, there is no guarantee that a specified separation will be achieved between the conflicting aircraft.Even if the maneuver clears the conflict, the separation achieved may be excessive, or the conflict may recur at a downstream location.Therefore, it is essential that the maneuver-generation process be part of a decision-support system that checks each "trial-plan" maneuver for conflicts before a clearance is issued to the aircraft.This monograph documents a simple and reliable path-stretch algorithm included with a suite of automated resolutions for the Airspace Concept Evaluation System (ACES), an air-traffic simulation (ref.4).This paper presents the path-stretch algorithm along with a procedure for turning back to a waypoint to resume the original flight plan.The paper begins with a review of the path-stretch scenario, followed by a description of the basic algorithm.The logic for choosing a turn, a turn-back point, and a return waypoint to achieve a given delay is covered.Next, the inclusion of constant-radius turns is described.Subsequent sections discuss how the algorithm fits into the AAC-ACES interface along with a case study to illustrate its use, and finally, concluding remarks.An appendix reviews the rhumbline equations used in the algorithm to compute heading and distance between points on the Earth defined by latitude and longitude parameters.
II. BASIC "PATH-STRETCH" IDEAA useful starting point for describing a path-stretch maneuver is to consider the flight-path horizontal projection shown in figure 2.1.The aircraft is flying in an easterly direction, where the small circle indicates the initial position, the dashed line indicates the intended flight path, and each small square identifies a waypoint.The point of separation loss is marked with an asterisk (the predicted path for the other aircraft in the conflict is not shown).A path-stretch maneuver will consist of legs L V (a turn of an angle from the current heading) and L R (a turn back to a candidate downstream waypoint).The legs form a triangle with base R (a line from the initial point to the return waypoint).Note that all "straight" lines in figure 2.1 are actually rhumblines on the Earth surface (see appendix A).Preferred operational procedure requires that L V ≤ L R .Thus, the maximum path-stretch length available for a given turn and return waypoint would be obtained when an isosceles triangle is formed with the base R (L V = L R ).Although the airspeed along each leg is assumed constant, the wind field encountered will affect the groundspeed, so the delay achieved in this case may not be maximum.However, the L V = L R case is a useful way to proceed: If the required delay by a path stretch to a given return waypoint is less than that attained by the equal leg-length path, the required delay can be found by "sliding" the turn-back waypoint down the vector leg toward the initial point.
Selection of Candidate WaypointsTo complete a path stretch, the maneuvering aircraft must return to its original flight path, preferably to a designated flight-plan waypoint.To be a candidate for return, a waypoint must have a line-ofsight (LoS) range from the initial point within suitable limits.The minimum range is set to twice the distance to separation loss, a distance usually available in the conflict data record.The maximum range is set to the lesser of the range to the final fix and 500 nmi.The final fix is excluded unless there is no other candidate.If no flight-plan waypoint exists within the range window, one or more waypoints may be inserted and the one ultimately selected added to the flight plan.
Initial pointTurn-back waypoint Return waypointL V L R R Conflict *
Calculation of Maximum DelayWith return waypoints selected as indicated previously, turns will be chosen from a set, say, 15, 30, or 45 degrees (in either direction) for each aircraft, and path-stretch trial plans for conflict resolution will be created to achieve delays of, for example, 1.5, 3.0, and 5.0 minutes.However, not every turn-waypoint combination will be capable of yielding a maneuver with the desired delay.It is helpful to calculate and store the maximum delay T for each rhumbline isosceles triangle associated with a given turn-waypoint pair prior to creation of trial-plan maneuvers.The procedure for finding a triangle with two equal sides of length L starts by using the heading and length R of the base leg to calculate the angle (see figure 2.1):(2.1)where X V , the heading of the vector leg, is given by(2.2)where I is the initial heading.A Newton-Raphson algorithm has been devised to yield the position of the turn-back point using a starting value for the heading of the return leg(2.3)that is based on a planar isosceles triangle.With the resulting length L, the maximum delay obtainable for a given turn-waypoint pair is estimated fromT = L *(1/V V + 1/V R ) -T C (2.4)where V V and V R are the groundspeeds predicted along the paths, and T C is the predicted time at the candidate waypoint for the original trajectory.
III. CALCULATING THE DESIRED DELAYFor a vector turn and return waypoint that can yield a desired delay < T, an estimate of the length of the vector leg L V that will realize that delay can be made.where V is the average groundspeed along the path.This value will serve as a starting value for calculating the vector leg of the path-stretch maneuver, unless it is greater than some maximum (say 100 nmi).In that case, choose a larger vector turn ( is selected from a fixed set of values, e.g., 15, 30 or 45 degrees), and calculate a new L V .Now, with the vector-leg heading V and starting value of L V , perform the following steps:1. Determine the position of the turn-back waypoint (φ, λ) tb using eq.(A.5) or eq.(A.6) with L = L V and (φ 1 , λ 1 ) = (φ, λ) I (the initial position).2. Calculate the return vector (X R , L R ) from the turn-back waypoint to the return waypoint (φ, λ) rt , using eqs.3. Estimate the delay accumulated along the stretched path from the initial point to the return waypoint as(3.3)where T R is the estimated time at the return waypoint, and V V and V R are the groundspeeds along the legs, using the estimated winds and the average of the airspeeds at the initial and return points.If the desired delay > T for a given turn-waypoint combination, then a waypoint farther downstream (if there is one) can be tried with the same vector turn, or, a larger turn (if possible) can be tried with the same return waypoint.Note that each trial maneuver should be checked for conflicts by a decision-support system.Once a maneuver is predicted to be conflict free, a clearance to perform the maneuver can be issued to the aircraft.
Accounting for WindsClearly, the delay predicted for a path-stretch maneuver will be closer to that realized in practice if a reasonable estimate of the wind field can be used in the algorithm described earlier.This estimate may not be so important for conflicts predicted during en route portions of flight, since each trial maneuver will have been checked for conflicts.However, for aircraft in an arrival stream that are being sequenced, accurate delay estimates for conflict resolutions are important, so the path-stretch algorithm has been written to account for the wind field along the aircraft trajectories.Application of the algorithm requires that the conflict-detection data include the aircraft "state" at each flight-plan waypoint, or enough information to predict it.This state includes time, latitude, longitude, altitude, airspeed, heading, and winds.For each turn-waypoint pair, airspeed, wind speed and direction are averaged and assumed constant over the stretched path, except during the initial and final turns.Because the ground track along the path is known, the ground speed along each leg can be computed from(3.4)where V A is airspeed, V W is wind speed, and is the angle between the wind direction and ground track.It is assumed that V W < V A .
IV. ADDING "INSIDE" TURNSIt is relatively straightforward to modify the procedure described in the previous sections to include constant-radius turns with the maneuver specification.This inclusion should serve to improve the correspondence between the requested trial plan and the maneuver actually performed.The situation is illustrated in figure 4.1, which shows that when heading for a downstream waypoint, the turn to the next heading is initiated before that waypoint.Hence the turn at point TB to the return-leg heading and the turn at point RT to the flight-plan heading are called "inside" turns.If 1 is the turn from the initial heading to the vector heading, let the subsequent turns to the return heading and the flight-plan heading be 2 and 3 , respectively.The arc lengths for the three (coordinated) turns are then (4.1)In eq. ( 4.1), V A is the average airspeed, is the (constant) bank angle, and g is the gravitational constant.The straight portions of the vector and return legs are given by (4.2)wherel 1 = r tan(υ 1 / 2), l 2 = r tan(υ 2 / 2), l 3 = r tan(υ 3 / 2) (4.3)and where L V is the distance between points p and tb and L R is the distance between points tb and rt.Note that point p is a distance l 1 from the initial point, while the maneuver rejoins the flightplan route a distance l 3 from point rt.where V 1 , V 2 , V 3 are the average ground speeds along the turns and V V , V R are the ground speeds along the straight segments L VS and L RS .Note that the time to rejoin the flight path has been added to the return time (V F is the groundspeed on the flight path near point rt).The same iterative procedure for achieving a desired delay outlined in the previous section can be used, except that eq. ( 4.4) is used to calculate the delay.
V. A CASE STUDYThe path-stretch algorithm described in the previous sections has been developed and tested in an environment with MATLAB software from the MathWorks, Inc.; it was then converted to Java, and implemented with the AAC auto-resolution software in the ACES air-traffic simulation.For the tests being conducted at Ames Research Center, the simulation uses flight-plan data from one day of flights in the Cleveland airspace.The aircraft start from their respective airports at scheduled departure times, and fly according to their filed flight plans.Each aircraft within the Cleveland Center is checked for conflict with all other aircraft in the center every two minutes, and a conflict list is sent to the AAC auto-resolution module.Figure 5.1 shows the ACES-AAC interface.This section provides a case study of one conflict pair for which several trial plans are created.The trial plans consist of path-stretch maneuvers for one aircraft, which would be created in the AAC module, and ordered so that the maneuver with the least delay from the original route would first be sent to ACES to be checked for feasibility and conflicts.This study, however, was performed with MATLAB using the algorithm described in the previous sections applied to ACES conflict data.The same algorithm, with some practical constraints, has been implemented in Java for the AAC module.
ACES AAC ModuleCreate trajectories from flight plans and check for conflicts ACES conflict list Create a "trial-plan" resolution for each predicted conflict AAC trial plans Trial-plan status
Implement successful trial plansCheck trial plans for feasibility, conflicts
Accept trial plan
Iterate trial plan when necessaryChoose plans to be implemented
Send trial planThe case chosen for this paper is a conflict between flights AAL309 (an MD-80) and UAL8193 (a B757), flying at 31,000 ft through the Cleveland Center, both en route to Chicago.The data record accompanying each conflict detected by ACES and sent to the AAC module includes, for each aircraft, position, velocity, and time at the initial point; the first-loss-of-separation point; the minimumseparation point; and each flight-plan waypoint.Data for the initial point should be considered "measured," the rest, "predicted" by the ACES trajectory generator.A summary of the conflict data is given in table 5.1.Calculations of LoS between the aircraft at the initial time yields S 0 = 9.1 nmi.Further examination of the data reveals that the aircraft have all flight-plan waypoints in common: i.e., they are "in trail", only 9.1 nmi apart initially.The speeds differ by about 45 kn: The UAL flight is predicted to overtake the AAL flight in 6.3 min, passing with a minimum separation (MS) of 0.2 nmi if no action is taken.Turning and delaying the slower AAL aircraft to let the UAL aircraft be ahead when it passes the AAL return waypoint would probably be the first choice of an air-traffic controller.Here the path-stretch algorithm will be used to construct maneuvers for the AAL aircraft with predicted delays of 1.5, 3.0, and 5.0, minutes using both right and left turns of 15, 30, and 45 degrees.First the candidate return waypoints are determined and each waypoint-turn combination tagged with its maximum delay.The distance to loss of separation for AAL309 is 40.3 nmi; its range to the final fix is 152 nmi: The range from the initial point to a candidate waypoint must be 80.6 < R < 152.0 (Section II).There are nine flight-plan waypoints.The distances found using (A.1) -(A.4) show that waypoints 3 -8 satisfy the range criteria.Next the maximum delay for each valid waypoint with each turn (in either direction) is calculated and stored.The results are shown in table 5.2, where it is seen that neither 15 turn can produce even the smallest desired delay: the maximum delay available is only 1.0 minute (left turn, returning to waypoint 7 or 8).Finally, using the results shown in table 5.2, the path-stretch maneuvers can be created.For each delay value (starting with the smallest), a turn is selected (starting with the smallest), and the waypoints are checked (in ascending order) to see if < T. The first waypoint for the given vector that satisfies this criterion will serve as the return point for calculation of path legs L V and L R , using eq.(4.4) and the iterative procedure outlined in Section III.If no waypoint satisfies the criterion, the next turn is selected (if possible), and the waypoints are checked again.The algorithm results for this case study are shown in table 5.3.It should be noted that the MATLAB resolution software includes a level conflict check.Since this case represents a level conflict scenario, the trajectory paths of the two aircraft could be tested for separation every 5 sec for each trial plan, with a look-ahead time of 12 min.Although no other aircraft are included, this check is useful for monitoring resolution performance.In the column labeled "MS" it is seen that all turns appear to meet the requirement that the minimum separation be greater than 5 nmi (conflict free), at least for the first 12 minutes.The turn of 45 for the AAL309, shown in the plan view of figure 5.2, results in a delay of 5.0 min and allows the faster UAL aircraft to pass in front.In the ACES-AAC implementation, however, the delay of 1.5 min with the 30 vector turn would be tried first.If that maneuver were conflict free with respect to all other aircraft in its vicinity, the resolution would be accepted, and the next conflict considered.If it were not, then the delay of 1.5 min with the 30 vector would be tried next.The trial maneuvers would be sent to ACES in the order indicated in table 5.3.
VI. CONCLUDING REMARKSThis paper has documented a simple and reliable path-stretch algorithm that has been included with a suite of automated resolutions in an advanced air-traffic simulation.The long-term goal of this work is to extend the Advanced Airspace Concept for use in the real-time Center-TRACON Automation System (ref.4).The present paper outlines the theory and application of the algorithm, which includes turning back to a waypoint to resume the original flight plan.The path-stretch trial plan with the smallest delay and turn vector that provides a conflict-free path is the resolution chosen.Figure 2 . 1 .21Figure 2.1.A path-stretch maneuver with legs L V and L R and base R. ................................................
Figure 4 . 1 .41Figure 4.1.A path-stretch with straight segments L VS and L RS and turns L 1 , L 2 , and L 3 .....................
Figure 5 . 1 .51Figure 5.1.Interface of ACES and the AAC auto-resolution module..................................................
Figure 5 . 2 .52Figure 5.2.A path-stretch maneuver of 45 giving a delay of 5 min for AAL309..............................
Figure 2 .2Figure 2.1.A path-stretch maneuver with legs L V and L R and base R.
If the time to reach the return waypoint along the original path is T C , the time along the stretched path should be (3.1)and, referring to figure 2.1, use the cosine law with the planar approximation to obtain (3.2)
(A.1) -(A.3).If | R | > 135 , try the next waypoint.
4 .4Calculate the delay error ε = d -τ and use a Newton-Raphson procedure with iteration of steps 1 -3, varying L V until the error is sufficiently small.
Figure 4 . 1 .41Figure 4.1.A path-stretch with straight segments L VS and L RS and turns L 1 , L 2 , and L 3 .
Figure 5 . 1 .51Figure 5.1.Interface of ACES and the AAC auto-resolution module.
Figure 5 . 2 .52Figure 5.2.A path-stretch maneuver of 45 giving a delay of 5 min for AAL309.
Table 5 .52. Maximum Delay T (minutes) at Valid Return Waypoints (AAL309) .............................. Table 5.3.Summary of Path-stretch Maneuvers with Desired Delays .................................................
TABLE 5 .51. CONFLICT DATA FOR PATH-STRETCH CASE STUDYInitial T
0 = 0 First Loss T FL = 5.5 min Min Separation T MS = 6.3 min Alt, ft Spd, kn Hdg, deg Alt, ft Spd, kn Hdg, deg Alt, ft Spd, kn Hdg, degAAL 31000438.8107.031000439.0106.731000439.0105.7UAL 31000483.5106.931000485.0106.931000485.0106.9
TABLE 5 .52. MAXIMUM DELAY T (MINUTES) AT VALID RETURN WAYPOINTS (AAL309)wpt15+1530+3045+45Spd, kn30.50.32.01.75.14.5438.740.60.42.31.95.94.9438.650.70.42.72.06.95.3438.660.90.43.22.18.25.7438.671.00.43.52.214.48.9438.681.00.43.82.315.39.6438.6TABLE 5.3. SUMMARY OF PATH-STRETCH MANEUVERS WITH DESIRED DELAYS, min1 , degL V , nmi2 , degL R , nmi3 , degwptMS, nmi*1.53045.6+54.258.018.438.21.5+3048.755.454.9+31.238.13.03073.5+63.178.129.168.23.0+4549.476.565.5+37.337.95.04565.2+90.965.640.138.05.0+4575.184.977.7+48.957.9* MATLAB trajectory comparison
			Aerospace Computing, Inc., Ames Research Center, Moffett Field, CA 94035-1000.
			University of California, Santa Cruz, CA 95064.
		
		
			
APPENDIX A RHUMBLINE CALCULATIONSA rhumbline is a line of constant heading that joins two points on a spherical surface.For typical distances between flight-plan waypoints, a rhumbline differs little from a great-circle route.This appendix reviews the equations for obtaining the rhumbline distance and heading given two waypoints, and for obtaining a waypoint given one waypoint and the distance and heading to it.First define the latitude and longitude of the waypoints as (φ 1 , λ 1 ) and (φ 2 , λ 2 ), the rhumbline heading and distance between the waypoints as (X, L), and R E as the Earth radius.Given the waypoint positions, the heading from waypoints 1 to 2 is given bywhereThe rhumbline distance is thenIn that case:Solution of the inverse problem is used to find a turn-back waypoint given a heading and distance to it from a current point:(A.5) unless 2 = 1 .In that case the longitude is (A.6)The public reporting burden for this collection of information is estimated to average 1 hour per response, including the time for reviewing instructions, searching existing data sources, gathering and maintaining the data needed, and completing and reviewing the collection of information.Send comments regarding this burden estimate or any other aspect of this collection of information, including suggestions for reducing this burden, to Department of Defense, Washington Headquarters Services, Directorate for information Operations and Reports (0704-0188), 1215 Jefferson Davis Highway, Suite 1204, Arlington, VA 22202-4302.Respondents should be aware that notwithstanding any other provision of law, no person shall be subject to any penalty for failing to comply with a collection of information if it does not display a currently valid OMB control number.An algorithm is described for a "path-stretch" maneuver that allows an aircraft to turn from its present course and turn back to a downstream waypoint while achieving a specified delay.The maneuver may be started while the aircraft is in climb, cruise, or descent, and will be independent of the vertical profile defined by its flight plan.This maneuver is particularly useful when two aircraft are "in trail" when the leading aircraft is slower, or when descending arrivals on converging routes are predicted to be in conflict near an arrival fix.While the specified delay may be achieved, there is no guarantee that the maneuver will clear a conflict.Therefore, it is essential that the process be part of a decision-support system that checks each "trial" maneuver for conflict before a clearance is issued to the aircraft.
PLEASE DO NOT RETURN YOUR FORM TO THE ABOVEWBS 411931.02.61.01.03			
			

				


	
		Build 8 of the Airspace Concept Evaluation System (ACES)
		10.1109/icnsurv.2011.5935378
		
	
	
		2011 Integrated Communications, Navigation, and Surveillance Conference Proceedings
		
			IEEE
			Feb. 11, 2009
		
	
	Airspace Concept Evaluation System (ACES), described at the NASA Ames website: www.aviationsystemsdivision.arc.nasa.gov/research/modeling/ACES.shtml. Accessed Feb. 11, 2009.



	
		Automated Conflict Resolution for Air Traffic Control
		
			HErzberger
		
		
			Sept. 2006
		
	
	Presented at the 25th International Congress of the Aeronautical Sciences
	Erzberger, H.: Automated Conflict Resolution for Air Traffic Control. Presented at the 25th International Congress of the Aeronautical Sciences, Sept. 2006.



	
		Efficient Multiple Aircraft Conflict Resolution Using A* Algorithm and Indexing Method
		
			REBach
		
		
			CFarrell
		
		
			HErzberger
		
		10.2514/6.2020-2918.vid
		
			2009-214573, Feb. 2009
			American Institute of Aeronautics and Astronautics (AIAA)
		
	
	Bach, R. E.; Farrell, C.; and Erzberger, H.: An Algorithm for Level-Aircraft Conflict Resolution. NASA/CR-2009-214573, Feb. 2009.



	
		Automation System (CTAS), described at: www.aviationsystemsdivision.arc.nasa
		
			Center-Tracon
		
		
		
			Feb. 11, 2009
		
	
	Center-TRACON Automation System (CTAS), described at: www.aviationsystemsdivision.arc.nasa.gov/research/foundations/index.shtml. Accessed Feb. 11, 2009.


				
			
		
	
