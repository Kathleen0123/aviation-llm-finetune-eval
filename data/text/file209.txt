
	
	
		
INTROOUCTI ONThe continuing rise in airline operating costs due to escalating fuel prices and other inflationary factors has stimulated interest in techniques for trajectory optimization.Recent work has focused on the derivation of simplified algorithms for computing trajectories with specified range.Such an algorithm was described in Ref. 1.The trajectories calculated by this algorithm, unlike those obtained by classical performance optimization, minimize an integral performance measure such as total mission fuel cost.Another problem that has received attention recently concerns the optimality of steady-state cruise flight.Steady-state cruise is generally not optimum for minimum fuel performance (Ref.2), but the performance penalty of steady-state cruise is unknown because the actual nonsteady or cyclic optimum cruise has not been computed to date.However, if the steady-state cruise satisfies first-order necessary conditions l Speyer (Ref.2) shows, in an examp1e, the t the performance improvement of a part i cu1ar (though aonopt tmum] eye1i c cruise is about 0.1:0.This improvement, if representative of the optimum cyclic crutse , is not economically significant.Nevertheless, the determination of the optimum cyclic cruise poses an interesting and unsolved urcb 1em > Even if economically significant; cyclic cruise could not be used in airline operation because it is incompatible with eXisting air traffic control procedures, disconcerts passengers, and decreases engine life.Optimum trajectories, to be compatible with typical e i r l i ne practice, should consist of a cl ineout , a steadystate cruise, and a descent.Thus, at least for commercial airline applications.the cp t irmnn trajectory must be selected from a set of trajectories that is limited a priori to such types.A formulation of the trajectory optimization problem that constrains the admissible trajectories to those containing climb, steady cruise; and descent was given in Ref. 1.In this formulation, energy height was used as the independent or timelike variable in climb and descent, thus forcing energy to change monotonically in these segments.It was shown that the use of energy as the independent variable eliminates the integration of a separate adjoint differential equation, thus simplifying the numerical solution of the optimal control problem, Therefore, this formulation is also adopted here.An evaluation of the constrained optimum trajectories by airline operators indicated an interest in the addt t i onaI constraint of setting the thrust to some maximum during climb and to idle during descent to reduce pilot workload of flying the trajectories.An examination of this procedure raised the follOWing 1uestions that are investigated here.How do the constraints on thrust and, more generally, the aerodynamic and propulsion characteristics affect the structure of the trajectories?Under what condition is the constrained thrust procedure optimum?uhat performance penalty is incurred by the constraint on thrust?The avionics and aircraft industry is currently deve10ping onboard performance computer systems to assist the flight crew in minimizing fuel consumption and operating costs.Because of its modest computational requirements, the algorithm described herein can be implemented in an onboard computer.This paper briefly describes a computer implementation of the algorithm and also discusses the characteristics of several optimum trajectories computed for the Boeing 727-100 aircraft.
OPTIMAL CONTROL FORMULATIONAs stated in the Introduction, we assume at the outset that the optimum trajectories have the structure shown in Ffq .1.This structure consists of climb, cruise, and descent segments, with the aircraft energy increasing monotonically in climb and decreasing monotonically in descent.Neglecting flightpath-angle dynamics and weight loss due to fuel burn.the point mass equations of motion for flight in the vertical plane aredhjdt V sin y dx!dt V cos + V w V + V w (l!g)(dV/dt) [(T -D)/W] -sin y(1)(2)(3)with the constraint l Wcos y.The along-track wlnd component V may be a function of altitude, but accelerations due to wind shears as well as the vertical wind compon~nt can be neglected in this analysis, In airplanes, unlike rockets; the rate of change of weight due to fuel burn introduces negligible dynamic effects in the optimization.Nevertheless, the effect of weight loss on a trajectory 5 important but can be for without adding another state variable by techniques described in the section on ccmput.erimplementation.If energy is defined asE h + (i/2gthen the f'anri l i ar re l at ton for the rn ce of pect to time and substituting the right-hand 51 respectively: in is obtained bv differenti of Eqs . 1) and ( 2 The cost function to be minimized is chosen as the direct operating cost of the mission and consists of the sum of the fuel cost and the time cost:J ~cfW f + ctt f (6)where cf and Ct are the unit costs of fuel and time.respectively.Setting c~0 results in the familiar minimum fuel performance function.In integral form, the cost function becomes" J rtf ), P dt ° (7) It is assumed that the time to fly.tf' is a t t ty d f .Following the formulation in Ref. 1, for the three segments of the assumed trajectory free variable.but the distance to fly is a specified quannow write the total mission cost as the sum of the costs illustrated in Fig. 1); fc d up -ddn) + ft f P dtJ o P dt + (d f (8) o td --- -- cl imb cruise descent cost cost costwhere designates the cost of cruising at a given energy E c' Next, we transform the integral cost terms in Eq. ( 8) by changing the independent variable from time to energy, using the transformation dt ~dElE: (9) where Ei ana Ef are the given initial climb and final descent energies.respectively.The transformation uses the assumption that the energy chances monotonically in climb and descent.This places strict inequality constraints on E, as shown in Eq. (9).~Also in Eq. {9L the integration limits have been reversed in the descent cost term.In this formulation the cost function is of mixed form, containing two integral cost terms and a terminal cost term contributed by the cruise segment.With the change in independent variable from time to energy, the state equation (Eq.( 5)) is eliminated, leaving Eq. (3) as the only state equation.Furthermore, we note that the performance function (Eq.( 9)) depends on the distance state x only through the sum of the climb and descent distances d up + ddn' Therefore, the state equation for the distance is rewritten in terms of this sum as:d(x up + xdn)/dE 0 (V up + Vw)l.lt,o + (V dn + VwdJ/IElt,o (10)Here the transformation dt ~dElE was used again.Also, Eq. (10) provides for independence in the choice of climb and descent speeds v up and Vdn and the wind velocities V w and V w .Wind velocities in climb and descent are allowed to be independent of each other; generally, di¥~erent w1gd conditions will prevail in physically different locations of climb and descent.The wind velocities can also be altitude-dependent.The effect of altitude-dependent winds on the optimum trajectories is discussed in Ref. 3.Necessary conditions for the minimization of Eq. ( 9), subject to the state equation (Eq.( 10)) are obtained by application of optimum control theory (see.e.g., Ref. 4. p, 71).Then the following relations ar cb t.at " .for-the Hami I:,"" ' ::::;:,,' 1"; ;;::"":"'(';~;,o","l::~;,>, ,""; , ; i>]I[u, up' dn ( 12)The right-hand side of the Hamiltonian equation is minimized with respect to two pairs of control variables, one pair applicable to climb (V ug and 7Up), the other pair to descent (Vdn and "dn).Since each term under the minimization operator in Eq. (11) contains only one of the two pairs of control variables) the minimization simplifies into two independent minimizations, one involVing climb controls, the other, descent controls.Also, since the right-hand side of the costate equation (Eq.('12)) is zero, 'f is constant ,
TRANSVERSALITY CONDITIONSThe transversality conditions are additional necessary conditions that depend on the end-point constraints of state variables (Ref.4).The basic constraint in this problem is that the range of the tr-ajecbe d-.However. is a parameter in the transformed cost function, Eq. (9 Next.consider the case of no cruise segment.Then, the middle term of Eq. ( 9) drops out and the performance function contains only the integral cost terms.This is the case of the specified final state df ~dup + ddn; the corresponding transversality condition yields t(E c ) ~Wf.In practice it is not necessary to compute the constrained terminal state trajectory if a valid free terminal state trajectory exists, i.e., one for which d f > d up + ddn , since the addition of a terminal constraint can only increase the cost of the trajectory.Therefore, this case is not considered further here.In both cases the choice of costate determines a particular range.Since the functional relationship between these variables cannot be determined in closed form, it is necessary to iterate on the costate value to achieve a specified range df.The last necessary condition applicable to this formulation is obtained by making use of the fact that the final value of the t irnel i ke independent variable E is free.Its final value is the upper limit of integration E c in Eq .(9).Application of resul ts in Ref-4 provides the following condition:(0 + ('[(d f -d up -ddn)f(E) I)EoE c 0 0 (14)which, when evaluated and simplified, becomes(0 + [dc(d./dE)]!_ ,t~Ec o (15)where d c is the cruise distance.Condition (15) has the following physical interpretation.The value of the Hamiltonian H evaluated at cruise energy E c is (after substituting Eq (13) into (11) the minimum increment in the sum of climb cost and descent cost to make a unit increment in cruise energy.product dc;d /dE}E""E is the increment in c cruise cost resulting from a unit change in cruise energy.Condltlon (15) requlres the ootlmun trajectory to be such that the sum of these two increments be zero for a given cruise distance d c and cruise energy E c' DEPENDEOCE OE OPTIMUM TRAJECTORIES ON RANGE Equation (15), together with knowledge of the salient characteristics of the cruise cost and theHamiltonian H, can be used to determine the structural dependence of the optimum trajectories on range.Cruise cost at a cruise energy and cruise speed u "c is computed fr-om the relation~'1ith constraints {[: B} ( 16)where the denominator is the ground speed in the flightpath direction.Examination of the term containing l'n the relation for the performance function (9) shows that tho value for should be as small as possible at each cruise energy to minimize the total cost J.Therefore, the cruise-speed dependence of is eliminated by minimizing the right side of Eq. ( 16) with respect to V c : ( 17) In this paper.and V c are always assumed to be the optimum cruise cost and cruise speed, respectively, at a particular cfuise energy E c ' { 11 ), H can be (13) in Eq. the minimization oper-ator in Eq .{1l) and substituting Eq , and descent components as fo11Q'ds:Except in high wind shear, the cruise cost as a function of cruise energy exhibits the roughly parabolic shape shown in Fig. 2. For subsonic transport aircraft.the minimum of the cruise cost with respect to energy occurs close to the maximum energy boundary.This characteristic of the cruise cost prevails for essentially all values of the performance function parameters cf and Ct.The quantities defining the optimum cruise conditions are E c and" t ' In Eq. ( 15). the derivative of the cruise cost function multiplies the cruise opt ap distance.Except under extreme wind shear conditions, the derivative is monotonic and crosses the zero axis atE c E c Gp By dt S tr bud decomposed in 0 cl ] 0 + where rp mt n I~~-•~••~•~~c~-c--_. --_... ~~~(i 9) CC dn 9-5In the preceding section, the Hamiltonian, evaluated at E ~Ec• was interpreted as the cost penalty to achieve a unit increase in cruise energy.Extensive numerical studies of Eq. ( 18) for several comprehensive models of subsonic turbofan aircraft show H[Ec,)-,(EdJ >-0 for E c";; E co pt" Noreover-, the minimum cost penalty for increasing energy lup "is always positive and that for decreasing I do is negative.but the Sum has never been found negative for models of currently used turbofans.While these' characteristics have been established for several aircraft models, they are not intended to imply a generalization to all aircraft since no physical laws prevent H from being negative.Consider first the case where H[Ec~\(Ec)J > O. Then Eq. ( 15) can be solved for the cruise distance d c:de 0 -H[Ee,\(Ee)]/(d\/dE)EoE c (20)Since d\/dE -: O~but approaches zero as E c --; -E c ' the cruise distance must increase without limit as opt E c ~E c t Our numerical studies have shown that the value of H tends to decrease as E c increases, but op not enough to change this trend.Figure 3 shows the resulting family of trajectories~assuming H> 0 for all 'values of E c .In this case, interestingly, nonzero cruise segments occur at short ranges and at energies below the optimum cruise energy E c .Optimum cruise is approached asymptotically at long range.opt Consider next the case where H[Ec,A(ErJJ'" 0. Then de: ' " 0, i.e., no cruise segment i s present for djJdE < 0. However, Eq. ( 15) shows that de can be nonzero d;;../dE'" O.This implies that, for H '" 0, cruise flight is optimum only at the optimum cruise energy E Copt < Figure 4 shows the family of trajectories for this case.
THRUST OPTIMIZATION FOR MINIMUM FUEL TRAJECTORIESEvaluation of the Hamiltonian equation would be simplified if one of the two pairs of contra'!variables, airspeed or thrust.could somehow be eliminated a pr-ior-i.from the minimization.Since the pai r of throttle settings."up and rdn, is thought to be near its limit.we shall look for conditions where extreme settings of the thratt 1e are optimum.The rema i nder of th i s paper exam; nes on1y the mtni mum fue 1 case cf '" 1 and Ct "" 0, with winds set to zero to simplify the derivation~However, the results can be extended to the more general cost function.For minimum fuel performance, the two terms in the Hamiltonian Eq. ( 19) become (21a) where (21b) .An accurate model for thrust and fuel flow generally includes the functional dependencies, T(TI.V,h) and Wf(n.V,h).In addition, these functions must be corrected for nonstandard temperatures and bleed losses.In previous work on aircraft trajectory optimization (Ref.5), a simpler model for fuel flow and thrust was used: (22) The critical assumption in Eq. ( 22) is independence of The virtue of this model lies in the insight it yields intoFor any fixed values of Vup or Vdn, the operand functions for the minimization of K up and Kdn are hyperbolas with poles at T ~D.The numerator zero must be to the left of the pole on the thrust axis for energies less than cruise energy.Figure 5 is a typical plot of these functions.Clearly, maximum thrust minimizes Kup and idle thrust mtntertzes Kdn for any E < E c ' proving that the limiting values of thrust arc optimum for this propulsion model throughout the climb and descent trajectories.This result also implies that the departure from the extreme thrust values found for the more general propulsion model is directly attributable to the nonlinear dependence of fuel flow on thrust.ConverselY, the need for throttle setting can be determined from the fuel f l ow vs thrust dependence for a particular engine.Such are found in the engine "s performance handbook.
EVALUATION OF HAMILTONIAN AT CRUISEWe have seen in a preceding section that the value of the Hamiltonian computed at cruise energy determines the s tr-ucture of the trajectories near cruise.Here we shan relate the existence of cru'i E Copt to specific engine and aerodynamic model parameters by substituting truncated Tayloy' series expansions of fUGI flow and drag as functions of airspeed and thrust into the expression for the Hamiltonian.The location of the mfnimum with respect to the controls as wen as the value of H can then be determined as functions of the Taylor series coefficients at E ~Ec.
9-6How should one pick the experience in Refs. 1 and 3 throttle setting, corresponding picked for the expansion point. in the control space about which to make the expansion?Compu ta ti onal shown that the minimum is in the neighborhood of the optimum cruise speed and to the given cruise energy.This suggests that the cruise controls should beThe fuel flow and drag functions expanded to second order about the cruise controls T T e, V V are The subscripts to SeC and 0 designate the partial derivatives with respect to the subscripted variable.Note that the expanslon allows for a general fuel flow model in which specific fuel consumption can be thrustdependent.Before substituting Eqs. ( 24) and (25) into the expression for H. we observe that H is singular at cruise with T ~Tc and V = V e , because both numerator and denominator are identically Zero at that point, Figure 6 olots the loci of the numerator and denominator zeros of K up and Kctn in the control space at E = E c .It is proved in the Appendix that the locus of numerator zeros is tangent to the locus of denominator zeros at the optimum cruise controls.For E < E c • the two loci have no points in common.The two loci can be tangent but cannot cross since, otherwise, controls would exist that would make the Hamiltonian infinitely negative.a result ruled out as physically meaningless.
(Z6)Upon substituting Eqs. ( 24) and ( 25) into (Zl) using the tangency condition (A4) derived in the Appendix, the following expressions for K up and Kdn at cruise energy are obtained:(TcS FCr + SFC)tT -(OySFC + TCSECTDy)LV + (1/2)( ZSFC + TcS EC )H2 + (TcS EC + SEC )LV LT T T2 TV V + (1/2)TcSFCV2 LV'Terms above second order have been neglected since we are investigating a small neighborhood of the cruise point.Expression (25) represents K up if the quantity under the absolute value siqn is positive and Kdn if it is neqa tlve , Since the cruise point at AT = 0 and AV = 0 gives the undefined value of a/a for Eq. ( 26), it is necessary to evaluate the limit as -\T and iN approach zero.If the limit exists, it must be independent of the direction from which the cruise point is approached.To compute the limit and investigate the neighborhood of the cruise point, a polar coordinate system centered at the cruise point is used to define control perturbations.Let AR and e define control perturbations AT and AV as follows:The parameter S deft nes a reference direction B = 0Tis i ndependen t ,ined s nee it is inciepen(ient of the he lim t value is in the minimum of s inve tigated for two cases, one for The l-imit is thus 1:1e11 de remains to be shown that ccntr-ul s .This question dependent on thrust.
Case (A): SFC Independent of ThrustAlong the direction defined by LV ~0, i.e., along the thrust direction, Eq. ( 23) can be used directly to determine the dependence of the functions on T up and Tdn under the minimization operator.Since at showing that, at the cruise speed V e, these functions are independent of thrust.This result is not restricted to small perturbations relative to the cruise thrust.Along other directions, the truncated Taylor series form (Eq. ( 26)) must be used.After setting the Zero all thrust-dependent derivatives and substitutingEqs. ( 28) into (26), the follmving expression is obtained.±1 +hcv (I Bi+~)--'-~2~~2[S!SFC F(s+ D V ) 2 ---~i----~-----------,,where the positive sign applies to K up and the negative sign to K dn.The characteristics of these functions depend on the drag and specific fuel consumption derivatives.The drag derivatives D v and D v2 are both pasiti ve since the a i reraft wi 11 certa in ly opera te on the II front 'I side of the thrus trequt red curve.The dependence of SFC on speed for a typical, currently in-service turbofan engine at cruise energies exhibits a slight upward curvature above Mach 0.4 (as shown in Fig. 7), implying that both SFCV and SFCV2 are positive in the range of interest between tlach 0.4 and 0.9.The slight curvature of SFC indicates that a quadratic function can accurately model the HaCh number dependence of SFC in the Mach range of interest and not just in a small neighborhood of the expansion point.Also, at typical cruise conditions.one finds that D V 2 > (2SFCVDv + T cSFCV 2 ) ' Therefore, for any e, the denominator of Eq .( 31) goes to zero before the numerator does as LR is increased from an trri tial value of zero.Moreover, the slope of the operand function with respect to LR increases as 8 -+ O.The effect of ilV can be neglected since Vc»!.IV.These observations lead to the conclusion that the functions in Eq. ( 31) slope upward in all directions as LR increases.except in the direction parallel to the thrust axis, along which the slope is level.Figure 8 shows a family of plots of the operand functions as S varies over its range.The limiting values of these functions at the cruise point (iW/Vc)SFC are therefore also the global minimums.and the value of the Hamiltonian.which is the sum of the two components, is zero.At the cruise energy, furthermore, the optimum climb and descent speeds are equal to the optimum cruise speed.The optimum climb and descent thrusts at that point are arbitrary since the Hamiltonian is independent of them.By applying these results to Eq. (20), it now follows that the structure of the optimum trajectories near cruise is given by the family of trajectories in Fig. !lSpecifically, no cruise segment occurs except at optimum cruise energy E copt ' By combining results from this and the preceding section, the important result follows that.for the assumed engine model, optimum trajectories, corresponding optimum controls, and performance are not affected by constraining the thrust to extreme values in the climb and descent segments.
Case (8): SFC Thrust-DependentA complete investigation of the neighborhood of the cruise point analogous to Case (A) requires estimates of the various thrust-dependent derivatives in Eq. (26).However, understanding of this case can be obtained by examining the functions in Eq. ( 26) only along the thrust direction, i.e., for LV '" O.Under that assumption, Eq. (26) simplifies to:::~} (WSFC/V c ["1 + (TcSFC/SFC) + (ILTI/2SFCJ(2SFCT + TcSFCT2)] (32)where the plus sign and AT > a are chosen for Kup and the negative sign and LT < 0 for Kdn' This simplified approach focuses attention on the derivatives SFCT and , which are crucial for this case.The characteristics of these deri vat i ves can be deduced from plots of SFC vs thrust (Fig. 9).These plots.and those in Fi 7, were derived from the operating instructions manual of a typical in-service turbofan (Ref.
6). Obvi, the assumption of thrust-independent is grossly violated for this engine since, at low thrust ves, the SFC curves approach infinity; i.0" they become undefined.However, at climb or cruise thrusts, corresponding to the upper half of thrust range, the variation in SFC s onlY about 5%.Fuel flow is e t so plotted in Fi .9. The dashed line through the origin gives the best constant SFC approximation to the fuel flow on.son indicates an excel l ent match at high thrust, but an error of as much as -1200 Ib/hr' (550 kq/hr ) at low .For some applications the assumption of a constant Sr.C could be adequate if fuel flow errors at very low or idle thrust settings can be tolerated.'For the upper two thirds of the thrust range, quadratic functions provide good fits to the SFC curves.Therefore, one can use the second-order Taylor series expansion at the cruise point to estimate SFC for fairly large deviations of thrust from cruise thrust.The thrust in climb or cruise is tYPically larger than the thrust at which SFC is a minimum in Fig. 9.80th SFC r and SFC T 2 will therefore be greater than zero and so will the coefficient of AT in Eq. (32).It follows that the slope of Eq. ( as a function of At is greater than zero for K up and less than zero for Kcln.In other words.along the thrust di recti on these functions have a s tt'onq minimum at the cruise point whereas in Case (A) they were level along this directio!loAlong other directions.the investigation of Case (A) has shown a positive slope.Thus.if thrust is an unconstrained control variable along with airspeed, so that the cruise point lies in the interior of the control region, then the ootimum climb and descent thrusts and airspeeds will converge toward the optimum cruise thrust and airspeed as the climb and descent energies approach the cruise energy.It should be noted that this holds for all cruise energies.including those less than the optimum cruise energy, E Copt ' Since the Hami l tcnt an is again zero at the cruise energy, it follows that the structure of the optimum trajectories as a function of range is identical to that of Case (A) and is illustrated by Fig. 4. Computer calculations for this case in Ref. 1, using a similar engine model, showed that the thrust is either maximum or idle for about three-fourths of the energy range between initial and cruise energies and then departs from the extremum values so as to converge smoothly to the value at cruise as cruise energy is approached.Consider now the Case wher-e thrust is constrained to some maximum in climb and is idle in descent.In that case, the minimum at the cruise point is not accessible since it does not lie in the region of permissible controls.Also, unlike Case (A), the thrust dependence of K up and Kctn in Eq. ( 23) does not disappear along the thrust direction at V ~V c > Therefore, it is unlikely that at the minimum the sum of the two terms will be zero.The Hamiltonian is, in fact, greater than zero at any cruise energy.In order to show this, note in Fig. 9 that.as thrust decreases, SFC increases without bound.It follows that Idn will be less negative than it would be if SFC were thrust-independent and therefore will be insufficient to cancel I up at cruise energy, resulting in a positive value for the Hamiltonian.This was shown earlier to give rise to nonzero cruise segments below the optimum cruise energy.Thus, the structure of the optimum trajectories for the constrained thrust case is given by the family of trajectories in Fig. 3.
COHPUTER IMPLEMENTATION (a) Algorithm DescriptionThe climb and descent profiles are generated by integrating the state equation (10) from the initial energy Ei to the maximum or cruise energy E c .For this purpose, Eq .( 10) is separated into its climb and descent components, which are then modified to include the effect of nonzero flightpath angles as follows:dX up IdE (v + V )C05 "up IE I up "up(33)dX dn IdE (V dn + VWdJcos "dn I[EI Flightpath angles are not defined within the reduced dynamics of the energy state model.Nevertheless.during the integration of the trajectory, the flightpath angles for climb and descent, YUD and Ydn.can be computed by using increments of altitude and distance from two successive energy points.The use of these computed flightpath angles in Eq .( 33) slightly increases the accuracy of the climb and descent distance integrations.At each energy in the integration the optimum airspeeds and thrust settings are obtained as the values that minimize the two components of the Hamiltonian in Eq. ( 19).The minimization of the Hamiltonian 1S carried out by the Fibonacci search technique (Ref.7).It has the advantage of using the least number of function evaluations of all known search techniques to locate the minimum with prescribed accuracy and also is well suited to handle tabular data, Fibonacci search is basically a one-variable minimization procedure.It is adapted here to two variables applying the technique to one variable at a time while holding the other variable fixed.Convergence to minimum is achieved by cycling between the two vat~iable several times.Prior to a search over a given control variable, the limits of the reqions for Kup and Kdn, which consist of the T ' " D locus and the dashed line with shaded border in Fig. 6, are computed to keep the search interval as small as possible.As previously expl ained , the choice of in the Hamiltonian determines the range of the trajectory, but the exact functional dependence between and range cannot be determined explicitly for the various weights, wind profiles, and other parameter changes encountered in real time operation.An iterative procedure is therefore used and is explained in part (b) of this section, i\rl important part of the al thin involves accounting for the weight change due to fuel burn.The effect on the optimum trajectory of the change in wei qht was not included explicitly in the theory for reasons previously stated.Two methods are used to correct the optimum trajectories for the weight change.The first mere1y integrates the fue1 fl ow and updates the wei in the ca1cu1at i on of t cur-tnq climb and descent, This ensures that values of aircraft wei are used in the integration of Eqs.(33) to generate the climb and descentThe second method modifies the value of used in the Hamiltonian.This modification tnvclves using the es t tmated weight of the aircraft at the end of Climb, i .e..; at E c, to the value of rather than the weight at takeoff, It is tmoor-tan to use the weight E c rather the weight at some other , to compute because the vity of the control s to in 'incr-eases as the ai E c< The fuel consumption for entire climb , is estimated at the the empirical relation: where Wis the average fuel flow rate and V g the average ground speed during cruise.The calculation of the average quantities is described in Ref. 8.The computer implementation includes both the free and constrained thrust cases.For the constrained thrust case, the cruise distance is computed from Eq. (20).However, because dA/dE ~0 as E c ~Ecopt' there is a practical limit to the use of Eq. ( 20), determined by the numerical accuracy of computing dA/dE for E c in the neighborhood of E Copt " A practical limit for E c is that value for which A: 1.01Aopt.The total range of the trajectory obtained for this value of A is referred to as d m ax.All trajectories requiring longer ranges than d max are assumed to cruise at E Copt and contain cruise segments of length d~~df -d up -ddn.where d up and ddn are computed for A ~1.01Aopt.In the free thrust case, numerical dlfficulties can arise in minimizing Eq. ( 19) as E c ~Ecopt' The value of 1.01Aopt has also been found to serve as a practical criterion for computing the longest range without a cruise segment at E c t After reading aircraft lift.drag.and propulsion data, performance function parameters, and wind and temperature data, the optimum cruise speeds and costs and dA/dE are computed for a range of cruise energies and cruise weights using Eq. ( 17).Cruise weight is incremented in steps of about 5% of average gross weight.Cruise energy is incremented in 1000-ft steps from 5000 energy-feet to the maximum or ceiling energy.The results are stored in what is referred to as cruise performance tables.At each weight the cruise performance vs energy will show a dependence as in Fig. 2. The tables also contain a variety of other quantities such as fuel flow.thrust setting, Mach number, etc., that are needed to fly the trajectories.In addition.at each weight the optimum cruise energy E Copt and the optimum cruise cost Aopt are computed and stored in separate tables.Since these tables contain extensive amounts of data and are time consuming to compute, they can be permanently saved on a mass storage medium.After reading in additional input data, two optimum trajectories referred to as the minimum and maximum range trajectories are synthesized.The minimum range trajectory is obtained by choosing the largest value of A (called AmQX) stored in the cruise performance tables at the gross weight of interest.The maximum range trajectory 1S obtained by choosing the smallest A, namely.1.OlAopt.as explained in part (2).Values of A at given weights are computed by interpolating between data points in the cruise tables.The corresponding ranges dm~x and dmin can now be compared with df to decide on the type of trajecto~y required.If df > d m ax' the trajectory will always contain a segment of cruise at optimum cruise energy E Copt' No iteration on A is required in this case since the specified range df is obtained by choosing a cruise segment of length de = df -d up -ddn' The optimum altitude and Mach number in the cruise segment are updated every 100 n. mi. to account for the loss of weight due to fuel burn.This is the well-known climb-cruise technique.If dmin ~df ~dm ax' the maximum energy will fall below E Copt and iteration with respect to required.Here the approximately known inverse relationship between A and df' illustrated in Fig. a Boeing 727-100. is incorporated in heuristic to minimize the iteration.Thus, the first estimate is computed from is 11 for of (36) The constants A and B are chosen to yield A max and 1.Ol~opt when df is set to dmin and d m ax• respectively.Then the trajectory is synthesized to yield the actual range d.If d is not sufficiently close to df. constants A and B are updated by using a pair of ranges and the corresponding pair of A'S computed in preceding syntheses.The ranges included in this pair are selected so they enclose the desired range and lie closest to it.A new estimate of A is now computed and the synthesis is repeated.Typically, after two iterations the actual range will have converged to within 5 n.mi. of the specific range and iteration is terminated.The optimum climb and descent trajectory is specified by storing the range.time.fuel.Nach number, thrust setting.and altitude as a function of energy height in 500 energy-feet increments.The computer implementation of the algorithm described here was designed for off-line use primarily as a benchmark for evaluating various non-or suboptimum trajectories.Various simplifications are possible to reduce the computer complexity for onboard implementation.For example. the iteration loop to achieve a specified range need not be mechanized.This approach was used in a piloted simulation of the algorithm (Ref.9).In that study, the pilot played an active part in closing the loop on range.
RESUL TSThe computer-implemented version of this algorithm was used to compute and to study the characteristics of several types of optimum trajectories.This section presents a summary of the results.A more complete discussion.including the effects of winds, nonstandard temperatures.and gross weight changes, can be found in Ref. 8. The aerodynamic and propulsion models used in these calculations are representatives of the Boeing 727-100 aircraft equipped with JT8D-7A engines.The time and fuel cost parameters in the performance function Eq. ( 7) were chosen to be $500/hr and 6.23 cents/lb.respectively.Inflation has increased these  The aircraft takeoff weight for these trajectories is 150,000 lb.Winds are assumed to be zero and atmospheric conditions are for a standard day.For the 200-n.mi.range, both the constrained thrust (solid line) and the free thrust (dashed line) trajectories are shown.Also, for the zoo-n.nt .range, Fig. lO(b) shows the corresponding altitude vs airspeed profiles.Below 10,000 ft altitude, all trajectories are essentially identical in both climb and descent profiles.At 10,000 ft both the climb and descent profiles are interrupted by short segments of almost level flight.These are the result of the 250 KIAS speed limit imposed on the trajectory below 10,000 ft by U.S. air traffic control rules.Thus, when the aircraft reaches 10,000 ft in climb, the aircraft accelerates to the unconstrained optimum climb speed (see Fig. 12(b)).S'lnri l arl y , a deceleration occurs in descent at this altitude.The constrained thrust trajectories for the 100-and 200-n.mi.ranges contain short cruise segments below the optimum cruise altitude of 31,000 ft.Optimal cruise altitude is used for ranges longer than about 250 n. mi.For the relatively long range flight of 1000 n. mi., the optimum cruise altitude increases at a rate of approximately 2.5 ft/n.mi. of cruise distance due to fuel burnoff.The free thrust trajectory for the 200-n.mi.range does not contain a cruise segment.However, the difference between the constrained and free thrust profiles is slight and is noticeable only above 25,000 ft.Below this altitude the optimum thrust values are identical for both types, namely, maximum in climb and idle in descent.Above this altitude the thrust reduces gradually in cl imb for the free thrust case; it continues to reduce during the initial descent and reaches idle thrust at 20~OOO ft.Differences in the speed profiles also are noticeable only above about 24,000 ft.As expected, the difference in operating costs between the two types of trajectories is slight, amounting to an additional $8 saving for the 200-n.mi.free thrust trajectory.Minimum fuel trajectories~obtained by setting the time cost parameter in the performance function to zero, are shown in Fig. 13.In comparison with the minimum DOC trajectories~the minimum fuel trajectories for a given range climb to a higher altitude and use a substantially lower airspeed above 10,000 ft.Also, above lO~OOO ft the f1 ight-path angle of the minimum fuel trajectories is steeper in climb and shallower in descent.As before, differences in the altitude profiles between the constrained and unconstrained thrust trajectories are apparent only near the top of the climb.The penalty in fuel consumption due to the 250 KIAS speed restriction below 10,000 ft was found to be 66 lb.This penalty increases with an increase in gross wet qht but is essentially independent of range.Table 1 summarizes several important numerical values for the trajectories calculated.Comparison of tabulated figures shows that the fuel saved by flying the minimum fuel instead of the minimum DOC trajectory is about 1 ~OOO lb for the 1,000-n.mt _ range, or about 1 Ib/n .mi.However, the associated time and cost penalties are 16 min and $30, respectively.If the price of fuel continues to increase more rapidly than the cost of time, as was the caSe in 1979.the optimum DOC and fuel trajectories will converge, resulting in small ar fuel and cost differences between them.For the 200-n.uri .-rangeminimum fuel trajectories, the differences in fuel consumption between the constrained and free thrust cases is 23 lb.This relatively small difference would seem to justify the use of the simpler-to-mechanize and computationally faster constrained thrust mode, especially in an onboard computer implementation.However, as was pointed out in the preceding theory sections, this difference is aircraft-and propulsion-model dependent and therefore should be checked whenever there is a change in model characteristics.
CONClUS IONSThe approach presented here has established the structure of optimum trajectories for airline operations and has yielded an efficient computer algorithm for calculating them.The algorithm can be incorporated in an airline flight planning system or can be used to determine the performance penalty of simplified onboard algorithms.The latter application is important at this time in view of the current effort by industry to develop onboard performance management systems.Two pairs of opposing assumptions, constrained vs free thrust and dependence vs independence of specific fuel consumption on thrust, played pivotal roles in determining the characteristics of the optimum trajectories.If the assumption of specific fuel consumption independent of thrust is justified, constrained thrust trajectories are identical in structure and performance to free thrust trajectories.However, when the realistic dependence of specific fuel consumption on thrust is taken into account, there will be a difference, though slight for the example s tudied , in both performance and structure between constrained and free thrust cases.The actual differences in performance depend on the propulsion and aerodynamic models as well as other factors and must be determined for each aircraft model by computer calculation.
APPENDIXIt is to be proved that the loci of AV ~0 and T ~D ~0 are ta~gent at the cruise point, assuming that the cruise point at T T e • V ~V c is a minimum of the cruise cost Wf/V a100g the locus T -D ~O.This is equivalent to proving that the cruise point lies on both loci and that the slopes of the loci ate identical at that point.------_.,-------------------~-------------_.-~---~---------------------.__._-~---~--- -------------- Minimum Fuel Trajectories (150,000 Ib Takeoff weigbt)--------------,~-------------~-----_._-------------~--------------------------~---~-----.~-~~.~-_.factor, dollars/kg (dollars/ib) time cost factor.dollars/hr drag force first and second partial derivatives of drag with respect to airspeed cruise distance desired distance to fly total climb and descent distances, respectively total aircraft energy in units of altitude cruise or maximum energy optimum cruise energy initial and final energy rate of change in energy acceleration of gravity Hamiltonian.dollars per unit of energy altitude, m (ft) components of the Hamiltonian value of performance function, dollars/kg (dolIars/lb) wind speed along flightpath wind speeds in climb and descent segmentsr espectively, functions of altitude aIrcraft weight in kg (lb) total mission fuel, kg (lh) initial aircraft weight, kg (Ib) reference weight in climb fuel relation fuel flow rate, kg/hr (lb/hr) di stance f l own.n, mi.climb and descent distances.running variables parameter defining direction of control perturbations flightpath angle, radian climb and descent flightpath angles, respectively, radian length of control perturbation p integrand of cost function or cost per unit time LT,LW thrust and cruise condi perturbations relative to thrust specific fuel consumption per hr nth partial derivatives of SFC with respect to (.) cruise cost at cruise energy do ll ar-syn.mi.Index categori es : Fl i ght Operati ons : Guidance and Control; Navi gat i on~Conmun i cat"] on; Fr-a ffi c Ccntrc 1, 9-2 throttle setting cruise cost per unit distance ""up' dn throttle settings in climb and descent, respectively "opt optimum crUise cost over all energies, per unit distance f costate variable
) in-place of Eo. and wi tf res-E dE/dt [(T -d
tuted into Eqs .(21b), one obtains o SFC W [Tup_-('/SFc)Vupl K up V up T up -0 JT ,0up the specific fuel consumption SFC from thrust. the minimum fuel problem.If Eq. (22) is suost t-
+(TcSFCT {-SFC) T+ TCSFCV :'iV + (1 (2S FCT + TcSFCT2 ) :\T2 + (TcSFCTV + Srcv)LV ;\T + (1/2}TcSFCV2 LV} + higher-order terms (Z4) o ~O(Vc,E c ) + 0v AV + (1/Z)Ov 2 LV' + higher-order terms (Z5)
D at the cruise point, the reference direction of the is excluded from the control space since it is along 1i ne \ T '" D v t,V• The the direction of the locus of After subs tt obtains for any 8 f Eqs into (26) and taking the Limt t of the resulting expressions as 'R , ;-0,C)dCC direction in each with respect to
Fe(34)    where K; is an aircraft-dependent constant and Wref is a typical initial climb weight.estimates the climb fuel weight to about 10'% accuracy.which is adequate for-this purpose.weight at the end of cruise, if a cruise segment is present, is used to compute A for the tier.<The cruise fuel consumotion.F c• is determined from the relation: = ~d/Vg
of the algorithm has been implemented in FORTRAN IV and is described in detail in Ref. 8. The program contains one main program and 38 subroutines.There are approximately 2400 FORTRAN instructions in the program.In this paper, the organization and major elements of the program are outlined with reference to the simplified flow chart shown in Fig. 10.
I 9 -910 parameters since their selection in early 1978.However, because the trajectories actually depend only on the ratio of the parameters, the trajectories continue to be useful, especially for comparing minimum fuel and DOC cases.
FigureFigure lO(a) shows the altitude vs range for 100, 200, and 1000 n. mi.range nrtni sun DOC trajectories.
Fig. 1 .1Fig. 1.Assumed structure of optimum trajectories.
Fig. 3 .Fig. 2 .32Fig. 3. Energy '!!i.range, H > 0 at E e•
Fig. 4 . 5 .Fig. 8 .Fig. 6 .Fig. 9 .45869Fig. 4. Energy ~range, H o at
7 Fig. 7 ,Fig. 10 ,7710Fig. 7, SFC dependence on Mach Number, JT8D-Y,
. fl. mi.
Fig. 11 .11Fig. 11.Typical cruise cost vs range relationship.
Altitude-range profiles.(b) Airspeed-altitude profiles for 200 n.m. range.
Fig. 12 .12Fig. 12. Minimum DOC trajectories.
Fig. 13 .13Fig. 13.Minimum fuel trajectories.
This is the transversality condition for the free final state problem with te~minal cost (Ref.4).It shows that the constant costate value is the negative of the cruise cost.). and not a state variable. + ddn is~in this formulation, subject only to the inequality is of course,. necessary for a physically meaningful result. can be handled by variable <This ving two optimization problems, one completely free (dup ( 13) The value of the constraint dup + This inequality ,xup~dup•Xdn~ddn+ ddn < df)' the other constrained (dup + ddn ~df), and then choosing the trajectory with the lowest cost.Physica ly, the comparison is between a trajectory with a cruise segment and one without a cruise segment.Considering first the free terminal state case.dUD + ddn < df' we obtain the following relation tor the final value of the costate 0: I
TABLE 1 .1CHARACTERISTICS OF EXAMPLF OPTIMUM TRAJECTORIESNi nimum Direct Operating Cost Trajectories (150,000 lb Takeoff weight)Thrus t modeRange, n. mi.Time; hr/min/secCost, Sin. mi.Fue1; Ib/o. mi.Cruise Al t i tude/f tC11mb Distance/n. mi.Descent Distance/n. mi
-CT a10020:063.5830.4051489943.1552.66CT20033:023.0025.77426970101.4277.85FTo20033:002.9825.33127827116.0084.00CT10002: 13:072.2818.77930819135.7685.38
		
		
			
(All gradient of Wf -AY:To prove that the slopes are identical, compute the -r.TSFC]The perpendicular unit vectors i und 3 point in the speed and thrust directions.respectively.Now write A as a function of the perturbation 6V:Since. by assumption.A has a minimum at V = V e• set the derivative of A with respect to 6V equal to zero.This yields the following relation:Next compute the gradient of (T -D)(Y/W) at the cruise point:The slope of Eq. (AI) relative to the direction is given by Slope (TCS FCy + SFC)[TcS FCy -(TcS;~/Yc~(
AS)After substituting Eq. (A3) in place of TcSFC/Y c in Eq .(AS), the slope simplifies to -l/D v' which is identical to the slope of Eq .(A4).			
			

				


	
		Fixed~Range Optimum Trajectories for Short Haul Aircraft
		
			HErzberger
		
		
			JDMclean
		
		
			JFBarman
		
		NASA TN 0-8115
		
			Dec. 1975
		
	
	Erzberger, H.• McLean, J.D .• Barman, J. F,: Fixed~Range Optimum Trajectories for Short Haul Aircraft. NASA TN 0-8115, Dec. 1975.



	
		Nonoptimality of the steady-state cruise for aircraft
		
			JasonLSpeyer
		
		10.2514/3.7257
	
	
		AIAA Journal
		AIAA Journal
		0001-1452
		1533-385X
		
			14
			11
			
			Nov. 1976
			American Institute of Aeronautics and Astronautics (AIAA)
		
	
	Speyer, J. L.: Nonoptimality of the Steady-State Cruise for Aircraft. AIAA J., Vol. 14, Nov. 1976, pp. 1604-1610.



	
		Fixed-Range Optimum Trajectories for Short-Haul Aircraft
		
			JohnFBarman
		
		
			HeinzHErzberger
		
		10.2514/3.58706
	
	
		Journal of Aircraft
		Journal of Aircraft
		0021-8669
		1533-3868
		
			13
			10
			
			Oct. 1976
			American Institute of Aeronautics and Astronautics (AIAA)
		
	
	Barman. J. F.• and Erzberger. H.: Fixed Range Optimum Trajectories for Short-Haul Aircraft. J. Aircraft, Vol. 13, Oct. 1976, pp. 748-754.



	
		Optimal feedback control
		
			ArthurEBryson
		
		
			Yu-ChiHo
		
		10.1201/9781315137667-4
	
	
		Applied Optimal Control
		
			Routledge
			1969
			
		
	
	Bryson, A. E., Jr .. and Ho., Y-C.: Applied Optimal Control. Blaisdell, Waltham, >lass., 1969, ch. 2.



	
		Aircraft performance optimization.
		
			RobertLSchultz
		
		
			NelsonRZagalsky
		
		10.2514/3.44326
	
	
		Journal of Aircraft
		Journal of Aircraft
		0021-8669
		1533-3868
		
			9
			2
			
			Feb. 1972
			American Institute of Aeronautics and Astronautics (AIAA)
		
	
	Schultz, R. L., and Zaga1sky, N. R.: Aircraft Performance Optimization. J. Aircraft, Vol. 9, Feb. 1972, pp. 108-114.



	
		Health hazard evaluation report: HETA-84-089-1505, Pratt And Whitney, East Hartford, Connecticut.
		10.26616/nioshheta840891505
	
	
		Specific Operating Instructions, JT8D-7 Commercial Turbofan Engines, Pratt and Whitney Aircraft
		East Hartford, Connecticut
		
			U.S. Department of Health and Human Services, Public Health Service, Centers for Disease Control, National Institute for Occupational Safety and Health
			Jan. 1969
		
	
	Specific Operating Instructions, JT8D-7 Commercial Turbofan Engines, Pratt and Whitney Aircraft, East Hartford, Connecticut, Jan. 1969.



	
		Introduction to Methods of Optimization
		
			LCooper
		
		
			DSteinberg
		
		
			1970
			W. B. Saunders Co
			
		
	
	Cooper, L., and Steinberg, D.: Introduction to Methods of Optimization. W. B. Saunders Co., 1970. pp . 147-151.



	
		Algorithm for Fixed Range Optimal Trajectories. NASA TP 1565
		
			HomerQLee
		
		
			HeinzErzberger
		
		
			Jan. 19
			BO
		
	
	Lee, Homer Q., and Erzberger, Heinz: Algorithm for Fixed Range Optimal Trajectories. NASA TP 1565, Jan. 19BO.



	
		THE EFFECTS OF IONIZING RADIATION ON COLLOIDS. Final Report, May 1964-- November 1966.
		
			MossmanJ H D CBachem
		
		10.2172/4812071
		NAS 2-9174
	
	
		Simulator Evaluation of Optimal Thrust Management/Fuel Conservation Strategies for Airbus Aircraft on Short Haul Routes. Final Report
		
			FlightSperry
		
		
			Systems
		
		
			ArizPhoenix
		
		
			Office of Scientific and Technical Information (OSTI)
			May 1977 ~April 1978
		
	
	NASA Contractor Report
	Bachem. J. H., and Mossman. D.C.: Simulator Evaluation of Optimal Thrust Management/Fuel Conservation Strategies for Airbus Aircraft on Short Haul Routes. Final Report, prepared by Sperry Flight Systems. Phoenix, Ariz. NASA Contractor Report NAS 2-9174, May 1977 ~April 1978.


				
			
		
	
