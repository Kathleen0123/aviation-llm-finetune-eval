
	
	
		
I. Introductiondvanced air traffic management systems are designed to optimize the throughput and efficiency of the national airspace system in the United States to accommodate growth in air traffic.Developing optimal aircraft trajectories not only enhances air traffic flow but also helps the aviation industry cope with increasing fuel costs and 1 Research Scientist, University Affiliated Research Center, Mail Stop 210-8, Member AIAA. 2 Senior Scientist for Air Transportation Systems, Aviation Systems Division, Fellow AIAA. 2 Senior Scientist for Air Transportation Systems, Aviation Systems Division, Fellow AIAA. 3 Research Scientist, Systems Modeling and Optimization Branch, Mail Stop 210-10, Associate Fellow AIAA.A helps to reduce aviation-induced climate change.Classical aircraft trajectory optimizations are solved by applying calculus of variations to determine the optimality conditions, requiring the solution of non-linear Two-Point Boundary Value Problems (TPBVPs) [1].In order to reduce the modeling order and hence the complexity, the energy state approximation has been successfully applied to generate an optimal vertical flight profile [2,3].Alternatively, a more general solution to aircraft trajectory optimization can be obtained by singular perturbation theory which approximates solutions of high order problems by the solution of a series of lower order systems with the system dynamics separated into low and fast modes [4,5].However, finding the global optimal solutions to the TPBVPs remains a daunting task.With the tremendous advancement in numerical computing power, TPBVPs can be converted to nonlinear programming problems that are solvable even for problems with many variables and constraints using numerical algorithms such as direct collocation methods.Neglecting aircraft dynamics and applying shortest path algorithms in graph theory, an optimal trajectory can be approximated by the path that minimizes the total link cost connecting the origin and destination in a pre-defined network.The graph methods often require large computation time and memory space but guarantee global optimal solutions.These numerical methods are widely applied for problems in constrained airspace such as minimum cost-to-climb and obstacle-avoidance.However, the majority of the aforementioned trajectory optimizations neglect the effect of wind in the problem formulation.The following studies include wind effects.In 1931 Ernst Zermelo [6] first proposed the minimum-time path problem for a boat moving through a region of strong currents.Bryson and Ho approached the problem by determining the analytical equation governing the optimal heading dynamics that satisfies Pontryagin's Minimum Principle [1].This results in a solution to the minimum-time path for aircraft travel at a constant altitude and speed in strong winds given correct choice of the initial heading.Generally, the initial heading angle can be obtained by an iterative process but convergence problems may occur due to the presence of nonlinearities such as jet streams.The search could converge to a local minimum depending on the initial choice.Recent studies propose selecting the initial heading by combining calculus of variations and graph theory, and claim that these methods always generate global optimal solutions with moderate computational effort [7,8].These studies are focused on computing the minimum-time path at a single flight level and have not considered the minimum-fuel route that is divided into segments at several flight levels, identified by incorporating aircraft weight and fuel burn modeling into the optimization procedures.This study develops a practical trajectory optimization algorithm for aircraft that approximately minimizes cost of time and fuel burn by combining the method for computing minimum-time routes in winds on multiple horizontal planes and the aircraft fuel burn model for generating fuel-optimal vertical profiles.It is applied to evaluate the potential benefits of flying wind-optimal routes in a seamless airspace for commercial cargo flights operating between Anchorage, AK and major airports in Asia and the contiguous United States.The section on Practical Aircraft Trajectory Optimization describes total operating cost, and develops the vertical profile and horizontal maneuver that minimize fuel burn and travel time in winds for commercial aircraft.The section on Experimental Setup applies the optimization algorithm to calculate wind-optimal trajectories for commercial cargo flights between Anchorage, AK to major cities in the U.S. and Asia.The Results section presents potential benefits of flying minimum-time trajectories in winds with a fuel optimal vertical profile.The Conclusions section summarizes the results.
II. Practical Aircraft Trajectory OptimizationThis section presents the practical trajectory optimization algorithm that approximates the minimization of the total cost of travel time and fuel consumption for aircraft on a spherical surface.Optimizing performance of a single aircraft from takeoff to landing in the presence of air traffic constraints and winds is computationally intensive and time consuming.Future air traffic simulation systems will be required to optimize and simulate tens of thousands of aircraft trajectories in seconds or minutes.However, it is impractical and may not be necessary for these systems to generate thousands of optimal and detailed aircraft trajectories.The details of the trajectory optimization required depend on the performance index, the approach and the application.This study adapts a practical optimization approach by assuming a typical structure for an aircraft trajectory and focuses on optimizing direct operating cost during cruise when the time and fuel savings have the most impact.A typical aircraft trajectory consists of an initial climb, a steady-state cruise, and a final descent.Here, aircraft performance is optimized for the cruise phase only.Typical aircraft profiles are applied for generating trajectories during initial climb and final descent since additional air traffic constraints are involved in these stages and travel time and fuel savings are generally small compared to those during cruise.The cruise trajectory is divided into segments on several altitudes as the optimal cruise altitude increases due to the reduction in aircraft weight as fuel is used.The legal cruising altitudes and the en-route step climb times are optimized based on Eurocontrol's Base of Aircraft Data, Revision 3.6 model [9].The aircraft optimal heading during cruise is the solution of the Zermelo problem derived on a spherical Earth surface in the absence of constraints.The horizontal trajectory segments are optimized based on the cost-to-go associated with extremals (trajectories) generated by forward or backward integrating the dynamical equations for optimal heading and aircraft motion from various points in the airspace.This computationally efficient algorithm searches for optimal solutions by combining calculus of variations and dynamic programming.The next subsection defines aircraft operating cost and outlines the practical optimization procedures.The optimization procedures include two stages.The subsection on Optimal Vertical Profile describes solving the optimal aircraft cruise altitudes and en-route step climb times.The subsection on Horizontal Trajectory Generation presents the aircraft model and the procedures for calculating optimal aircraft headings in winds on multiple flight levels.
A. Aircraft Operating CostThe direct operating cost for a cruising aircraft can be written as:€ J = [C t + C f f (m,h,V )] t 0 t f ∫ dt,(1)where € C t and € C f are the cost coefficients of time and fuel.The fuel flow rate, f, can be approximated by a function of aircraft mass, m, altitude, h, and airspeed, V. Aggarwal [10] minimizes direct operating costs for long-range transport type aircraft in the absence of winds, and shows that the aircraft Mach number remains almost constant during cruise.This result is adopted here to simplify the search for the optimal solution.For a chosen constant airspeed indexed in i,
€V i , the cost function is rewritten as:€ J i = [C t + C f f (m,h,V i )] t 0 t f ∫ dt.()2The optimal € V i can be determined through an iterative process such that the arrival time constraint is met and operating cost is minimized.This operating cost depends on the total travel time and fuel flow rate during cruise.Total travel time is minimized by determining the optimal aircraft heading that yields the minimum-time trajectory in winds and the fuel flow rate is minimized by controlling cruise altitudes given € m and V i .The computational effort is high, especially for long haul flights, when both winds and aircraft fuel burn are considered in the optimization since en-route meteorological conditions vary with location, and aircraft fuel burn depends on altitude.In order to improve the computational efficiency of the approach, a two-stage optimization strategy is proposed for narrowing down the search scope to find approximate solution to the optimization problem.The first stage optimizes an aircraft vertical profile along the track to determine the optimal cruise altitudes and en-route step climb times given the flight levels constraints.The second stage develops wind-optimal horizontal trajectory segments by determining optimal aircraft heading in winds based on the cruise altitudes and step climb times that are solved in the first stage.
B. Optimal Vertical ProfileThis subsection develops an aircraft vertical profile based on the fuel consumption model in Eurocontrol's Base of Aircraft Data Revision 3.6 (BADA) [9].First, formulas for calculating the cruise altitude that has the minimum fuel burn rate are derived by assuming a constant cruise speed.Then, they are applied for optimizing the aircraft vertical profile along track based on the aircraft weight and true airspeed.The fuel burn for aircraft during cruise, F, is calculated as:€ F = t f ,(3)where t is elapsed time.The fuel burn rate, f , for jets and turboprops is determined by the specific fuel consumption, € SFC , and thrust, Th, and can be expressed in the following form:€ f = C fcr 1000 SFC ⋅ Th, SFC = C f 1 (1+ V C f 2 ).(4)€ D = 1 2 C D ρSV 2 .()5The drag coefficient, under normal conditions and except during approach and landing, is specified as a function of the drag coefficient parameters,€ C D 0 , C D 2 ,€ C D = C D 0 + C D 2 C L 2 , C L = 2mg ρSV 2 .(6)Note that the aerodynamic drag is a function of air density that depends on altitude.The formulas for calculating the optimal cruise altitude that has the minimum fuel flow rate are derived by taking the first order variation of the fuel flow rate with respect to the cruise altitude to zero.Under the International Standard Atmosphere (ISA) conditions, the tropopause is at 11,000 meters altitude; and the optimal aircraft cruise altitude,
€h opt , at or below the tropopause can be calculated by the following formula:€h opt = [1-e -f (m,V )K T R gas 2(g +K T R gas )ρ 0_ ISA 2 ]( 1000T 0 _ ISA 6.5).()7Above the tropopause, it is:€ h opt = -f (m,V ) R gas T trop _ ISA 2gρ trop _ ISA 2 +11000,(8)where€ f (m,V ) = ln( 4m 2 g 2 C D 2 S 2 V 4 C D 0 ). € R
€T trop _ ISA , are also constants at the tropopause.The appendix shows the derivation of these formulas.Optimal cruise altitudes are computed from Eqs. (7,8) based on the atmospheric constants and aerodynamic drag coefficients that are aircraft type dependent.They also vary with aircraft mass and air speed.The thrust margin is also checked to ensure that it is positive when determining the optimal altitudes for each selection of mass and speed.The thrust margin is defined as the maximum cruise thrust minus the thrust required to maintain 100 ft/minute rate of climb at the selected air speed, at the optimal cruise altitude [11].Figure 1 shows the optimal cruise altitudes for various combinations of mass and speed for the McDonnell Douglas MD-11 aircraft.In general, optimal cruise altitudes are lower for higher weights and increase as air speed increases.Note that optimal cruise altitude decreases at very high air speeds when the thrust margins become negative.In these cases, optimal altitudes are recomputed and lowered to meet the thrust margin requirement.During a flight, the optimal cruise altitude increases due to the continuous reduction in aircraft weight as fuel is used.An aircraft weight profile during cruise, for a constant airspeed, is generated using the initial aircraft weight at the start of cruise and the time history of the fuel burn rate.Figure 2 plots the vertical profile for optimal cruise altitudes in blue based on the weight profile in the absence of winds.Due to current air traffic regulation, however, aircraft are not permitted to follow this optimal climb profile, and can instead only cruise on certain flight levels depending on the direction of flights.This study adapts the standard in Reduced Vertical Separation Minima (RVSM) that eastbound aircraft fly odd thousands of feet while westbound aircraft fly even thousands of feet.The optimal legal cruise altitudes, € h opt Legal , are determined given the set of flyable altitudes, € h Legal , using the following equation:€ h opt Legal (t) = min h Legal h opt (t) -h Legal { } .(9)The vertical profile for an eastbound flight is plotted in magenta in Fig. 2.This vertical profile is generated without winds and assumes an instantaneous step climb.It is an approximation for the vertical aircraft profile for determining the en-route legal cruise altitudes and the total travel time at each altitude.
C. Horizontal Trajectory GenerationThe second stage of the proposed optimization strategy optimizes aircraft horizontal trajectory segments in the presence of winds based on the vertical profile developed in the first stage.Minimizing total aircraft travel time also minimizes total fuel burn for a given vertical profile since the fuel burn rates are specified along the track.The minimum-time trajectory consists of the horizontal trajectory segments on the pre-determined legal cruising altitudes.They are optimized based on the cost-to-go associated with each extremal generated by forward or backward integrating the dynamical equations for optimal heading and aircraft motion from various points in the airspace.This subsection presents the dynamical equation for optimal aircraft heading and the horizontal trajectory optimization algorithm.The aircraft equations of motion at a constant altitude above the spherical Earth's surface are:€ ˙ φ = V cosψ + u(φ,θ,h) Rcosθ ,(10)€˙ θ = V sinψ + v(φ,θ,h) R ,(11)€ ˙ m = -f ,(12)subject to the conditions that thrust equals drag, flight path angle is zero, and the boundary constraints are met.The previous study [12] applies Pontryagin's Minimum Principle to determine the heading angle that is assumed to be the control available for aircraft during cruise for minimizing the cost of travel time and climate impact.When neglecting the climate impact, the horizontal trajectory is optimized by determining the heading angle that minimizes travel time in the presence of winds.The dynamical equation for the optimal aircraft heading [12] is:€ ˙ ψ = -F wind (ψ,φ,θ,u,v,V ) Rcosθ ,(13)where € F wind (ψ,φ,θ,u,v,V ) is aircraft heading dynamics in response to winds and is expressed as:€ F wind (ψ,φ,θ,u,v,V ) = [-sinψ cosψ ∂u(φ,θ,h) ∂φ + cos 2 ψ sinθ u(φ,θ,h) + cos 2 ψ cosθ ∂u(φ,θ,h) ∂θ - ∂v(φ,θ,h) ∂φ + sinψ cosψ sinθ v(φ,θ,h) + cosψ sinψ cosθ ∂v(φ,θ,h) ∂θ +V cosψ sinθ + cos 2 ψ ∂v(φ,θ,h) ∂φ ].(14)A recent study [8] developed the same dynamical equation for computing minimum-time path.These studies [8,12] reduced the trajectory optimization problem from a two-point boundary value problem to an initial value problem.Numerical algorithms such as collocation methods, used in [12], or interpolation techniques, as used in [8],can be applied to determine the optimal initial aircraft heading.In the case that an aircraft cruises at a single altitude, the minimum-time trajectory is completely specified by integrating Eqs.(10,11,13) simultaneously from the origin to the destination using the optimal initial aircraft heading.In general, an aircraft cruises at multiple altitudes to accommodate weight reduction, thereby minimizing fuel burn, as described in the previous subsection.The minimum-time trajectory is the combination of wind-optimal extremals on several different altitudes, each solved using wind conditions on that altitude.This study employs the concept of dynamic programming for constructing the minimum-time trajectory with wind-optimal extremals at different cruise altitudes.The optimal vertical profile provides the initial and subsequent optimal cruise altitudes as well as the transition times between the altitudes.The following five steps compute the horizontal minimum-time trajectory.1. Using a range of different initial heading angles at the start of the initial cruise segment, a collection of wind-optimal extremals is generated by forward integrating Eqs.(10, 11, and 13) until the first step climb time.This step is illustrated by plotting the wind-optimal extremals in blue in Fig. 3 for a flight from Anchorage to Hong Kong.hours, and after that, every 12 hours.The horizontal resolution is roughly equivalent to 0.5×0.5 degree latitude/longitude.GFS data has 64 unequally-spaced vertical isobaric pressure levels ranging between 0.25-1000 mb, with enhanced resolution at low and high altitude.
Fig. 5 The wind-optimal trajectory from Anchorage, AK to Hong KongThe computation time for solving the wind-optimal trajectory on 3 flight levels is about 8 seconds when running a Matlab R2012a program on a Mac Pro with dual 2.66 GHz 6-core processors and 64 GB memory.The computation time for solving a wind-optimal trajectory at a single flight level is about 6 seconds on the same platform.This algorithm can be implemented conveniently in other computer languages since it does not require complex numerical solvers.Note that generating the wind-optimal extremals in parallel can further reduces the computation time.The performances of the two wind-optimal trajectories are evaluated by simulating the complete aircraft trajectories from takeoff to landing for a Boeing 777-200 with a takeoff weight of 258,300kg and a cruise speed of 486knots using the wind-optimal flight paths.The typical aircraft profiles during takeoff, step climbs, and landing are based on BADA [9].The horizontal trajectory during cruise is simulated based on the wind-optimal flight path at a single flight level and the wind-optimal flight path on multiple flight levels with en-route step climbs, respectively.The total fuel consumption and travel time for the wind-optimal flight on a single flight level is 64.4tonnes and 569 minutes, respectively.The wind-optimal flight that cruises on 3 flight levels burns 62.4 tonnes of fuel and travels for 562 minutes.Flying wind-optimal with en-route step climbs saves about 3.2% of fuel and 1.2% of travel time when compared to that on a single flight level.This practical approach integrates the technique of aircraft wind-optimal heading and the concept of Dynamic Programming (DP) to approximately optimize the performance of aircraft trajectories in the presence of winds.The details of deriving the dynamical equation for aircraft wind-optimal heading can be found in the past studies [8,12].The application of DP for determining the subsequent step climb locations is discussed in the Appendix.
III. Experimental SetupsThe practical trajectory optimization algorithm is applied to assess the potential benefits of flying wind-optimal trajectories with an optimal vertical profile for commercial cargo flights operating at Anchorage, AK.The trajectory computations use air traffic and global wind data from October 2010, obtained from the GFS.The performance of the wind-optimal trajectories is evaluated by simulating the complete aircraft trajectories from takeoff to landing using the wind-optimal flight paths.The typical aircraft profiles during takeoff, step climbs, and landing are based on BADA.Ted Stevens Anchorage International Airport (ANC) is a major hub airport for cargo flights between the U.S.and Asia, being less than 9.5 hours from 90% of the industrialized world.For this paper we analyze nearly 12,500Federal Express (FedEx) and United Parcel Service (UPS) cargo flights from 2010.Based on these data, Fig. 6 shows the 10 most popular origin airports for flights to ANC.Almost 80% of inbound FedEx and UPS flights depart from these 10 origin airports.Over 90% of outbound FedEx and UPS flights from ANC fly to the 10 destination airports shown in Fig. 7. Table 1   Aircraft trajectories are optimized based on the aerodynamic parameters and aircraft performance data provided by BADA for the five aircraft types described above.BADA [9] does not include the B77L, so the aerodynamic parameters and aircraft performance data for the Boeing 777-200 (B772) are used instead.High takeoff mass is assumed for each aircraft type since commercial cargo flights are usually heavily loaded.Typical aircraft climb and descent profiles during initial climb, en-route step climbs and final descent are obtained for each aircraft type from BADA [9] performance files for generating the complete aircraft trajectories.These are defined based on altitude, air speed and mass for each phase.The optimal speed depends on the cost performance index that is generally specified by the airlines and chosen according to their priorities.The current optimization procedure solves for the optimal speed by iterating a range of cruise speeds that requires a more detailed aerodynamic model.In addition, current BADA parameters, such as the drag coefficients, may only be valid at the specified nominal speeds.Due to these limitations, this study does not optimize cruise speed for each flight.In this paper, the true air speed during cruise is calculated from the typical Mach number suggested by BADA.
A. Comparing Wind Optimal TrajectoriesThis subsection analyzes the WOMFL and WO1FL trajectories for cargo flights to and from ANC.The performance of the WOMFL trajectories is evaluated by assessing and comparing average fuel consumption and travel time of these trajectories to that of the WO1FL trajectories.Figure 9 shows the average fuel savings in bar graphs for each origin, destination and aircraft type, for all cargo flights in October, 2010 to and from ANC. Flying the WO trajectories has a positive fuel saving for all of the origins and destinations except KOAK and KIND.Fuel savings are between 0.1% and 3% depending on the airport pairs.They are directly proportional to the length of the routes, which determines the number of en-route step climbs.The average travel time, fuel burn, and number of step climbs for the top 10 origins are shown in Table 2.The average time and fuel savings are shown in parentheses.The potential fuel savings are very small for all domestic flights since most of them have only one step climb.Flights between ANC and KOAK or KIND have the shortest travel time.For these routes, performing an en-route step climb actually increases the total fuel burn.Note that the additional fuel burn required for each step climb is not considered when developing the aircraft vertical profile, which assumes instantaneous climb for simplicity in the optimization.Most international flights save more than 1% fuel depending on the aircraft types.The B744 and B772 have the largest amount of fuel savings while the MD11 and B763 have smaller and similar amount of fuel savings.The WOMFL trajectories for all the domestic flights have equal or longer travel times than the corresponding WO1FL trajectories.The additional time involved in climbing and descending is not negligible for these relatively short trips.The WOMFL trajectories for all international flights except RJAA, which is the shortest of the international routes, have positive time savings.The time savings not only depend on the trip length but also on the flight direction.The travel time for each flight is affected by en-route wind magnitude and direction.Therefore, long-distance wind-optimal trajectories not only gain fuel savings from en-route step climbs but may also benefit from high-speed winds at higher altitudes.
B. Flight Plan and Wind Optimal TrajectoriesIn the future, with improvements in air traffic management, route structures are likely to become more flexible.With these more flexible route structures, future air traffic will be able to choose to fly their preferred routes to a greater extent than is the case today.This subsection assesses the potential benefits for the FedEx and UPS cargo flights when they fly WOMFL trajectories instead of FP routes.Both the WOMFL and FP trajectories follow the optimal vertical profiles.Table 3 presents the average savings per flight, in descending order, for the top origins and destinations to and from ANC.The potential savings for the inbound flights to ANC are shown in the blue cells and the data for the outbound flights from ANC are in the green cells.The abbreviations "n/a" indicate where data are unavailable for some flight directions.Figure 10 shows the average percentage savings for fuel in solid bar graphs for each origin, destination and aircraft type.
Fig. 10 Potential fuel benefits for flying wind-optimalFlying the WOMFL trajectories has a positive saving in fuel and time for all the origins and destinations when compared to the FP trajectories.The domestic flights have up to 3% savings that are equivalent to about 5-10 minutes in time and 0.4-1.0tonnes of fuel for the top three domestic airports: KSDF, KEWR and KMEM.The international flights can potentially save more than 10% by flying wind optimal trajectories.For the outbound flights to VHHH, RKSI and ZSPD, travel time is reduced by 23-54 minutes and fuel burn by 2.3-7.6 tonnes.In general, the savings are proportional to the trip lengths.They also depend on the direction of flight and aircraft types.Longdistance international flights gain large time and fuel savings for all aircraft types.Domestic flights with MD11, B744, or B772 have larger fuel savings than with B763 and DC10.The domestic flights from ANC to KOAK and the international flights from RJAA to ANC have the smallest savings, respectively.Note that the accuracy of the assessed benefits is greatly affected by the quality of the flight plans in the database.FP trajectories that are simulated using flight plans with an incomplete list of waypoints lead to an underestimation of the required travel time and fuel burn.This is because flights are assumed to fly great circle routes between waypoints.If a flight plan has few waypoints, the FP trajectory is similar to the great circle trajectory for that flight.Subject to the wind conditions, great circle trajectories can be very similar to wind-optimal trajectories, especially for the short trips.Hence, the benefit of flying a wind optimal trajectory is underestimated for these flights.Several other factors also affect the accuracy of the results.The actual vertical flight path of each FP trajectory is approximated by those of WOMFL trajectory since the actual aircraft takeoff weight and airspeed profile for each flight are not available in the current database.Each simulated FP trajectory follows the vertical path that assumes a typical aircraft weight and an airspeed profile from BADA instead of the original vertical profile.This approximation may results in the performance underestimation for FP trajectories.In addition, the potential benefits for WOMFL trajectories need to be discounted since they neglect the additional costs involved in operating inside foreign airspace.
V. ConclusionThis study developed a trajectory optimization algorithm that minimizes the cost of time and fuel burn by integrating a method for computing minimum-time routes in winds on multiple horizontal planes and an aircraft fuel burn model for generating fuel-optimal vertical profiles.It is applied to evaluate the potential benefits of flying wind-optimal routes in a seamless airspace for commercial cargo flights operating between Anchorage, Alaska and major airports in Asia and the contiguous United States.Flying wind optimal trajectories with fuel-optimal vertical profiles reduces average fuel burn of international flights flying at a single cruise altitude by 1-3%.Long-distance flights not only gain fuel savings from en-route step climbs but may also benefit from high-speed winds at higher altitudes.The potential fuel savings of performing en-route step climbs are very small for the domestic cargo flights since most of them have only one step climb.The optimal trajectories reduce fuel burn and travel time relative to their flight plan routes for all the airport pairs.Domestic flights can potentially save up to 3% on fuel burn and travel time, which is equivalent to about 5-10 minutes in time and 0.4-1.0tonnes of fuel for the top three domestic airports.International flights can potentially save up to 10% on fuel and travel time by flying wind optimal trajectories, reducing travel time by 23-54 minutes and fuel burn by 2.3-7.6 tonnes.The actual savings in operations will vary from the simulation results due to differences in the aircraft models and user defined cost indices.In general, the savings are proportional to the trip lengths, and depend on the en-route wind conditions and aircraft types.€ C fcr ,C f 1 ,S1C f 2 are the thrust specific fuel consumption coefficients and € V TAS is the true air speed.During cruise, thrust equals aerodynamic drag force, D, that is a function of aerodynamic drag coefficients, , and true air speed, and is expressed as:
gas is the real gas constant for air.The temperature gradient, € K T , the sea level air density, € ρ 0 _ ISA and the sea level temperature, € T 0 _ ISA , are all constant under ISA.The air density, € ρ trop _ ISA , and temperature,
Fig. 22Fig. 1 Optimal cruise altitudes for MD11
ψ€Ris heading angle, and € R is the Earth's radius.The east-component of the wind velocity is € u(φ,θ,h) , and the north-component of the wind velocity is € v(φ,θ,h).It is assumed that the Earth is a sphere and >> h .
Fig. 33Fig.3Wind-optimal extremals from Anchorage, AK and Hong Kong 2. Using a range of different final heading angles at the destination, another collection of wind-optimal extremals is generated by backward integrating Eqs.(10, 11, and 13) at the second cruise altitude.This is done for a fixed period of time, estimated based on the difference between the total travel time and the first step climb time.The Magenta curves in Fig.3shows these extremals at the second cruise altitude.These extremals provide the minimum time-to-go to the destination from any points along them.Delaunay triangulation and interpolation techniques can be applied to estimate the time-to-go from any point in the covered airspace region using the points on the extremals.3.Identify the extremal from the collection generated in step 1 above that has the minimum time-to-go at the first step climb time (i.e. the end of the extremals).This step determines the wind-optimal trajectory segment at the first cruise altitude and the aircraft position at the first step climb time.The trajectory segment and the step climb position are shown by the blue dashed line and the blue cross in Fig.3.Note that the minimum time-to-go calculated based on the extremals in step 2 is only an approximation when the aircraft cruises at more than two altitudes.
4 .Fig. 4 Wind-optimal extremals on 2 altitudes 5 .445Fig.4Wind-optimal extremals on 2 altitudes 5.When the last cruise altitude is reached, the minimum-time trajectory at the last altitude is calculated by forward integrating Eqs.(10,11, and 13) using the correct heading angle at the start of the last cruise altitude.The heading angle is calculated by interpolating the aircraft headings from the backward extremals at the final cruise altitude.The horizontal wind-optimal trajectory for a flight from Anchorage, AK to Hong Kong on August 1, 2010 is shown in Fig.5.The wind vectors at flight levels 360, 380 and 400 are plotted in blue, magenta and green, respectively.A flight level is a standard altitude of an aircraft in hundreds of feet.Each trajectory segment is optimized with respect to the winds at the associated flight level.The wind magnitudes and directions are taken from the Global Forecast System (GFS).GFS is a global numerical weather prediction computer model run by the National Oceanic & Atmospheric Administration (NOAA) four times a day.It produces forecasts up to 16 days, and produces a forecast for every 3 rd hour for the first 180
lists the airport names and codes for the top origins and destinations.RJAA and KIND is the top origin and destination, respectively, in additional to the nine common airports.About 99% of the aircraft in the data set belong to the five aircraft types shown in Fig. 8.These are the McDonnell-Douglas MD-11 (MD11), Boeing 767-300 (B763), Boeing 747-400 (B744), Boeing 777-200LR (B77L), and McDonnell-Douglas DC-10 (DC10).
Fig. 6 Top 10 origins in 2010 Fig. 7 Top 10 destinations in 2010 Fig. 8 Fig. 9620107201089Fig. 6 Top 10 origins in 2010
Table 1 Top airports1Louisville International (KSDF)Memphis International (KMEM)Hong Kong International (VHHH)Shanghai Pudong International (ZSPD)Seoul Incheon International (RKSI)Newark Liberty International (KEWR)
Table 2 Average wind-optimal performance2Origin ACTime,Fuel,StepsType[tonne][no.]KSDF MD11 368 (0)52.5 (0.03)1B763384 (-1) 33.0 (0.01)1B744363 (-1) 66.1 (0.15)1KMEM MD11 369 (0)52.6 (0.03)1B772368 (1)47.7 (0.20)1DC10 374 (1)51.9 (0.21)2VHHH MD11 545 (4)74.0 (1.32)3B744534 (5)93.1 (2.25)2B772542 (4)67.4 (2.06)3ZSPDMD11 462 (2)64.1 (0.76)2B763478 (3)40.0 (0.75)2B744453 (3)80.6 (1.41)2B772459 (3)58.3 (1.40)2RKSIMD11 411 (2)57.9 (0.63)2B763426 (3)36.2 (0.60)2
Table 3 Potential benefits for wind-optimal3The average fuel savings are highly correlated to the time savings for each origin, destination and aircraft type.The savings for each flight are proportional to the total travel time difference between the WOMFL and FP trajectories since both follow the same vertical profile.The magnitudes of time savings are affected by en-route wind conditions and the structure of the original flight plans.Airport ACTimeFuelTypeSavingsSavings[minute][tonne]VHHH MD11 13 54 1.49 6.10
		
		
			
Appendix
A. Optimal Cruise AltitudesTaking the first derivative of the aircraft fuel flow rate with respect to the altitude to obtain the following equations,where∂V TAS ∂h andSFC is a constant when € V TAS remains unchanged for various cruise altitudes, i.e.,
€ ∂V€ ∂ρ ∂h ≠ 0; and solving the equation:Below the tropopause (altitude h < 11000 m), the temperature is calculated as a function of altitudeand the air density is calculated as a function of temperatureAbove the tropopause (h >= 11000 m), the temperature is a constant.The air density is.(A6)The formulas for the optimal cruise altitudes under ISA are obtained using Equations (A3-A6)
B. Application of Dynamic ProgrammingThe concept of DP is applied to determine the locations for en-route step climbs at the step climb times.The optimal step climbs locations are approximated based on the total cost-to-go associated with each wind-optimal extremal.Assuming that there are N-1 possible step climbs and n possible locations for each climb, a forward dynamic programming approach with N-1 stages and n possible states in the set of S N for each stage can be formulated as:Note that, the starting cost at the origin J(S N ) is zero with N stages to go.The optimal cost-to-go at the N-1 stage, J(S N-1 ), is the link cost, C N-1 (S N-1 ), from the origin to the current state.The link cost is the associated direct operating cost specified by Eq. ( 2) along the wind-optimal flight path.In general, the optimal cost-to-go at any arbitrary stages depends on the optimal cost-to-go in the previous stage and the minimum cost from previous stage to the current stage.The optimal cost is repeatedly solved until the destination is reached at S 0 .The optimal solution can be found in O(N x n x n) operations.Each operation involve computation of the link cost and determining the optimal cost-togo.The computation time for this approach is very high since the optimal solution at each state has to be computed to provide the final solution.The algorithm developed in this study approximates the aforementioned approach by solving N-1 individual DP problems that each has one climb (N=2) in order to reduce the computational effort.Each of the 1-stage DP problem can be written as the following:The solution for each problem is the optimal step climb location that becomes the origin for the subsequent problems.The complexity of this algorithm is reduced to O(N x n).This algorithm when applied in the real time also accommodates the frequently updated weather forecast and dynamic nature of atmospheric conditions by optimizing the aircraft trajectory segments at each step climb using most updated weather forecast.The DP approach in Eq. (A8) is equivalent to that of Eq. (A7) when aircraft performs only 1 step climb.This is true for domestic cargo flights operating between the 2 most popular city pairs.The algorithm can be formulated by adapting Eq. (A7) for flights with more than 1 step climb to gain better accuracy.The current two-steps optimization approach limits aircraft en-route step climbs at the time instants and flight levels that are determined by the aircraft vertical profile to enhance computational efficiency.In general, a larger selection for possible aircraft cruise altitudes and climbing times that results in larger N and n can be selected for the DP approach.Combining the horizontal and vertical optimization procedures provides a better approximation of the global optimal solution but significantly increases the computational efforts.			
			

				


	
		Applied Optimal Control, Taylor and Francis
		
			AEBryson
		
		
			YCHo
		
		
			1975
			
			Levittown, PA
		
	
	Bryson, A. E., and Ho, Y. C., Applied Optimal Control, Taylor and Francis, Levittown, PA, 1975, Ch. 2, pp. 42-89.



	
		Energy-State Approximation in Performance Optimization of Supersonic Aircraft
		
			AEBryson
		
		
			MNDesai
		
		
			WCHoffman
		
	
	
		Journal of Aircraft
		
			6
			6
			
			1969
		
	
	Bryson, A. E. and Desai, M. N., and Hoffman, W. C., "Energy-State Approximation in Performance Optimization of Supersonic Aircraft," Journal of Aircraft, Vol. 6, No. 6, 1969, pp. 481-488.



	
		Constrained Optimum Trajectories with Specified Range
		
			HErzberger
		
		
			HQLee
		
	
	
		Journal of Guidance and Control
		
			3
			1
			
			1980
		
	
	Erzberger, H., and Lee, H. Q., "Constrained Optimum Trajectories with Specified Range," Journal of Guidance and Control, Vol. 3, No. 1, 1980, pp. 78-85.



	
		Extended Energy Management for Flight Performance Optimization
		
			AJCalise
		
	
	
		AIAA Journal
		
			15
			3
			
			March 1977
		
	
	Calise, A. J., "Extended Energy Management for Flight Performance Optimization," AIAA Journal, Vol. 15, No. 3, March 1977, pp. 314-321.



	
		Singular Perturbation Techniques for Real Time Aircraft Trajectory Optimization and Control
		
			AJCalise
		
		
			DDMoerder
		
		
			1982
		
	
	NASA CR-3597
	Calise, A. J. and Moerder, D. D., "Singular Perturbation Techniques for Real Time Aircraft Trajectory Optimization and Control," NASA CR-3597, 1982.



	
		On the Navigation in the Air as a Problem of the Calculus of Variations
		
			EZermelo
		
	
	
		Jahresbericht der Deutschen Mathematiker-Vereinigung
		
			39
			
			1930
		
	
	Über die Navigation in der Luft als Problem der Variationsrechnung
	Zermelo, E., "Über die Navigation in der Luft als Problem der Variationsrechnung 'On the Navigation in the Air as a Problem of the Calculus of Variations'," Jahresbericht der Deutschen Mathematiker-Vereinigung, Vol. 39, 1930, pp. 44-48.



	
		Optimal Aircraft Routing in General Wind Fields
		
			SJBijlsma
		
	
	
		AIAA Journal of Guidance, Control, and Dynamics
		
			32
			3
			
			May-June 2009
		
	
	Bijlsma, S. J., "Optimal Aircraft Routing in General Wind Fields," AIAA Journal of Guidance, Control, and Dynamics, Vol. 32, No. 3, May-June 2009, pp. 1025-1028.



	
		Methods for Computing Minimum-Time Paths in Strong Winds
		
			MRJardin
		
		
			AEBryson
		
	
	
		AIAA Journal of Guidance, Control, and Dynamics
		
			35
			1
			
			2012
		
	
	Jardin, M. R., and Bryson, A. E., "Methods for Computing Minimum-Time Paths in Strong Winds," AIAA Journal of Guidance, Control, and Dynamics, Vol. 35, No. 1, 2012, pp. 165-171.



	
		User Manual for the Base of Aircraft Data (BADA)
		No. 10/04
	
	
		Eurocontrol Experimental Center (EEC)
		
			Sept. 2004
			Note
		
	
	Revision 3.6. Project ACE-C-E2
	"User Manual for the Base of Aircraft Data (BADA), Revision 3.6," Eurocontrol Experimental Center (EEC) Note No. 10/04, Project ACE-C-E2, Sept. 2004.



	
		An Analysis of Operational Procedures and Design Modifications for Aircraft Fuel Conservation
		
			RAggarwal
		
		
			ADushman
		
		
			AJCalise
		
		AIAA-1979- 1656
	
	
		Atmospheric Flight Mechanics Conference for Future Space Systems
		Collection of Technical Papers
		Boulder, Colo.; New York
		
			AIAA Inc
			August 6-8, 1979. 1979
			
		
	
	Aggarwal, R., Dushman, A., and Calise, A. J., "An Analysis of Operational Procedures and Design Modifications for Aircraft Fuel Conservation," In: Atmospheric Flight Mechanics Conference for Future Space Systems, Boulder, Colo., August 6-8, 1979, Collection of Technical Papers. (A79-45302 19-01) New York, AIAA Inc., 1979, p.232-242, AIAA-1979- 1656.



	
		Optimum Cruise Profiles in the Presence of Winds
		
			SLiden
		
		10.1109/DASC.1992.282147
	
	
		IEEE/AIAA 11 st Digital Avionics Systems Conference
		
			Oct. 1992
		
	
	Liden, S., "Optimum Cruise Profiles in the Presence of Winds," IEEE/AIAA 11 st Digital Avionics Systems Conference, Oct. 1992, Doi:10.1109/DASC.1992.282147.



	
		Cross-Polar Aircraft Trajectory Optimization and the Potential Climate Impact
		
			HKNg
		
		
			BSridhar
		
		
			SGrabbe
		
		
			NChen
		
		10.1109/DASC.2011.6096060
	
	
		IEEE/AIAA 30 th Digital Avionics Systems Conference
		
			Oct. 2011
		
	
	Ng, H. K., Sridhar, B., Grabbe, S., and Chen, N., "Cross-Polar Aircraft Trajectory Optimization and the Potential Climate Impact," IEEE/AIAA 30 th Digital Avionics Systems Conference, Oct. 2011, Doi:10.1109/DASC.2011.6096060.


				
			
		
	
