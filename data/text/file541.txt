
	
	
		
IntroductionThe economics and e ciency of air transportation in the continental U.S. could be improved signi cantly if the rigid routing restrictions 1 currently imposed by the Federal Aviation Administration FAA were relaxed to allow more direct or wind-optimal trajectories.The current routing restrictions help to maintain the safe and orderly ow of tra c, but new technologies in the areas of tracking, prediction, and communication are being developed that can be used to maintain or improve safety while relaxing or eliminating those restrictions.The ultimate goal is free ight 2 , 3, 4 , which could save the airlines several billion dollars per year in direct operating costs, according to the Air Transport Association ATA.The safety and e ciency of free ight will bene t from automated con ict predictions and resolution advisories.By de nition, a con ict not to be confused with a collision occurs when two or more aircraft come within the minimumallowed distance between each other.The minimum allowed horizontal separation for en-route airspace Aerospace Engineer, Flight Management and Human Factors Division, mailstop 262-3, paielli@etna.arc.nasa.gov.Senior Member AIAA.y Senior Scientist for Air Tra c Management, mailstop 210-9.Fellow AIAA. 0This paper was published in the Journal of Guidance, Control, and Dynamics, vol.20, no. 3, May-June 1997, pp.588-596. is currently 5 nautical miles nmi.The vertical separation requirement a b o v e an altitude of 29,000 feet ft is currently 2000 ft; below that level it is 1000 ft.Aircraft trajectory prediction is inexact, primarily because of wind modeling and prediction errors and secondarily because of tracking, navigation, and control errors.Wind estimates, based on the Mesoscale Analysis and Prediction System Rapid Update Cycle MAPS RUC 5, 6 , are provided by the National Oceanic and Atmospheric Administration NOAA.Aircraft in cruise are usually programmed stay on track laterally and vertically and to maintain a particular airspeed or Mach n umber.The farther in advance trajectories are predicted, the more uncertain those predictions are, particularly in the along-track direction, because the resulting groundspeed depends on the winds, and the uncompensated e ects of wind errors accumulate over time.Because con ict prediction is based on trajectory prediction, the farther in advance a potential con ict is predicted to occur or not to occur, the less certain that prediction is likely to be.A method is needed to estimate the level of certainty.The optimal time to initiate a con ict resolution maneuver is a trade-o between e ciency and certainty.The farther in advance a maneuver is initiated, the more e cient i t i s l i k ely to be in terms of extra distance own, but the less certain will be exactly what maneuver is required or whether a maneuver is required at all.The later a maneuver is initiated, on the other hand, the more certain will be exactly what maneuver is required, but the less e cient and more harsh the maneuver is likely to be.The determination of the optimal time to initiate a maneuver, therefore, requires an esimate of con ict probability.The determination of the optimal maneuver to be executed also requires a method of estimating con ict probability, because the goal of con ict resolution is to reduce the post-resolution con ict probability to some acceptable level.The con ict probability cannot be reduced to zero without introducing gross ine ciency, but that is not necessary because human air tra c controllers will be available to catch a n y unresolved conicts.The methods presented in this paper are intended to assist rather than replace human air tra c controllers.That is, they are intended to provide automated advisories for the controllers, but not to make the ultimate decisions.A method is developed in this paper to estimate the con ict probability for a pair of aircraft in free ight.The trajectory prediction errors are modeled as normally distributed, and the two error covariances for an aircraft pair are combined into a single, equivalent c o v ariance of the relative position.A coordinate transformation is used to derive an analytical solution.The paper is organized as follows.First, some background is given on modeling of trajectory prediction errors and con ict prediction.The con ict probability estimation algorithm is then developed.Finally, some numerical examples and a Monte Carlo validation are presented.
Con ict PredictionCon ict prediction can be divided into the following three steps.First, the trajectories of all aircraft in the region of interest are predicted for approximately the next 20 to 30 minutes min.These deterministic predictions are based on current estimated positions and velocities, ight plans, and predicted winds aloft.This complex modeling and software problem has already been solved for arrival tra c as part of the Center Tracon Automation System CTAS 7 , and that solution will be adapted for en-route and departure tra c also.The second step is to coarsely screen all possible aircraft pairs to eliminate those with a negligible possibility of conict.The third step, which is the subject of this paper, is to estimate the con ict probability for those remaining aircraft pairs.This probability i n v olves the predicted trajectories and an estimate of their uncertainty.The lateral feedback l o o p i s t ypically closed around cross-track position either by the pilot or by a Flight Management System FMS.The stabilized cross-track rms root mean square prediction error is approximately constant, with typical magnitudes from less than 0.5 nmi for aircraft equipped with an FMS to more than 1 nmi for those without.This magnitude could also be a function of the crosswind magnitude.Longitudinal position control involves using the throttle to compensate for unpredictable variations in headwind or tailwind.Because such compensation tends to be ine cient in cruise, the longitudinal feedback l o o p is usually closed around Mach n umber or airspeed, but not groundspeed or along-track position.For trajectory predictions of up to 20 or 30 min, the unstabilized alongtrack rms error tends to grow approximately linearly, a s illustrated in gure 1, with a typical growth rate of 0.25 nmi min 15 kts in cruise.This growth rate is primarily due to wind-prediction bias error, and it could be reduced in the future with improved wind modeling or with low-bandwidth control of along-track position, if such control can be done e ciently enough.The vertical rms error is primarily due to baro-altimeter error and secondarily due to altitude control error.The vertical error and along-track rms prediction error growth rate are both greater in climb and descent than in cruise.For predictions involving more than one ight regime such as climb and cruise, for example the total rms error is the sum of the contributions from each segment.Turns also tend to be imprecise and therefore add a signi cant amount of uncertainty that should be accounted for.For purposes of this paper, the magnitudes of the rms prediction errors and their growth rates are merely parameters.What is important is that the prediction errors can be approximated as normally distributed Gaussian, because the algorithm to be presented in this paper is based on that model.Many other estimation algorithms, such as the classical Kalman lter, are also based on the normal distribution model, of course.Ballin and Erzberger 8 tested the accuracy of the trajectoryprediction software that is installed in the Fort Worth Air Route Tra c Control Center as part of CTAS.They analyzed data from cruise segments of over four thousand ights eliminating those with delays that could be caused by unscheduled maneuvers and found that the along-track prediction errors were indeed very close to normally distributed.The normally distributed prediction errors can be represented as ellipses in the horizontal plane or as ellipsoids in space.The error ellipses tend to have their major principal axis in the along-track direction and their minor principal axis in the cross-track direction.Note that the uncertainty ellipse for a normally distributed random variable x is de ned as the solution of z T Z ,1 z = c 2 , where z = x , Ex, Z = c o vz Ezz T , E is the expected value, and c is a constant that can be assumed to be unity unless otherwise noted.The cross-correlation of prediction errors between aircraft can also be important because common errors cancel in the position di erence or relative position.Unfortunately, the cross-correlation is more di cult to model than the individual covariances because it depends on the trajectories and a spatial wind-error correlation model.That correlation model will be a function of both separation distance and heading angular difference.Aircraft pairs with nearly perpendicular ight paths will tend to have w eakly cross-correlated prediction errors because their along-track positions are affected by di erent wind components.Aircraft pairs with small path-crossing angles and small minimum separations, on the other hand, will tend to have more strongly cross-correlated prediction errors, both because they are a ected by a common wind component and because they spend a relatively long time close together.Although this area is open for research, it will not be pursued in this paper.
Con ict Probability EstimationThis section is divided into ve subsections.First, the method of combining two prediction-error covariances into a single covariance of the relative position is discussed.Next, a coordinate transformation is proposed that transforms the combined error covariance into a standard form.Then the analytical solution for the con ict probability i n t w o dimensions is developed.The generalization from two to three dimensions is then discussed.Finally, the application to con ict resolution is previewed.
Combined Error CovarianceThe trajectory prediction error for an aircraft will be modeled as normally distributed, with zero mean and with a covariance that has eigenvectors in the alongtrack and cross-track directions, as explained previously.The covariance matrix is therefore diagonal in a coordinate system aligned with the aircraft heading.If q is the aircraft position in such a heading-aligned coordinate system, and q is the corresponding prediction, then the prediction error is q q , q 1 and the corresponding diagonal covariance matrix is S covq 2 where covx Exx T for any random variable x, and E is the expected value function.If is the heading angle in some Earth-xed reference coordinate system, then R cos , sin sin cos 3 is a rotation matrix that transforms the heading-aligned coordinates to the reference coordinates.The position prediction in the reference coordinate system is then p = R q 4The position prediction error is p = Rq 5and the corresponding covariance matrix isQ covp = RSR T 6Because the trajectory prediction errors are modeled as normally distributed, the two error covariances for an aircraft pair can be easily combined into a single equivalent c o v ariance of the position di erence or the relative position of one aircraft with respect to the other.For present purposes, this combined covariance can be assigned to one of the aircraft, referred to as the stochastic" aircraft, and the other aircraft, referred to as the reference" aircraft, can be regarded as having no position uncertainty.Let subscripts S and R designate the stochastic and reference aircraft, respectively.The position di erence is p p S , p R 7 The prediction of that position di erence is p p S , p R 8 and the prediction error is pp, p= p S , p R 9The combined prediction error covariance is thenM covp = Q S + Q R , Q SR 10where Q S and Q R are the individual covariances based on equation 6, and the cross-correlation term Q SR is de ned asQ SR Ep S pT R + p R p T S 11In general, the combined error ellipse corresponding to M will no longer have principal axes aligned with the along-track and cross-track directions of either aircraft.2 shows an example encounter geometry, with the combined error ellipse centered on the stochastic aircraft, and the circular con ict zone 5 nmi radius centered on the reference aircraft.The error ellipse corresponds to a probability density function that can be represented as a surface over the ellipse.The ellipse is actually the intersection of that surface and a horizontal plane cutting the surface.The total volume under the surface is unity.The probability of con ict at a particular time is the portion of that volume that is within the circular con ict zone.An analytical solution has not been found for this probability, but it is not as important as the total probability of con ict for the encounter, which is discussed in the following paragraphs.It is assumed that the aircraft velocities and prediction errors are constant during the encounter or period of potential con ict, which is at least approximately true for most aircraft pairs in free ight.The total probability of con ict for the encounter can then be determined as follows.Project the circular con ict zone along a line parallel to the relative v elocity to form an extended conict zone, as illustrated in gure 2. The con ict probability is equal to the portion of the volume under the probability density surface that is within this extended con ict zone.The coordinate transformation to be presented in the next section allows this probability t o b e determined analytically.
Coordinate TransformationCoordinate transformations are often useful for simplifying problems.They are widely used in control theory, for example.In this case, the con ict probability is di cult or impossible to determine analytically in the original coordinate system.It can be determined numerically, but a n umerical solution is likely to be much less e cient and less accurate than an analytical solution.This inefciency is undesirable for an algorithm that is intended to run in real time at a very high rate for many y ears.Fortunately, a coordinate transformation has been found that allows an analytical solution.Let p and represent the original and transformed coordinates of position, respectively.A general linear coordinate transformation is of the form = T p 12 p = W 13 where T is a transformation matrix to be determined, and W T ,1 .The transformations for velocity and other vectors are of the same form.Combining the denition S , R 14 with the de nitions in equations 7-9 gives ~ =Tp 15 In the transformed coordinate system, the mean prediction error is still zero and the combined error covariance is cov~ = T M T T 16where M covp is the combined error covariance in the original coordinate system from equation 10.A Cholesky decomposition 9 or square-root" factorization of the combined error covariance M is of the form M = LL T 17 where L is lower triangular.If T is of the form T = RL ,1 18 where R is any orthogonal rotation matrix, then equation 16 becomes cov~ = I 19 where the fact that RR T = I has been used.The combined error ellipse is therefore in the standard form of a unit circle, as shown in gure 3. The con ict boundary, which w as a circle in the original coordinate system, is an ellipse in the transformed coordinate system, also as shown in gure 3.
Analytical SolutionHaving the error ellipse in the form of a unit circle simpli es the probability computation considerably because the corresponding two-dimensional 2-D probability density function decouples into the product of two identical one-dimensional 1-D functions: px; y = p x p y , where px = exp,x 2 =2= p 2. The probability density function can be represented as a radially symmetric surface over the circle.The circle is actually the intersection of that surface and a horizontal plane cutting the surface.The total volume under the surface is unity.In the transformed coordinate system, the extended con ict zone is still in the direction of the transformed relative v elocity, and the con ict probability is still equal to the portion of the volume under the probability density surface that is within this extended con ict zone.The rotation matrix R in equation 18 can be used to rotate the transformed coordinate system about the origin.It can therefore be selected such that the relative velocity is in the positive or negative x-direction.If 26 at the minimum and maximum points.Note that a is positive and ac,b 2 is positive and invariant with respect to rotation for any ellipse 10 , so the argument o f t h e square root function must also be positive.v v S , v RThe con ict probability is the portion of the volume under the surface of the probability density function that is within the extended con ict zone.Because the probability density function decouples into px; y = p x p y and the con ict boundaries are parallel to the x-axis, the expression for the con ict probability P c can be simplied as follows: = P ,y + y c , P , y , y c 27 where y y S ,y R is the y-coordinate of the stochastic aircraft with respect to the reference aircraft, and P is the cumulative normal probability function.The latter, de ned such that P z R z ,1 psds for any random variable z, can be determined analytically 9 .This analytical solution for the con ict probability is therefore theoretically exact under the assumptions stated previously.The main assumption is that the aircraft velocities are constant in both magnitude and direction during the encounter or period of potential con ict.Free-ight trajectories typically will be fairly direct and have few turns, so that assumption is likely to be accurate in most cases.Note that this does not preclude planned turns or other maneuvers before the encounter begins.For constant v elocity, the time at which the minimum predicted separation occurs ist m = t 0 + p T 0 v v T v 28where p 0 is the position di erence at time t 0 , and v is the constant v elocity di erence, both in terms of cartesian coordinates.The position di erence at minimum separation is then p m = p 0 + t m , t 0 v 29The minumum separation distance itself is k p m k.Small variations in aircraft velocity due to wind disturbances or wind-optimal routing have only a small effect in the immediate vicinity of an encounter, so they will not signi cantly violate the assumption of constant velocity.The predicted velocities at the point of minimum predicted separation are tangent to the ightpaths and can be considered rst-order linear approximations to the actual trajectories at that point.In the unlikely case that a large heading or speed change is scheduled in the vicinity of a potential con ict, on the other hand, the analytical solution for con ict probability will not be accurate.
Three-Dimensional CaseIf the two aircraft are in level ight at di erent altitudes, or if one or both of the aircraft are climbing or descending, the problem is three-dimensional 3-D.The basic modi cations required to the 2-D case are discussed in this section.For simplicity, the along-track axis is dened as the projection of the predicted velocity v ector on a horizontal plane.The along-track and cross-track axes are therefore horizontal by de nition, and the prediction error ellipsoid is modeled as having its principal axes in the along-track, cross-track, and vertical directions.For en-route ight, the con ict zone is a cylinder or disk with a horizontal radius of 5 nmi and a vertical thickness of 4000 ft.A coordinate transformation can be used to transform the error ellipsoid into a unit sphere.Most of the previous analysis still applies, but in three dimensions rather than two.The transformation can be decoupled into a 2-D horizontal transformation identical to the one discussed previously and a vertical transformation that is a simple scaling.The con ict zone, which is a circular cylinder in the original coordinate system, is an elliptical cylinder in the transformed coordinate system.The transformation can still be selected such that the relative velocity is in the positive or negative x-direction.Consider rst the case in which both aircraft are in level ight, but at di erent altitudes.In this case the relative v elocity v ector is horizontal, and the projection of the disc-shaped con ict zone along the direction of relative v elocity forms a rectangular volume.The conict probability is the product of two cumulative normal probability di erences, one that is identical to equation 27, and another of the same form that applies to the vertical axis.That is, the horizontal con ict probability of equation 27 can be generalized to three dimensions by multiplying it by a v ertical con ict probability factor.The vertical factor is P ,z + z c , P , z , z c , where z is the predicted vertical separation between the two aircraft, and z c is the minimum allowed vertical separation 2000 ft, both normalized divided by the vertical rms error.A t ypical vertical rms error, which is caused primarily by baro-altimeter error, is approximately 100 ft.For all practical purposes, it can be assumed that the vertical error will not exceed 400 ft for each aircraft or p 2 400 600 ft for the altitude di erence of two aircraft.Therefore, if the predicted vertical separation is less than about 2000 , 600 = 1400 ft, the vertical factor is virtually unity, and the 3-D con ict probability is essentially equal to the horizontal con ict probability.If the predicted vertical separation is greater than about 2000 + 600 = 2600 ft, on the other hand, the vertical factor is virtually zero, and the horizontal con ict probability need not even be computed.For a vertical rms error of 100 ft, therefore, the vertical factor needs to be computed only if the predicted vertical separation is between about 1400 and 2600 ft.The case in which one or both of the aircraft are climbing or descending is more complicated, unfortunately, because the relative v elocity is not horizontal, and the projection of the disc-shaped con ict zone along the direction of relative v elocity does not form a rectangular volume.The cross section of that volume is a rectangle with halves of an ellipse attached to the top and bottom.Numerical integration can be used to approximate the con ict probability, if necessary, or some heuristic approximation may be possible, but that approximation will not be pursued here.
Application to Con ict ResolutionThe ultimate purpose of con ict probability estimation is for use in optimal con ict resolution.The problem of con ict resolution involves deciding when to initiate a resolution maneuver and what maneuver to execute.The con ict probability is an important factor in both decisions.This subsection outlines horizontal con ict resolution methods presently under investigation.Vertical con ict resolution is also discussed brie y.The optimal time to initiate a con ict resolution maneuver is a trade-o between e ciency and certainty.The farther in advance a maneuver is initiated, the more e cient i t i s l i k ely to be in terms of extra distance own, but the less certain will be exactly what maneuver is required or whether a maneuver is required at all.The later a maneuver is initiated, on the other hand, the more certain will be exactly what maneuver is required, but the less e cient and more harsh the maneuver is likely to be.The optimal time to initiate a maneuver can be determined by minimizing a cost function that re ects the statistically expected cost of maneuvering or not maneuvering as a function of time.That cost function depends on the con ict probability, the operating cost per unit of distance traveled, and various other issues such as passenger comfort and controller workload.A con ict is resolved in the horizontal plane by m o ving the extended con ict zone su ciently far away from the center of the error ellipse or circle to reduce the conict probability to some desired level.The resolution maneuver involves changing the direction of the relative velocity for some period of time, as illustrated in gure 4. The magnitude of the relative velocity is essentially irrelevant.It is assumed that the aircraft will complete the dynamic or accelerating portion of the maneuver and reach a constant v elocity before the encounter period of potential con ict.The velocity c hanges can therefore be modeled as instantaneous until the static maneuver is determined; the dynamic transients can then be properly accounted for.The key parameters are the time at which the maneuver is initiated, the time at which it is completed, and the angular change of the relative v elocity.If the maneuver is completed after the encounter, as shown in gure 4, its e ect is to rotate the extended con ict zone by an angle a about the point at which the maneuver is initiated.If it is completed before the encounter, on the other hand, and the aircraft return to their original velocities, its e ect is to translate the extended con ict zone by a distance r perpendicular to the relative v elocity.The direction of the relative v elocity after resolution can be easily transformed back to the original coordinate system.Then, changes in the individual aircraft velocities must be determined to realize that relative v elocity.In general, the change in relative v elocity can involve changes in both the magnitude and the direction of the individual velocities.The solution is underdetermined, however, and additional constraints can be applied to simplify the maneuver.For example, the solution can be constrained to require only one aircraft to maneuver.In addition, the maneuver can be further constrained to consist of only a heading change at constant speed or a speed change at constant heading, if desired.This discussion applies mainly to horizontal con ict resolution, but vertical con ict resolution is also very important for two reasons.First, because the minimum required separation is about 15 times less in the vertical axis than it is in the horizontal plane, vertical con ict resolution may be more e cient in many cases, particularly when the minimum predicted horizontal separation is small and or the vertical separation is already almost large enough to avoid a con ict.Second, because vertical con ict resolution is much simpler, it may be appropriate for con icts involving three or more aircraft.For those cases, determination of e cient horizontal resolution maneuvers can be mathematically complicated and computationally intensive, and accurate and reliable execution can be operationally di cult.Separating the aircraft by altitude, on the other hand, is much simpler.
ValidationThe Gaussian statistical model on which the conict probability algorithm is based was determined empirically by analyzing actual air tra c data 8 .A Monte Carlo simulation was used to validate the algorithm itself.In the Monte Carlo simulation, combinations of path-crossing angles, minimum predicted separations, and times to minimum predicted separation were generated.For each combination, the con ict probability was computed and nominal trajectories were generated.Then the nominal trajectories were perturbed by a series of random prediction errors, each consisting of constant cross-track position error and constant along-track v elocity error.These randomly generated errors had the same expected statistics as were used in the con ict probability algorithm: 1 nmi rms cross-track error and 0.25 nmi min rms along-track error growth rate.Wind-error cross-correlation was not modeled.The empirical fraction of cases in which con icts resulted was compared with the computed con ict probability.Table 1 shows a representative sampling of the differences between the computed con ict probabilities and the Monte Carlo simulation results.One million Monte Carlo samples were run for each e n try in the table, and each e n try corresponds to a particular encounter geometry.The algorithm matches well with the simulation results.The largest magnitude of the di erence for all cases shown is 1.8, and only 5 of the 72 di erences in the table are at or over 1 in magnitude.Most of the di erences are well under 1 in magnitude, and many are at about 0.1.Given the accuracy of the underlying error model and the requirements of the application, this result is more than adequate.A worst-case accuracy of perhaps 5 would have been considered adequate.The di erences are larger than would be statisti- cally expected, however.The expected standard deviation for each table entry is p P c 1 , P c =N, where N is the number of samples and P c is the con ict probability.Note that P c 1 , P c = 0 i f P c = 0 o r P c = 1, and the maximum of p P c 1 , P c is 0.5 when P c = 0 : 5. Thus, the maximum expected standard deviation for any table entry cannot exceed 0.0005.One reason that the di erences are larger than expected is that the analytical solution is based on the assumption that the prediction error covariance is constant during the encounter, whereas it actually grows with prediction time.Aircraft pairs with small path crossing angles tend to have encounters of longer duration, so the assumption of constant c o v ariance during the encounter is likely to be less accurate.This could explain the slightly larger di erences in Table 1 for small path crossing angles.Recall also that aircraft pairs with small path crossing angles have more wind-error cross-correlation, which i s n o t modeled in this simulation.Although cross-correlation can be exactly accounted for in the con ict probability algorithm, a model of the actual physical phenomenon needs to be developed so that values can be determined for equation 11.The con ict probability estimates are, therefore, likely to be less accurate for pairs of aircraft ying in the same or nearly the same direction, but that will improve as wind-error cross-correlation is better understood.
Numerical ExamplesA set of numerical examples of con ict probabilities and related quantities were generated as a function of encounter geometry.The aircraft speeds were 8 nmi min 480 kts in every case, a typical speed for commercial transport aircraft.The con ict separation distance was 5 nmi, the currently used value for en-route airspace.The cross-track rms error was 1 nmi, and the along-track rms error started at zero and grew linearly at a rate of 0.25 nmi min, unless otherwise stated.These values are typical for cruise.This linear-growth model is typical but is not assumed or required by the algorithm.Winderror cross correlation between aircraft was not modeled.Figure 5 shows the cumulative separation probability, with prediction time as a parameter, where the pathcrossing angle is 90 deg and the minimum predicted separation is zero nmi an exact collision.This value is the probability that the minimum separation will be less than the abscissa value.Figure 6 shows the corresponding probability density the derivative, with respect to minimum separation, of the cumulative separation probability shown in gure 5, determined by n umerical differentiation.This plot shows how the density function spreads out as prediction time increases.It is interesting to see how the expected value of the minimum separation compares with the predicted value as prediction time increases.The predicted value is based on a deterministic trajectory model, with no consideration for trajectory-prediction errors.The expected or mean value, on the other hand, is derived from the cumulative separation probability function P or the separation probability density function p according to Es = R 1 0 1 , P x dx = R 1 0 xpxdx.Figure 7 shows the expected value of minimum separation as a function of time to minimum predicted separation, with minimum predicted separation as a parameter, where the path-crossing angle is 90 deg.The expected separation diverges from the predicted separation, but the group of curves shown converge to a common asymptote for large prediction times.Note that the 0 nmi case does not intersect the origin because the cross-track rms error Figure 8 shows the e ect of minimumpredicted separation on con ict probability.Con ict probability i s plotted as a function of the time to minimum predicted separation, with the minimum predicted separation as a parameter, where the path-crossing angle is 90 deg.For small prediction times, the covariances are small and the con ict probabilities are a strong function of minimum predicted separation.For larger prediction times, the covariances grow and the con ict probability becomes a weaker function of the minimum predicted separation.The con ict probabilities converge and asymptotically approach zero as prediction time increases.Figure 9 shows the e ect of path-crossing angle on con ict probability.Con ict probability is plotted again as a function of the time to minimum predicted separation, but with the path-crossing angle as a parameter, where the predicted minimum separation is 0 nmi.As a point of reference, the curve for the path-crossing angle of 90 deg is a repeat of the corresponding curve of gure 8.As the prediction time increases, the conict probability decreases faster for smaller path-crossing angles.If wind-error cross correlation were taken into account, however, these curves would be very di erent for smaller path-crossing angles.A portion of the trajectory-prediction error would cancel in the position di erence, and the e ective error growth rate would be smaller.Hence the con ict probabilities for smaller path angles would be higher than these shown in gure 9.Figure 10 shows the e ect of prediction-error growth rate on con ict probability.Con ict probability is plotted again as a function of the time to minimum predicted separation, but with the along-track rms error growth rate as a parameter.The value of 0.25 nmi min or 15 kts has been used throughout this paper for the along-track rms error growth rate, but values of 10 kts and 20 kts are also shown in the gure.For each of the three values of error growth rate, con ict probability i s plotted for minimum predicted separations of 0 and 10 nmi.Note that the three pairs of curves could be collapsed into one pair by scaling the horizontal axis by the along-track error growth rate.That is, if the horizontal axis were the along-track error, the three pairs of curves would be identical.Showing them separately does, however, illustrate some important c haracteristics.For minimum predicted separations substantially less than the minimum allowed separation, the con ict probability starts at unity and decreases monotonically as a function of prediction time.The e ect of larger error growth rates is to cause the con ict probability to decrease more rapidly as a function of prediction time.For minimum predicted separations substantially greater than the minimum allowed separation, on the other hand, the con ict probability starts at zero, increases to some maximumvalue, and then decreases back toward zero.This phenomenon occurs because the individual error ellipses expand and start to overlap, but then after the maximumcon ict probability they expand even more and the probability density function becomes atter.The e ect of larger error growth rates is to cause the con ict probability to initially increase more rapidly as a function of prediction time, and then to decrease more rapidly after the maximum.Finally, since computational e ciency is a major concern in a real-time air tra c control system, basic timing tests were performed on the con ict probability algorithm running on a Sun SPARC 1 0 w orkstation.These tests were for the con ict probability algorithm only and did not include trajectory prediction, winderror modeling, or any other part of the problem.The average computation time per aircraft pair was slightly under 0.6 milliseconds.In addition to being theoretically exact under the stated assumptions, this time is approximately two to four orders of magnitude faster than a numerical solution, depending on the method and level of resolution of the numerical integration.Furthermore, it is fast enough to be used directly in a real-time system.
ConclusionA method has been developed to accurately and ef- ciently estimate the probability of con ict for aircraft pairs in free ight.The resulting probability estimates are necessary for optimal con ict resolution, and the analysis behind the estimates is useful for developing an optimal con ict resolution algorithm.Some signi cant aspects of the problem still need to be addressed, such a s an e cient approximation for ascending and descending aircraft and a wind-error cross-correlation model.Although some heuristic methods may be needed to ll these gaps, a sound theoretical and numerical foundation has been established.The algorithms and software developed for this study will soon be incorporated into a con ict prediction system and tested on real air tra c data.This work will eventually help air tra c controllers maintain safe and e cient free ight.Figure 1 :1Figure 1: Trajectory prediction error ellipses
Figure 2 :2Figure 2: Encounter geometry
Figure 3 :3Figure 3: Transformed Encounter geometry
20is the relative v elocity in the original coordinate system, and L boundaries of the extended con ict zone are then the minimum and maximum values of y on the elliptical con ict boundary.Let p c and c represent the original and transformed coordinates, respectively, of points on the con ict boundary relative to the reference aircraft.The equation of the con ict boundary isk p c k = k W c k = s c23 where s c is the con ict separation distance 5 nmi and W is de ned in equation 13.This equation can be squared, then expanded according to for the elliptical con ict boundary is a x 2 c + 2 b x c y c + c y 2 c = s 2 c 25 The minimumand maximumvalues of y c can then be determined by at least two di erent methods.One method is to consider equation 25 as a quadratic equation in x c with coe cients that are functions of y c .The minimum and maximum values of y c can then be determined by setting the discriminant of that quadratic equation to zero and solving for y c .Another method is to di erentiate equation 25 with respect to x c and solve the equation dy c =dx c = 0, together with equation 25.The result is y c = s c p a=ac , b 2
Figure 4 :4Figure 4: Con ict resolution geometry in transformed coordinate system
Figure 5 :Figure 6 :56Figure 5: Cumulative separation probability
Figure 7 :7Figure 7: Expected value of minimum separation
Figure 8 :Figure 9 :89Figure 8: E ect of minimum predicted separation
Figure 10 :10Figure 10: E ect of prediction error growth rate
Table 1 :1Monte carlo simulation results: computed minus empirical con ict probability based on 1,000,000samples per entrypath crossing angle, deg minimum predicted separation, nmi time to min separation, min 4 8 12 24 15 0 +.000 ,.009 ,.006 ,.002 15 5 ,.018 ,.003 ,.003 ,.002 15 10 ,.001 ,.006 ,.005 ,.003 30 0 +.001 +.006 +.005 +.001 30 5 ,.011 ,.004 ,.001 +.000 30 10 ,.000 ,.004 ,.004 ,.001 45 0 +.002 +.012 +.010 +.003 45 5 ,.006 ,.003 ,.000 +.002 45 10 ,.001 ,.006 ,.006 ,.001 90 0 ,.000 ,.000 +.000 +.001 90 5 ,.001 ,.001 ,.000 ,.000 90 10 ,.000 ,.000 ,.000 +.000 135 0 ,.000 ,.003 ,.008 ,.012 135 5 +.001 ,.001 +.000 ,.000 135 10 +.000 +.001 +.004 +.006 180 0 +.000 +.000 +.000 +.000 180 5 ,.000 ,.000 +.000 ,.001 180 10 ,.000 ,.000 ,.000 ,.000is nonzero at time zero.
		
		
			

				


	
	
	
		Federal Aviation Administration
		W ashington, DC
		
			7110
		
	
	Air Tra c Control FAA Order 7110.65, Federal Avi- ation Administration, W ashington, DC.



	
		Final Report of the RTCA Task Force 3, Free Flight Implementation
		Washington, DC
		
			RTCA, Inc
			Oct 26. 1995
			
		
	
	Available from RTCA
	Final Report of the RTCA Task Force 3, Free Flight Implementation. RTCA, Inc., Washington, DC, Oct 26, 1995. Available from RTCA at 202-833-9339.



	
		Free-For-All Flights
	
	
		Scienti c American, v ol
		
			273
			6
			
			Dec, 1995
		
	
	Free-For-All Flights," Scienti c American, v ol. 273, no. 6, Dec, 1995, pp. 34-37.



	
		Free Flight P oses Multiple Challanges
		
			EHPhillips
		
	
	
		Avaition Wee k & S p ace T e chnology
		
			Mar 25. 1996
			144
			27
		
	
	Phillips, E.H.: Free Flight P oses Multiple Chal- langes," Avaition Wee k & S p ace T e chnology, v ol. 144, no. 13, Mar 25, 1996, pg. 27.



	
		The Rapic Update Cycle, Part I: Analysis Model Description
		
			SGBenjamin
		
		
			KJBrundage
		
		
			LLMorone
		
		
	
	
		Technical Proceedings Bulletin
		
			416
			June 1994
		
	
	NOAA NWS
	Benjamin, S.G.; Brundage, K.J.; and Mo- rone, L.L.: The Rapic Update Cycle, Part I: Analysis Model Description," Technical Proceed- ings Bulletin no. 416, June 1994, NOAA NWS. http: www.fsl.noaa.gov frd-bin tpbruc.cgi



	
		Statistical Properties of Three-Hour Prediction Errors" Derived from the Mesoscale Analysis and Prediction System
		
			DDevenyi
		
		
			TWSchlatter
		
	
	
		Monthly Weather Review
		
			122
			
			June 1994
		
	
	Devenyi, D.; Schlatter, T.W.: Statistical Prop- erties of Three-Hour Prediction Errors" Derived from the Mesoscale Analysis and Prediction Sys- tem," Monthly Weather Review, v ol. 122, June 1994, pp 1263-1280.



	
		Design of Automated System for Management of Arrival Tra c
		
			HErzberger
		
		
			WNedell
		
	
	
		NASA Technical Memorandum TM-102201
		
			June, 1989
		
	
	Erzberger, H.; Nedell, W.: Design of Automated System for Management of Arrival Tra c", NASA Technical Memorandum TM-102201, June, 1989.



	
		An Analysis of Landing Rates and Separations at Dallas Ft. Worth Airport
		
			MGBallin
		
		
			HErzberger
		
	
	
		NASA Technical Memorandum TM-110397
		
			July 1996
		
	
	Ballin, M.G.; Erzberger, H.: An Analysis of Land- ing Rates and Separations at Dallas Ft. Worth Air- port", NASA Technical Memorandum TM-110397, July 1996.



	
		
			WHPress
		
		
			SATuekolsky
		
		
			WTVetterling
		
		
			BPFlannery
		
		Numerical Recipes in C: The Art of Scienti c Computing
		
			Cambridge University Press
			1992
		
	
	Press, W.H.; Tuekolsky, S.A.; Vetterling, W.T.; Flannery, B.P.: Numerical Recipes in C: The Art of Scienti c Computing, Cambridge University Press, 1992.



	
		Calculus and Analytic Geometry, Fifth Edition
		
			GBThomas
		
		
			RLFinney
		
		
			1979
			Addison-Wesley Publishing Co
			430
		
	
	Thomas, G.B.; Finney, R.L.: Calculus and Analytic Geometry, Fifth Edition, Addison-Wesley Publish- ing Co., 1979, pg 430.


				
			
		
	
